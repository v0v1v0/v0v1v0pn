<div class="container">

<table style="width: 100%;"><tr>
<td>loess.scatter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a scatterplot with a fit line</h2>

<h3>Description</h3>

<p>Drawing a fit line usually requires some manual steps requiring several lines of code,
such as ensuring the data is sorted by x, and for some functions doesn't contain missing values.
This function takes care of these steps and automatically adds a loess fitline, or non-linear 
fitline. The type of scatter defaults to 'plot', but other scatter plot functions can be 
specified, such as graphics::smoothScatter(), for example. If 'file' is specifed, will 
automatically plot to a pdf of that name.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loess.scatter(
  x,
  y,
  file = NULL,
  loess = TRUE,
  span = 0.75,
  scatter = plot,
  ...,
  ylim = NULL,
  return.vectors = FALSE,
  fit.col = "red",
  fit.lwd = 2,
  fit.lty = "solid",
  fit.leg = TRUE,
  fit.r2 = TRUE,
  fast.loess = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data for the horizontal axis (independent variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>data for the vertical axis (dependent variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>file name for pdf export, leave as NULL if simply plotting to the GUI. File 
extension will be added automatically if missing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loess</code></td>
<td>
<p>logical, if TRUE, fit using loess(), else use a polynomial fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>numeric scalar, argument passed to the 'span' parameter of loess(), see ?loess for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scatter</code></td>
<td>
<p>function, by default is graphics::plot(), but any scatter-plot function of the 
form F(x,y,...) can be used, for example graphics::smoothScatter().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to the plot function specified by 'scatter', e.g, 'main', 'xlab', etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>numeric range for y axis, argument passed to plot(), see ?plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.vectors</code></td>
<td>
<p>logical, if TRUE, do not plot anything, just return the x and y coordinates
of the fit line as a list of vectors, x and y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.col</code></td>
<td>
<p>colour of the fit line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.lwd</code></td>
<td>
<p>width of the fit line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.lty</code></td>
<td>
<p>type of the fit line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.leg</code></td>
<td>
<p>whether to include an automatic legend for the fit line (will alter the y-limits
to fit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.r2</code></td>
<td>
<p>logical, whether to display r squared of the fit in the fit legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast.loess</code></td>
<td>
<p>logical, if TRUE will alter control parameters to make the loess calculation
faster, which is useful for datasets with more than 1000 points. Also reduce the value of 'span'
to increase speed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if file is a character argument, plots data x,y to a file, else will generate a plot to
the current plotting environment/GUI. The display of the x,y points defaults to 'plot', but 
alternate scatter plot functions can be specified, such as graphics::smoothScatter() which used 
density smoothing, for example. Also, another option is to set return.vectors=TRUE, and then
the coordinates of the fit line will be returned, and no plot will be produced.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(NCmisc)
require(KernSmooth)
DD &lt;- sim.cor(1000,4) # create a simulated, correlated dataset
loess.scatter(DD[,3],DD[,4],loess=FALSE,bty="n",pch=".",cex=2)
loess.scatter(DD[,3],DD[,4],scatter=smoothScatter)
xy &lt;- loess.scatter(DD[,3],DD[,4],return.vectors=TRUE)
prv(xy) # preview the vectors produced
</code></pre>


</div>