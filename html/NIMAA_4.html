<div class="container">

<table style="width: 100%;"><tr>
<td>extractSubMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract the non-missing submatrices from a given matrix.</h2>

<h3>Description</h3>

<p>This function arranges the input matrix and extracts the submatrices with non-missing values or with a specific proportion of missing values (except for the elements-max submatrix). The result is also shown as <code>plotly</code> figure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extractSubMatrix(
  x,
  shape = "All",
  verbose = FALSE,
  palette = "Greys",
  row.vars = NULL,
  col.vars = NULL,
  bar = 1,
  plot_weight = FALSE,
  print_skim = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>A string array indicating the shape of the submatrix, by default is "All", other options are "Square", "Rectangular_row", "Rectangular_col", "Rectangular_element_max".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value, If <code>TRUE</code>, the plot is saved as the .png file in the working directory. By default, it is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>A string or number. Color palette used for the visualization. By default, it is 'Blues'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.vars</code></td>
<td>
<p>A string, the name for the row variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.vars</code></td>
<td>
<p>A string, the name for the column variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar</code></td>
<td>
<p>A numeric value. The cut-off percentage, i.e., the proportion of non-missing values. By default, it is set to 1, indicating that no missing values are permitted in the submatrices. This argument is not applicable to the elements-max sub-matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_weight</code></td>
<td>
<p>A logical value, If <code>TRUE</code>, then the function prints submatrices with weights, otherwise it prints the submatrices with all weights as 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_skim</code></td>
<td>
<p>A logical value, If <code>TRUE</code>, then the function prints <code>skim</code> information in console. By default, it is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs row- and column-wise preprocessing in order to extract the largest submtrices. The distinction is that the first employs the original input matrix (row-wise), whereas the second employs the transposed matrix (column-wise). Following that, this function performs a "three-step arrangement" on the matrix, the first step being row-by-row arrangement, the second step being column-by-column arrangement, and the third step being total rearranging. Then, using four strategies, namely "Square", "Rectangular row", "Rectangular col", and "Rectangular element max", this function finds the largest possible submatrix (with no missing values), outputs the result, and prints the visualization. "Square" denotes the square submatric with the same number of rows and columns. "Rectangular_row" indicates the submatrices with the most rows. "Rectangular_col" denotes the submatrices with the most columns. "Rectangular_element_max" indicates the submatrices with the most elements which is typically a rectangular submatrix.
</p>


<h3>Value</h3>

<p>A matrix or a list of matrices with non-missing (bar = 1) or a few missing values inside. Also, a specific heat map plot is generated to visualize the topology of missing values and the submatrix sub-setting from the original incidence matrix. Additionally, the nestedness temperature is included to indicate whether the original incidence matrix should be divided into several incidence matrices beforehand.
</p>


<h3>See Also</h3>

<p><code>arrange</code>, <code>arrange_if</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load part of the beatAML data
beatAML_data &lt;- NIMAA::beatAML[1:10000,]

# convert to incidence matrix
beatAML_incidence_matrix &lt;- nominalAsBinet(beatAML_data)

# extract submatrices with non-missing values
sub_matrices &lt;- extractSubMatrix(beatAML_incidence_matrix, col.vars = "patient_id",
 row.vars = "inhibitor")
</code></pre>


</div>