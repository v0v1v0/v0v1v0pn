<div class="container">

<table style="width: 100%;"><tr>
<td>addResVar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add residual variability based on parameter estimates</h2>

<h3>Description</h3>

<p>Add residual variability based on parameter estimates
</p>


<h3>Usage</h3>

<pre><code class="language-R">addResVar(
  data,
  path.ext,
  prop = NULL,
  add = NULL,
  log = FALSE,
  par.type = "SIGMA",
  trunc0 = TRUE,
  scale.par,
  subset,
  seed,
  col.ipred = "IPRED",
  col.ipredvar = "IPREDVAR",
  as.fun
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data set containing indiviudual predictions. Often a
result of NMsim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.ext</code></td>
<td>
<p>Path to the ext file to take the parameter
estimates from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>Parameter number of parameter holding variance of the
proportional error component. If ERR(1) is used for
proportional error, use prop=1. Can also refer to a theta
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Parameter number of parameter holding variance of the
additive error component. If ERR(1) is used for additive
error, use add=1. Can also refer to a theta number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Should the error be added on log scale? This is used to
obtain an exponential error distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.type</code></td>
<td>
<p>Use "sigma" if variances are estimated with the
SIGMA matrix. Use "theta" if THETA parameters are used. See
'scale.par' too.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc0</code></td>
<td>
<p>If log=FALSE, truncate simulated values at 0? If
trunc0, returned predictions can be negative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.par</code></td>
<td>
<p>Denotes if parmeter represents a variance or a
standard deviation. Allowed values and default value depends
on 'par.type'.  </p>
 <ul>
<li>
<p> if par.type="sigma" only "var"
is allowed.  </p>
</li>
<li>
<p> if par.type="theta" allowed values are "sd"
and "var". Default is "sd".</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A character string with an expression denoting a
subset in which to add the residual error. Example:
subset="DVID=='A'"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A number to pass to set.seed() before
simulating. Default is to generate a seed and report it in the
console. Use seed=FALSE to avoid setting the seed (if you
prefer doing it otherwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ipred</code></td>
<td>
<p>The name of the column containing individual
predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ipredvar</code></td>
<td>
<p>The name of the column to be created by
addResVar to contain the simulated observations (individual
predictions plus residual error).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.fun</code></td>
<td>
<p>The default is to return data as a data.frame. Pass
a function (say 'tibble::as_tibble') in as.fun to convert to
something else. If data.tables are wanted, use
as.fun="data.table". The default can be configured using
NMdataConf.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An updated data.frame
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## based on SIGMA
simres.var &lt;- addResVar(data=simres,
                        path.ext = "path/to/model.ext",
                        prop = 1,
                        add = 2,
                        par.type = "SIGMA",
                        log = FALSE)

## If implemented using THETAs
simres.var &lt;- addResVar(data=simres,
                        path.ext = "path/to/model.ext",
                        prop = 8, ## point to elements in THETA
                        add = 9,  ## point to elements in THETA
                        par.type = "THETA",
                        log = FALSE)


## End(Not run)

</code></pre>


</div>