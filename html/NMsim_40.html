<div class="container">

<table style="width: 100%;"><tr>
<td>NMsim_NWPRI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate with parameter variability using the NONMEM NWPRI subroutine</h2>

<h3>Description</h3>

<p>Modify control stream for simulation with uncertainty
using inverse-Wishart distribution for OMEGA and SIGMA
parameters
</p>
<p>This function does not run any simulations. To simulate, using
this method, see 'NMsim()'. See examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NMsim_NWPRI(file.sim, file.mod, data.sim, PLEV = 0.999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file.sim</code></td>
<td>
<p>The path to the control stream to be edited. This function overwrites the contents of the file pointed to by file.sim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.mod</code></td>
<td>
<p>Path to the path to the original input control stream provided as 'file.mod' to 'NMsim()'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.sim</code></td>
<td>
<p>Included for compatibility with 'NMsim()'. Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PLEV</code></td>
<td>
<p>Used in <code>$PRIOR NWPRI PLEV=0.999</code>. This is a 
NONMEM argument to the NWPRI subroutine. When PLEV &lt; 1, a 
value of THETA will actually be obtained using a truncated 
multivariate normal distribution, i.e. from an ellipsoidal 
region R1 over which  only  a fraction of mass of the 
normal occurs. This fraction is given by PLEV.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulate with parameter uncertainty. THETA parameters are
sampled from a multivariate normal distribution while OMEGA
and SIGMA are simulated from the inverse-Wishart
distribution. Correlations of OMEGA and SIGMA parameters will
only be applied within modeled "blocks".
</p>


<h3>Author(s)</h3>

<p>Brian Reilly, Philip Delff
</p>


<h3>References</h3>

<p><a href="https://ascpt.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fpsp4.12422&amp;file=psp412422-sup-0001-Supinfo1.pdf">inverse-Wishart degrees of freedom calculation for OMEGA and SIGMA: NONMEM tutorial part II, supplement 1, part C.</a>
</p>


<h3>See Also</h3>

<p>NMsim_VarCov
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
simres &lt;- NMsim(file.path,method.sim=NMsim_WPRI,typical=TRUE,subproblems=500)

## End(Not run)
</code></pre>


</div>