<div class="container">

<table style="width: 100%;"><tr>
<td>cvfunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross Validation for Histogram Hazard Rate Estimator</h2>

<h3>Description</h3>

<p>Implements the cross validation function for determining the optimal number of bins for the histogram hazard rate estimator of <a href="https://www.jstor.org/stable/42003749"> Patil and Bagkavos (2012)</a>. It is used as input in   <code>HazardHistogram</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvfunction(h, xin, xout, cens)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Target number of bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xin</code></td>
<td>
<p> A vector of data points.  Missing values not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xout</code></td>
<td>
<p> A vector of grid points at which the histogram will be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p> A vector of 1s and zeros, 1's indicate uncensored observations, 0's correspond to censored obs. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The least square cross validation criterion, defined in (12), <a href="https://www.jstor.org/stable/42003749">Patil and Bagkavos (2012)</a> is
</p>
<p style="text-align: center;"><code class="reqn">
CV (h) = \frac{1}{h}\sum_k \big\{(2 f^0_k - f^{0^2}_k)[\bar F_k (\bar F_k +1)]^{-1} - f^{0^2}_k[\bar F_k (\bar F_k +1)^2]^{-1}\big\}.
</code>
</p>

<p>Optimization of the criterion is done through a nonlinear optimization function such as <code>nlminb</code> as illustrated also in the example of <code>HazardHistogram</code>.
</p>


<h3>Value</h3>

<p>Returns the optimal number of bins.
</p>


<h3>References</h3>

<p><a href="https://www.jstor.org/stable/42003749">Patil and Bagkavos (2012), Histogram for hazard rate estimation,  pp. 286-301, Sankhya, B.</a>
</p>


<h3>See Also</h3>

<p><code>HazardHistogram
</code>
</p>


</div>