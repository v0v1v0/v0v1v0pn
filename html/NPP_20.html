<div class="container">

<table style="width: 100%;"><tr>
<td>ModeDeltaPoisNPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Poisson Population</h2>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in multinomial population.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ModeDeltaPoisNPP(Data.Cur, Data.Hist,
                 CompStat = list(n0 = NULL, mean0 = NULL, n1 = NULL, mean1 = NULL),
                 npoints = 1000, prior = list(lambda.shape = 1/2,
                 lambda.scale = 100, delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data.Cur</code></td>
<td>
<p>a non-negative integer vector of each observed current data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data.Hist</code></td>
<td>
<p>a non-negative integer vector of each observed historical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CompStat</code></td>
<td>
<p>a list of four elements that represents the
"compatibility(sufficient) statistics" for <code class="reqn">\lambda</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
</p>
<p><code>n0</code> is the number of observations in the historical data.
</p>
<p><code>mean0</code> is the sample mean of the historical data.
</p>
<p><code>n1</code> is the number of observations in the current data.
</p>
<p><code>mean1</code> is the sample mean of the current data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">\lambda</code> and <code class="reqn">\delta</code>.
A Gamma distribution is used as the prior of <code class="reqn">\lambda</code>, and a Beta distribution is used as the prior of <code class="reqn">\delta</code>.
</p>
<p><code>lambda.shape</code> is the shape (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>lambda.scale</code> is the scale (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See example.
</p>


<h3>Value</h3>

<p>A numeric value between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code>ModeDeltaBerNPP</code>;
<code>ModeDeltaNormalNPP</code>;
<code>ModeDeltaMultinomialNPP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 10), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))

ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 9.5), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))

ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 9), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))
</code></pre>


</div>