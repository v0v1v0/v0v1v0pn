<div class="container">

<table style="width: 100%;"><tr>
<td>DPMGibbsN_SeqPrior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Slice Sampling of Dirichlet Process Mixture of Gaussian distributions</h2>

<h3>Description</h3>

<p>Slice Sampling of Dirichlet Process Mixture of Gaussian distributions
</p>


<h3>Usage</h3>

<pre><code class="language-R">DPMGibbsN_SeqPrior(
  z,
  prior_inform,
  hyperG0,
  N,
  nbclust_init,
  add.vagueprior = TRUE,
  weightnoninfo = NULL,
  doPlot = TRUE,
  plotevery = N/10,
  diagVar = TRUE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>data matrix <code>d x n</code> with <code>d</code> dimensions in rows
and <code>n</code> observations in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_inform</code></td>
<td>
<p>an informative prior such as the approximation computed by <code>summary.DPMMclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperG0</code></td>
<td>
<p>a non informative prior component for the mixing distribution.
Only used if <code>add.vagueprior</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbclust_init</code></td>
<td>
<p>number of clusters at initialization.
Default to 30 (or less if there are less than 30 observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.vagueprior</code></td>
<td>
<p>logical flag indicating whether a non informative component should
be added to the informative prior. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightnoninfo</code></td>
<td>
<p>a real between 0 and 1 giving the weights of the non informative component
in the prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>logical flag indicating whether to plot MCMC iteration or not.
Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotevery</code></td>
<td>
<p>an integer indicating the interval between plotted iterations when <code>doPlot</code>
is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagVar</code></td>
<td>
<p>logical flag indicating whether the variance of each cluster is
estimated as a diagonal matrix, or as a full matrix.
Default is <code>TRUE</code> (diagonal variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical flag indicating whether partition info is
written in the console at each MCMC iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>plot_DPM</code>.
Only used if <code>doPlot</code> is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a object of class <code>DPMclust</code> with the following attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>mcmc_partitions</code>:</td>
<td>
<p> a list of length <code>N</code>. Each
element <code>mcmc_partitions[n]</code> is a vector of length
<code>n</code> giving the partition of the <code>n</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>alpha</code>:</td>
<td>
<p> a vector of length <code>N</code>. <code>cost[j]</code> is the cost
associated to partition <code>c[[j]]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>listU_mu</code>:</td>
<td>
<p> a list of length <code>N</code> containing the matrices of
mean vectors for all the mixture components at each MCMC iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>listU_Sigma</code>:</td>
<td>
<p> a list of length <code>N</code> containing the arrays of
covariances matrices for all the mixture components at each MCMC iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>U_SS_list</code>:</td>
<td>
<p> a list of length <code>N</code> containing the lists of
sufficient statistics for all the mixture components at each MCMC iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>weights_list</code>:</td>
<td>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>logposterior_list</code>:</td>
<td>
<p> a list of length <code>N</code> containing the logposterior values
at each MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>data</code>:</td>
<td>
<p> the data matrix <code>d x n</code> with <code>d</code> dimensions in rows
and <code>n</code> observations in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>nb_mcmcit</code>:</td>
<td>
<p> the number of MCMC iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>clust_distrib</code>:</td>
<td>
<p> the parametric distribution of the mixture component - <code>"gaussian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>hyperG0</code>:</td>
<td>
<p> the prior on the cluster location</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Boris Hejblum, Chariff Alkhassim
</p>


<h3>References</h3>

<p>Hejblum BP, Alkhassim C, Gottardo R, Caron F and Thiebaut R (2019) 
Sequential Dirichlet Process Mixtures of Multivariate Skew t-distributions for 
Model-based Clustering of Flow Cytometry Data. The Annals of Applied Statistics, 
13(1): 638-660. &lt;doi: 10.1214/18-AOAS1209&gt; &lt;arXiv: 1702.04407&gt; 
<a href="https://arxiv.org/abs/1702.04407">https://arxiv.org/abs/1702.04407</a> <a href="https://doi.org/10.1214/18-AOAS1209">doi:10.1214/18-AOAS1209</a>
</p>


<h3>See Also</h3>

<p><code>postProcess.DPMMclust</code> <code>DPMGibbsN</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
rm(list=ls())
library(NPflow)
#Number of data
n &lt;- 1500
# Sample data
#m &lt;- matrix(nrow=2, ncol=4, c(-1, 1, 1.5, 2, 2, -2, 0.5, -2))
m &lt;- matrix(nrow=2, ncol=4, c(-.8, .7, .5, .7, .5, -.7, -.5, -.7))
p &lt;- c(0.2, 0.1, 0.4, 0.3) # frequence des clusters

sdev &lt;- array(dim=c(2,2,4))
sdev[, ,1] &lt;- matrix(nrow=2, ncol=2, c(0.3, 0, 0, 0.3))
sdev[, ,2] &lt;- matrix(nrow=2, ncol=2, c(0.1, 0, 0, 0.3))
sdev[, ,3] &lt;- matrix(nrow=2, ncol=2, c(0.3, 0.15, 0.15, 0.3))
sdev[, ,4] &lt;- .3*diag(2)
c &lt;- rep(0,n)
z &lt;- matrix(0, nrow=2, ncol=n)
for(k in 1:n){
 c[k] = which(rmultinom(n=1, size=1, prob=p)!=0)
 z[,k] &lt;- m[, c[k]] + sdev[, , c[k]]%*%matrix(rnorm(2, mean = 0, sd = 1), nrow=2, ncol=1)
 #cat(k, "/", n, " observations simulated\n", sep="")
}

d&lt;-2
# Set parameters of G0
hyperG0 &lt;- list()
hyperG0[["mu"]] &lt;- rep(0,d)
hyperG0[["kappa"]] &lt;- 0.001
hyperG0[["nu"]] &lt;- d+2
hyperG0[["lambda"]] &lt;- diag(d)/10

# hyperprior on the Scale parameter of DPM
a &lt;- 0.0001
b &lt;- 0.0001

# Number of iterations
N &lt;- 30

# do some plots
doPlot &lt;- TRUE
nbclust_init &lt;- 20



## Data
########
library(ggplot2)
p &lt;- (ggplot(data.frame("X"=z[1,], "Y"=z[2,]), aes(x=X, y=Y))
      + geom_point()
      + ggtitle("Toy example Data"))
p


if(interactive()){
# Gibbs sampler for Dirichlet Process Mixtures
##############################################

MCMCsample &lt;- DPMGibbsN(z, hyperG0, a, b, N=1500, doPlot, nbclust_init, plotevery=200,
                        gg.add=list(theme_bw(),
                                 guides(shape=guide_legend(override.aes = list(fill="grey45")))),
                        diagVar=FALSE)

s &lt;- summary(MCMCsample, posterior_approx=TRUE, burnin = 1000, thin=5)
F1 &lt;- FmeasureC(pred=s$point_estim$c_est, ref=c)
F1


MCMCsample2 &lt;- DPMGibbsN_SeqPrior(z, prior_inform=s$param_posterior,
                                  hyperG0, N=1500,
                                  add.vagueprior = TRUE,
                                  doPlot=TRUE, plotevery=100,
                                  nbclust_init=nbclust_init,
                                  gg.add=list(theme_bw(),
                                 guides(shape=guide_legend(override.aes = list(fill="grey45")))),
                                  diagVar=FALSE)


s2 &lt;- summary(MCMCsample2, burnin = 500, thin=5)
F2 &lt;- FmeasureC(pred=s2$point_estim$c_est, ref=c)
F2
}
</code></pre>


</div>