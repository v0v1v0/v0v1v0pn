<div class="container">

<table style="width: 100%;"><tr>
<td>ebpNS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonstationary ebp for proportion under generalized linear mixed model</h2>

<h3>Description</h3>

<p>This function gives the nonstationary ebp and the estimate of mean squared error (mse) for proportion
based on a generalized linear mixed model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ebpNS(
  formula,
  vardir,
  Ni,
  ni,
  lat,
  lon,
  method = "REML",
  maxit = 100,
  precision = 1e-04,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class list of formula, describe the model to be fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vardir</code></td>
<td>
<p>a vector of sampling variances of direct estimators for each small area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ni</code></td>
<td>
<p>a vector of population size for each small area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>a vector of sample size for each small area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>a vector of latitude for each small area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>a vector of longitude for each small area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>type of fitting method, default is "REML" method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>number of iterations allowed in the algorithm. Default is 100 iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precision</code></td>
<td>
<p>convergence tolerance limit for the Fisher-scoring algorithm. Default value is 1e-04</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame comprising the variables named in formula and vardir</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<dl>
<dt>ebp</dt>
<dd>
<p>a vector with the values of the estimators for each small area</p>
</dd>
<dt>mse</dt>
<dd>
<p>a vector of the mean squared error estimates for each small area</p>
</dd>
<dt>sample</dt>
<dd>
<p>a matrix consist of area code, ebp, mse, standard error (SE) and coefficient of variation (CV)</p>
</dd>
<dt>fit</dt>
<dd>
<p>a list containing the following objects:</p>
</dd>
</dl>
<ul>
<li>
<p> estcoef : a data frame with the estimated model coefficients in the first column (beta),
their asymptotic standard errors in the second column (std.error), the t statistics in
the third column (tvalue) and the p-values of the significance of each coefficient in
last column (pvalue)
</p>
</li>
<li>
<p> refvar : estimated random effects variance
</p>
</li>
<li>
<p> lambda : estimated spatial intensity parameter
</p>
</li>
<li>
<p> randomeffect : a data frame with the values of the area specific random effect
</p>
</li>
<li>
<p> gamma : a data frame with the values of the spatially correlated random effect
</p>
</li>
<li>
<p> variance : a covariance matrix of estimated variance components
</p>
</li>
<li>
<p> loglike : value of the loglikelihood
</p>
</li>
<li>
<p> deviance : value of the deviance
</p>
</li>
<li>
<p> loglike1 : value of the restricted loglikelihood
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Load data set
data(headcount)
# Fit a nonstationary generalized linear mixed model using headcount data
result &lt;- ebpNS(y~x1, var, N, n, lat, long, "REML", 100, 1e-04, headcount)
result
</code></pre>


</div>