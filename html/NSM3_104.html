<div class="container">

<table style="width: 100%;"><tr>
<td>pAnsBrad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to compute the P-value for the observed Ansari-Bradley C statistic.
</h2>

<h3>Description</h3>

<p>When there are no ties in the data, this function uses pansari and cansari from the base stats package to compute the C statistic and P-value ("Exact" or "Asymptotic").
The program is reasonably quick for large data in the absence of ties, well after the asymptotic approximation suffices, so Monte Carlo methods are not included.
</p>
<p>When there are ties in the data, this function computes the C statistic and P-value ("Exact", "Monte Carlo", or "Asymptotic").
</p>


<h3>Usage</h3>

<pre><code class="language-R">pAnsBrad(x,y=NA,g=NA,method=NA,n.mc=10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a list or a vector containing either all or the first group of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>If x contains the first group of data, y contains the second group of data. Otherwise, not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>If x contains a vector of all of the data, g is a vector of 1's and 2's corresponding to group labels. Otherwise, not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "Exact", "Monte Carlo" or "Asymptotic", indicating the desired distribution. When method=NA and there are no ties in the data, "Exact" will be used.  When method=NA and there are ties in the data, "Exact" will be used if the number of permutations is 10,000 or less. Otherwise, "Monte Carlo" will be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mc</code></td>
<td>

<p>If method="Monte Carlo", the number of Monte Carlo samples used to estimate the distribution. Otherwise, not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data entry is intended to be flexible, so that the two groups of data can be entered in any of three ways. For data a=1,2 and b=3,4 all of the following are equivalent:
</p>
<p><code>pAnsBrad(x=c(1,2),y=c(3,4))</code>
<code>pAnsBrad(x=list(c(1,2),c(3,4)))</code>
<code>pAnsBrad(x=c(1,2,3,4),g=c(1,1,2,2))</code>
</p>


<h3>Value</h3>

<p>Returns a list with "NSM3Ch5p" class containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of observations in the first data group (X)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations in the second data group (Y)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.stat</code></td>
<td>
<p>the observed C statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val</code></td>
<td>
<p>upper tail P-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.sided</code></td>
<td>
<p>two-sided P-value</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If method="Monte Carlo" and there are no ties in the data, a warning is displayed and the "Exact" method is used.
</p>


<h3>Author(s)</h3>

<p>Grant Schneider
</p>


<h3>See Also</h3>

<p>Also see <code>ansari.test</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Hollander, Wolfe, Chicken Example 5.1 Serum Iron Determination:
serum&lt;-list(ramsay = c(111, 107, 100, 99, 102, 106, 109, 108, 104, 99, 101, 96, 97, 102, 107,
113, 116, 113, 110, 98),
jung.parekh = c(107, 108, 106, 98, 105, 103, 110, 105, 104, 100, 96, 108, 103, 104, 114, 114,
113, 108, 106, 99))


pAnsBrad(serum)

##or, equivalently:
pAnsBrad(serum$ramsay, serum$jung.parekh)

</code></pre>


</div>