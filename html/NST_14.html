<div class="container">

<table style="width: 100%;"><tr>
<td>nst.panova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Permutational multivariate ANOVA test for ST and NST
</h2>

<h3>Description</h3>

<p>Permutational multivariate ANOVA test for stochasticity ratio and normalized stochasticity ratio between treatments
</p>


<h3>Usage</h3>

<pre><code class="language-R">nst.panova(nst.result, group=NULL, rand=999, trace=TRUE, SES=FALSE, RC=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nst.result</code></td>
<td>
<p>list object, the output of nsto, must have "details"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>nx1 matrix, if the grouping is different from the nst.result. default is NULL, means to use the grouping in nst.result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>integer, randomization times for permuational test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>logic, whether to show message when randomizing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SES</code></td>
<td>
<p>Logic, whether to perform the test for standardized effect size (SES). SES is (observed dissimilarity - mean of null dissimilarity)/standard deviation of null dissimilarity. default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RC</code></td>
<td>
<p>Logic, whether to perform the test for modified Raup-Crick metric (RC). RC is percentage of null dissimilarity lower than observed dissimilarity x 2 - 1. default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>PERMANOVA for stochasticity ratio (ST or NST or MST) or SES or RC is based on the comparison of F values between observed pattern and the permutated patterns where samples are randomly shuffled regardless of treatments.  However, it is a bit different from PERMANOVA for dissimilarity. The PERMANOVA of stochasticity ratio here is to ask whether the ST values within a group is higher than those within another group. But the PERMANOVA of dissimilarity is to ask whether the between-group dissimilarity is higher than within-group dissimilarity.
</p>


<h3>Value</h3>

<p>Output is a data.frame object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>name of index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group1</code></td>
<td>
<p>treatment/group name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group2</code></td>
<td>
<p>treatment/group name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Index.group1</code></td>
<td>
<p>index value in group1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Index.group2</code></td>
<td>
<p>index value in group2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Difference</code></td>
<td>
<p>index.group1 - index.group2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F.obs</code></td>
<td>
<p>F value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.anova</code></td>
<td>
<p>P value of parametric ANOVA test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.panova</code></td>
<td>
<p>P value of permutational ANOVA test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.perm</code></td>
<td>
<p>P value of permutational test of the difference</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Version 7: 2021.10.29, add PERMANOVA test for SES and RC.
Version 6: 2021.9.28, avoid error for special cases in permutation.
Version 5: 2021.8.25, revised to avoid error for special cases in MST calculation.
Version 4: 2020.10.14, debug some error when replecate number is low and edit details in help.
Version 3: 2019.10.8, Update reference.
Version 2: 2019.5.10
Version 1: 2017.12.30
</p>


<h3>Author(s)</h3>

<p>Daliang Ning
</p>


<h3>References</h3>

<p>Ning D., Deng Y., Tiedje J.M. &amp; Zhou J. (2019) A general framework for quantitatively assessing ecological stochasticity. Proceedings of the National Academy of Sciences 116, 16892-16898. doi:10.1073/pnas.1904623116. 
</p>


<h3>See Also</h3>

<p><code>tNST</code>, <code>nst.boot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(tda)
comm=tda$comm
group=tda$group
tnst=tNST(comm=comm, group=group, rand=20,
          output.rand=TRUE, nworker=1)
# rand is usually set as 1000, here set rand=20 to save test time.

nst.pova=nst.panova(nst.result=tnst, rand=99)
# rand is usually set as 999, here set rand=99 to save test time.
</code></pre>


</div>