<div class="container">

<table style="width: 100%;"><tr>
<td>MKF.Full.RB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full Information Propagation Step under Mixture Kalman Filter</h2>

<h3>Description</h3>

<p>This function implements the full information propagation step under mixture Kalman filter with full information proposal distribution and Rao-Blackwellization, no delay.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MKF.Full.RB(
  MKFstep.Full.RB,
  nobs,
  yy,
  mm,
  par,
  II.init,
  mu.init,
  SS.init,
  xdim,
  ydim,
  resample.sch
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>MKFstep.Full.RB</code></td>
<td>
<p>a function that performs one step propagation under mixture Kalman filter, with full information proposal distribution.
Its input includes <code>(mm,II,mu,SS,logww,yyy,par,xdim,ydim)</code>, where
<code>II</code>, <code>mu</code>, and <code>SS</code> are the indicators and its corresponding mean and variance matrix of the Kalman filter components in the last iterations.
<code>logww</code> is the log weight of the last iteration. <code>yyy</code> is the
observation at current time step. It should return the Rao-Blackwellization estimation of the mean and variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of observations <code>T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yy</code></td>
<td>
<p>the observations with <code>T</code> columns and <code>ydim</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mm</code></td>
<td>
<p>the Monte Carlo sample size <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a list of parameter values to pass to <code>Sstep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>II.init</code></td>
<td>
<p>the initial indicators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.init</code></td>
<td>
<p>the initial mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SS.init</code></td>
<td>
<p>the initial variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdim</code></td>
<td>
<p>the dimension of the state varible <code>x_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydim</code></td>
<td>
<p>the dimension of the observation <code>y_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample.sch</code></td>
<td>
<p>a binary vector of length <code>nobs</code>, reflecting the resampling schedule. resample.sch[i]= 1 indicating resample should be carried out at step <code>i</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xhat</code></td>
<td>
<p>the fitted value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xhatRB</code></td>
<td>
<p>the fitted value using Rao-Blackwellization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Iphat</code></td>
<td>
<p>the estimated indicators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IphatRB</code></td>
<td>
<p>the estimated indicators using Rao-Blackwellization.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Tsay, R. and Chen, R. (2018). Nonlinear Time Series Analysis. John Wiley &amp; Sons, New Jersey.
</p>


</div>