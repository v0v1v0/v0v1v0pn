<div class="container">

<table style="width: 100%;"><tr>
<td>SMC.Smooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Sequential Monte Carlo Smoothing with Marginal Weights</h2>

<h3>Description</h3>

<p>Generic sequential Monte Carlo smoothing with marginal weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SMC.Smooth(
  SISstep,
  SISstep.Smooth,
  nobs,
  yy,
  mm,
  par,
  xx.init,
  xdim,
  ydim,
  resample.sch,
  funH = identity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SISstep</code></td>
<td>
<p>a function that performs one propagation step using a proposal distribution.
Its input includes <code>(mm,xx,logww,yyy,par,xdim,ydim)</code>, where
<code>xx</code> and <code>logww</code> are the last iteration samples and log weight. <code>yyy</code> is the
observation at current time step. It should return xx (the samples xt) and
logww (their corresponding log weight).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SISstep.Smooth</code></td>
<td>
<p>the function for backward smoothing step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the number of observations <code>T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yy</code></td>
<td>
<p>the observations with <code>T</code> columns and <code>ydim</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mm</code></td>
<td>
<p>the Monte Carlo sample size <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a list of parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xx.init</code></td>
<td>
<p>the initial samples of <code>x_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdim</code></td>
<td>
<p>the dimension of the state variable <code>x_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydim</code></td>
<td>
<p>the dimension of the observation <code>y_t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample.sch</code></td>
<td>
<p>a binary vector of length <code>nobs</code>, reflecting the resampling schedule. resample.sch[i]= 1 indicating resample should be carried out at step <code>i</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funH</code></td>
<td>
<p>a user supplied function <code>h()</code> for estimation <code>E(h(x_t) | y_1,...,y_T</code>). Default
is identity for estimating the mean. The function should be able to take vector or matrix as input and operates on each element of the input.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns the smoothed values.
</p>


<h3>References</h3>

<p>Tsay, R. and Chen, R. (2018). Nonlinear Time Series Analysis. John Wiley &amp; Sons, New Jersey.
</p>


</div>