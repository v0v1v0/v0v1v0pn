<div class="container">

<table style="width: 100%;"><tr>
<td>KSperm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a p-value for the significance of the Kolmogorov-Smirnov D-statistic from confirm().</h2>

<h3>Description</h3>

<p>For a given confirm() output object, KSperm() simulates the NULL distribution of LTDs or
LRCs resulting from Purely Random Clusterings of experimental units within the parent data.frame.
This NULL distribution is discrete because Local Effect-Size estimates are TIED within-clusters. The
observed D-Statistic from confirm() is compared with new NULL order statistics computed by KSperm(),
again using stats::ks.test. When KSperm() is called immediately after confirm() and the seed value
used in confirm() is known, then both the simulated p-value and the additional NULL KS-D order
statistics generated by KSperm() will all be reproducible.   
</p>


<h3>Usage</h3>

<pre><code class="language-R">KSperm(x, reps=100)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An output object from confirm().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>This is the number of new NULL KS-D statistics to generated. Each experimental unit is
used at most once within each full replication. No clusters will be empty, but some may be
"uninformative".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observed value of the Kolmogorov-Smirnov D-statistic from confirm() is used here, but
its "p.value" from ks.test() is not because it is badly biased downwards. This bias results because
the distribution of LTDs or LRCs across clusters is always discrete, due to TIED values within clusters
that typically also vary in size. Thus, KSperm() generates "reps" additional, independent, NULL values
of KS-D and saves their order statistics. Finally, KSperm() compares the Observed KS-D from confirm()
with its simulated NULL order statistics to estimate an appropriately "adjusted" p-value, pv.adj. Note
that the simulated pv.adj value estimate cannot be less than 1/(reps).
</p>


<h3>Value</h3>

<p> An output list object of class KSperm:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hiclus</code></td>
<td>
<p>Hierarchical clustering object created by the designated method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, t &amp; Y variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trtm</code></td>
<td>
<p>Name of numerical treatment/exposure variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>Name of numerical y-Outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>
<p>1 ==&gt; LTDs, otherwise LRCs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Number of overall Replications, each with the same number, K, of requested clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclus</code></td>
<td>
<p>Number of clusters requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>Number of experimental units or patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsD</code></td>
<td>
<p>Observed numerical value of KS D-statistic from confirm()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dvec</code></td>
<td>
<p>Vector of order statistics for simulated NULL KS D-statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.adj</code></td>
<td>
<p>Simulated p-value adjusted for TIES within discrete LTD/LRC distributions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192. 
</p>
<p>Obenchain RL. (2019) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code>confirm</code>, <code>ltdagg</code> and <code>lrcagg</code>.</p>


</div>