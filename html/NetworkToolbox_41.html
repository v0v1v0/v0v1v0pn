<div class="container">

<table style="width: 100%;"><tr>
<td>gain.functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MFCF Gain Functions</h2>

<h3>Description</h3>

<p>These functions maximize a gain criterion
for adding a node to a clique (and the larger network).
The flexibility of <code>MFCF</code>
allows for any multivariate function to be used as a
scoring function.
</p>

<ul>
<li>
<p><code>"logLik"</code>
</p>
<p>The log determinant of the matrix restricted to 
the separator minus the log determinant of the matrix restricted
to the clique.
</p>
</li>
<li>
<p><code>"logLik.val"</code>
</p>
<p><code>"logLik"</code> with a further validation based on
the likelihood ratio. If the increase in gain is not significant
the routine stops adding nodes to the separator.
</p>
</li>
<li>
<p><code>"rSquared.val"</code>
</p>
<p>The R squared from the regression of the node against the clique. Only
the clique nodes with a regression coefficient significantly different
from zero are added to the separator / new clique. The gain is different from 
zero only if the F-values is significant, It assumed that the <code>data</code> 
matrix is a dataset of realizations (i.e., <code>p</code>
variables and <code>n</code> observations). 
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">"logLik"
gfcnv_logdet(data, clique_id, cl, excl_nodes, ctreeControl)

"logLik.val"
gfcnv_logdet_val(data, clique_id, cl, excl_nodes, ctreeControl)

"rSquared.val"
gdcnv_lmfit(data, clique_id, cl, excl_nodes, ctreeControl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Matrix or data frame.
Can be a dataset or a correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clique_id</code></td>
<td>
<p>Numeric.
Number corresponding to clique to add another node to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>List.
List of cliques already assembled in the network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excl_nodes</code></td>
<td>
<p>Numeric vector.
A vector of numbers corresponding to nodes not already
included in the network</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctreeControl</code></td>
<td>
<p>List (length = 5).
A list containing several parameters for controlling
the clique tree sizes:
</p>

<ul>
<li>
<p><code>min_size</code>
Numeric. Minimum number of nodes allowed per
clique. Defaults to <code>1</code>
</p>
</li>
<li>
<p><code>max_size</code>
Numeric. Maximum number of nodes allowed per
clique. Defaults to <code>8</code>
</p>
</li>
<li>
<p><code>pval</code>
Numeric. <em>p</em>-value used to determine cut-offs for nodes
to include in a clique. Defaults to <code>.05</code>
</p>
</li>
<li>
<p><code>pen</code>
Numeric. Multiplies the number of edges added to penalize 
complex models. Similar to the penalty term in AIC
</p>
</li>
<li>
<p><code>drop_sep</code>
Boolean. This parameter influences the MFCF only. If TRUE any
separator can be used only once, as in the TMFG.
</p>
</li>
<li>
<p><code>use_returns</code>
Boolean. Only used in rSquared.val. If set to TRUE the regression is 
performed on log-returns. Defaults to <code>FALSE</code>
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the value with the maximum gain
</p>


<h3>Author(s)</h3>

<p>Guido Previde Massara &lt;gprevide@gmail.com&gt; and Alexander Christensen &lt;alexpaulchristensen@gmail.com&gt;
</p>


<h3>References</h3>

<p>Massara, G. P. &amp; Aste, T. (2019).
Learning clique forests.
<em>ArXiv</em>.
</p>


</div>