<div class="container">

<table style="width: 100%;"><tr>
<td>plot_rolcor_estim_1win</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the variables under analysis and the rolling correlation coefficients that are statistically significant for only one window-length 
</h2>

<h3>Description</h3>

<p>The <code>plot_rolcor_estim_1win</code> function plots the time series under study and create a simple plot of the rolling window correlation coefficients that are statistically significant that are obtained by the <code>rolcor_estim_1win</code> function. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_rolcor_estim_1win(inputdata, corcoefs, CRITVAL, widthwin, left_win,
                  righ_win, varX="X", varY="Y", coltsX="black", coltsY="blue", 
                  rmltrd=TRUE, Scale=TRUE, HeigWin1=2.05, HeigWin2=2.75, 
                  colCOEF="black", CEXLAB=1.15, CEXAXIS=1.05, LWDtsX=1, 
                  LWDtsY=1, LWDcoef=1, colCRITVAL="black", pchCRIVAL=16) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputdata</code></td>
<td>
 
<p>The same data matrix (time, first and second variable) that was used with the <code>rolcor_estim_1win</code> function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corcoefs</code></td>
<td>

<p>Rolling correlation coefficients estimated with the <code>rolcor_estim_1win</code> function. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CRITVAL</code></td>
<td>
 
<p>The critical values computed through the function <code>rolcor_estim_1win</code>, which are used to determine the statistical significance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widthwin</code></td>
<td>
 
<p><code>widthwin</code> contains the window-length (time-scale) that come from the function <code>rolcor_estim_1win</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left_win, righ_win</code></td>
<td>
 
<p>These parameters are used to accommodate (to the left and right) the times of the rolling window correlation coefficients and these are provided by the <code>rolcor_estim_1win</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varX, varY</code></td>
<td>
 
<p>Names of the first (e.g., X) and the second (e.g., Y) variables contained in <code>inputdata</code>. Please note that the names of these two variables should be provided (by default are X and Y) when these variables are plotted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coltsX, coltsY</code></td>
<td>
 
<p>Colors to be used when the variables are plotted, by default are “black” for the first variable and “blue” for the second, but other colors can be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmltrd</code></td>
<td>

<p>Remove (by default is “TRUE”; “FALSE” otherwise) the linear trend in the variables under analysis. It is advisable to remove the trend before estimating the rolling window correlation coefficients, especially, for large window-lengths. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Scale</code></td>
<td>

<p>Scale (by default is “TRUE”; “FALSE”  otherwise) is used to “normalize” or “standardize” the variables under analysis. It is highly advisable to ”normalize/standardize” the time series under study to have them in the same scales. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HeigWin1, HeigWin2</code></td>
<td>

<p>Proportion of window's size to plot the time series under analysis (<code>HeigWin1</code>) and the rolling window correlation coefficients (<code>HeigWin2</code>) (look at: <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>&gt;?layout to get more information about “layout”). By default <code>HeigWin1</code> and <code>HeigWin2</code> have values of 2.05 and 2.75, but other values can be used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colCOEF</code></td>
<td>

<p>The color to be used when the correlation coefficients are plotted, by default the color is “black”, but other colors can be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CEXLAB, CEXAXIS</code></td>
<td>

<p>These parameters are used to plot the sizes of the X-axis and Y-axis labels and X- and Y-axis, by default these parameters have values of 1.15 and 1.05, respectively, but it is possible to use other values. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LWDtsX, LWDtsY</code></td>
<td>

<p>Line-widths for the first and the second variable when these are plotted, by default these have values of 1, but other values (widths) can be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LWDcoef</code></td>
<td>

<p>The line-width to be used when the correlation coefficients are plotted, by default this parameter has a value of 1, but it is possible to use other values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colCRITVAL</code></td>
<td>

<p><code>colCRITVAL</code> defines the color used to plot the correlation coefficients that are statistically significant.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchCRIVAL</code></td>
<td>

<p><code>pchCRITVAL</code> is used for the type (symbols) of the plot for the correlation coefficients that are statistically significant.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plot_rolcor_estim_1win</code> function plots the variables (time series) under analysis and for the selected window-length, the rolling correlation coefficients that are statistically significant, which are estimated through a non-parametric computing-intensive method. The <code>plot_rolcor_estim_1win</code> function uses the outputs of <code>rolcor_estim_1win</code>. To implement this method we extend the works of Telford (2013), Polanco-Martínez (2019) and Polanco-Martínez (2020), and to implement the simple plot we follow to Polanco-Martínez (2020). The test/method to determine the statistical significance is described in Polanco-Martínez and López-Martínez (2021). 
</p>


<h3>Value</h3>

<p>Outputs:
A plot of the time series under analysis, and for the selected window-length, the rolling window correlation coefficients that are statistically significant. This multi-plot can be saved in your preferred format. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br>
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br>
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br>
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br>
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>.<br></p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics, 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br></p>
<p>Polanco-Martínez, J. M. (2020). NonParRolCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Code to test the function "plot_rolcol_estim_1win"
 # Defining NonParRolCor parameters 
 MCSim &lt;- 2 
 Np    &lt;- 2
 X_Y &lt;- rolcor_estim_1win(as.matrix(syntheticdata[1:350,]), 
                   CorMethod="pearson", widthwin=21, Align="center", 
                   rmltrd=TRUE, Scale=TRUE, MCSim=MCSim, Np=Np, prob=0.95)
 plot_rolcor_estim_1win(syntheticdata[1:350,], 
                   corcoefs=X_Y$Correlation_coefficients, 
                   CRITVAL=X_Y$CRITVAL, widthwin=X_Y$widthwin, 
                   left_win=X_Y$left_win, righ_win=X_Y$righ_win)
 </code></pre>


</div>