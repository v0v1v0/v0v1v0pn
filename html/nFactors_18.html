<div class="container">

<table style="width: 100%;"><tr>
<td>nBartlett</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bartlett, Anderson and Lawley Procedures to Determine the Number of Components/Factors</h2>

<h3>Description</h3>

<p>This function computes the Bartlett, Anderson and Lawley indices for determining the
number of components/factors to retain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nBartlett(x, N, alpha = 0.05, cor = TRUE, details = TRUE,
  correction = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric: a <code>vector</code> of eigenvalues, a <code>matrix</code> of correlations or of covariances or a <code>data.frame</code> of data (eigenFrom)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>numeric: number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric: statistical significance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>logical: if <code>TRUE</code> computes eigenvalues from a correlation matrix, else from a covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>logical: if <code>TRUE</code> also returns detains about the computation for each eigenvalue</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>logical: if <code>TRUE</code> uses a correction for the degree of freedom after the first eigenvalue</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>variable: additionnal parameters to give to the <code>cor</code> or <code>cov</code> functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: the latex formulas are available only in the pdf version of this help file.
</p>
<p>The hypothesis tested is: <br></p>
<p>(1)  <code class="reqn">\qquad \qquad H_k: \lambda_{k+1} = \ldots = \lambda_p</code> <br></p>
<p>This hypothesis is verified by the application of different version of a
<code class="reqn">\chi^2</code> test with different values for the degrees of freedom.
Each of these tests shares the compution of a <code class="reqn">V_k</code> value: <br></p>
<p>(2) <code class="reqn">\qquad \qquad V_k  =
  \prod\limits_{i = k + 1}^p
  \left\{ \frac{\displaystyle \lambda_i}{\frac{1}{q}\sum\limits_{i = k + 1}^p {\lambda
  _i } } \right\} </code>
</p>
<p><code class="reqn">p</code> is the number of eigenvalues, <code class="reqn">k</code> the number of eigenvalues to test,
and <code class="reqn">q</code> the <code class="reqn">p-k</code> remaining eigenvalues. <code class="reqn">n</code> is equal to the sample size
minus 1 (<code class="reqn">n = N-1</code>). <br></p>
<p>The Anderson statistic is distributed as a <code class="reqn">\chi^2</code> with <code class="reqn">(q + 2)(q - 1)/2</code> degrees
of freedom and is equal to: <br></p>
<p>(3) <code class="reqn">\qquad \qquad - n\log (V_k ) \sim \chi _{(q + 2)(q - 1)/2}^2 </code> <br></p>
<p>An improvement of this statistic from Bartlett (Bentler, and Yuan, 1996, p. 300;
Horn and Engstrom, 1979, equation 8) is distributed as a <code class="reqn">\chi^2</code>
with <code class="reqn">(q)(q - 1)/2</code> degrees of freedom and is equal to: <br></p>
<p>(4) <code class="reqn">\qquad \qquad - \left[ {n - k - {{2q^2 q + 2} \over {6q}}}
                                \right]\log (V_k ) \sim \chi _{(q + 2)(q - 1)/2}^2 </code>  <br></p>
<p>Finally, Anderson (1956) and James (1969) proposed another statistic. <br></p>
<p>(5) <code class="reqn">\qquad \qquad - \left[ {n - k - {{2q^2 q + 2} \over {6q}}
  + \sum\limits_{i = 1}^k {{{\bar \lambda _q^2 } \over {\left( {\lambda _i
    - \bar \lambda _q } \right)^2 }}} } \right]\log (V_k ) \sim \chi _{(q + 2)(q - 1)/2}^2 </code> <br></p>
<p>Bartlett (1950, 1951) proposed a correction to the degrees of freedom of these <code class="reqn">\chi^2</code> after the
first significant test: <code class="reqn">(q+2)(q - 1)/2</code>. <br></p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nFactors</code></td>
<td>
<p>numeric: vector of the number of factors retained by the Bartlett, Anderson and Lawley procedures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>numeric: matrix of the details for each index.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gilles Raiche <br> Centre sur les Applications des Modeles de
Reponses aux Items (CAMRI) <br> Universite du Quebec a Montreal<br><a href="mailto:raiche.gilles@uqam.ca">raiche.gilles@uqam.ca</a>
</p>


<h3>References</h3>

<p>Anderson, T. W. (1963). Asymptotic theory for principal component analysis. <em>Annals of Mathematical Statistics, 34</em>, 122-148.
</p>
<p>Bartlett, M. S. (1950). Tests of significance in factor analysis. <em>British Journal of Psychology, 3</em>, 77-85.
</p>
<p>Bartlett, M. S. (1951). A further note on tests of significance. <em>British Journal of Psychology, 4</em>, 1-2.
</p>
<p>Bentler, P. M. and Yuan, K.-H. (1996). Test of linear trend in eigenvalues of a covariance matrix with application to data analysis.
<em>British Journal of Mathematical and Statistical Psychology, 49</em>, 299-312.
</p>
<p>Bentler, P. M. and Yuan, K.-H. (1998). Test of linear trend in the smallest
eigenvalues of the correlation matrix. <em>Psychometrika, 63</em>(2), 131-144.
</p>
<p>Horn, J. L. and Engstrom, R. (1979). Cattell's scree test in relation to
Bartlett's chi-square test and other observations on the number of factors
problem. <em>Multivariate Behavioral Reasearch, 14</em>(3), 283-300.
</p>
<p>James, A. T. (1969). Test of equality of the latent roots of the covariance
matrix. <em>In</em> P. K. Krishna (Eds): <em>Multivariate analysis, volume 2</em>.New-York, NJ: Academic Press.
</p>
<p>Lawley, D. N. (1956). Tests of significance for the latent roots of covarianceand correlation matrix. <em>Biometrika, 43</em>(1/2), 128-136.
</p>


<h3>See Also</h3>

<p><code>plotuScree</code>, <code>nScree</code>, <code>plotnScree</code>, <code>plotParallel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ................................................
## SIMPLE EXAMPLE OF A BARTLETT PROCEDURE

data(dFactors)
eig      &lt;- dFactors$Raiche$eigenvalues

results  &lt;- nBartlett(x=eig, N= 100, alpha=0.05, details=TRUE)
results

plotuScree(eig, main=paste(results$nFactors[1], ", ",
                           results$nFactors[2], " or ",
                           results$nFactors[3],
                           " factors retained by the LRT procedures",
                           sep=""))

</code></pre>


</div>