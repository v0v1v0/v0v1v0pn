<div class="container">

<table style="width: 100%;"><tr>
<td>makeDomEpi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates the additive by dominance and dominance by dominance epistatic
genetic relationship matrices</h2>

<h3>Description</h3>

<p>Given a pedigree, the matrix of additive by dominance (AD) genetic
relatedness, dominance by dominance (DD) genetic relatedness, or both are
returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">makeDomEpi(
  pedigree,
  output = c("AD", "DD", "both"),
  parallel = FALSE,
  invertD = FALSE,
  det = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pedigree</code></td>
<td>
<p>A pedigree where the columns are ordered ID, Dam, Sire</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Character(s) denoting which matrix and its inverse is to be
constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>A logical indicating whether or not to use parallel
processing. Note, this may only be available on Mac and Linux operating
systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invertD</code></td>
<td>
<p>A logical indicating whether or not to invert the D matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det</code></td>
<td>
<p>A logical indicating whether or not to return the determinants
for the epistatic relationship matrices</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing parents (e.g., base population) should be denoted by either 'NA',
'0', or '*'.
</p>
<p>Because of the computational demands of constructing the D matrix (see
<code>makeD</code>), this function allows for the inverses that are derived
from the D matrix (i.e., D-inverse, AD-inverse, and DD-inverse)to be
constructed at the same time.  This way, the D matrix will only have to be
constructed once for use in the three separate genetic relatedness inverse
matrices that depend upon it.  However, using the <code>output</code> and
<code>invertD</code> options in different combinations will ensure that only the
desired matrix inverses are constructed.
</p>
<p><code>parallel</code> = TRUE should only be used on Linux or Mac OSes (i.e., not
Windows).
</p>
<p>Both the AD and DD matrix are computed from the Hadamard product of the
respective matrices (see also, <code>makeAA</code>).
</p>


<h3>Value</h3>

<p>All of the following will be returned. However, the values of the
<code>output</code> and <code>invertD</code> options passed to the function will
determine which of the following are not NULL objects within the list:
</p>
 
<dl>
<dt>D </dt>
<dd>
<p>the D matrix in sparse matrix form</p>
</dd>
<dt>logDetD </dt>
<dd>
<p>the log determinant of the D matrix</p>
</dd>
<dt>AD </dt>
<dd>
<p>the AD matrix in sparse matrix form</p>
</dd>
<dt>logDetAD </dt>
<dd>
<p>the log determinant of the AD matrix</p>
</dd>
<dt>DD </dt>
<dd>
<p>the DD matrix in sparse matrix form</p>
</dd> 
<dt>logDetDD </dt>
<dd>
<p>the log determinant of the DD matrix</p>
</dd>
<dt>Dinv </dt>
<dd>
<p>the inverse of the D matrix in sparse matrix form</p>
</dd>
<dt>ADinv </dt>
<dd>
<p>the inverse of the AD matrix in sparse matrix form</p>
</dd>
<dt>DDinv </dt>
<dd>
<p>the inverse of the DD matrix in sparse matrix form</p>
</dd>
<dt>listDinv </dt>
<dd>
<p>the three column form of the non-zero elements for the
inverse of the D matrix</p>
</dd>
<dt>listADinv </dt>
<dd>
<p>the three column form of the non-zero elements for the 
inverse of the AD matrix</p>
</dd>
<dt>listDDinv </dt>
<dd>
<p>the three column form of the non-zero elements for the 
inverse of the DD matrix</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p><a href="mailto:matthewwolak@gmail.com">matthewwolak@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>makeA</code>, <code>makeD</code>, <code>makeAA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  Boutput &lt;- makeDomEpi(Mrode9, output = "b", parallel = FALSE, invertD = FALSE)
  str(Boutput)
	
  DADoutput &lt;- makeDomEpi(Mrode9, output = "AD", parallel = FALSE, invertD = TRUE)
  str(DADoutput)

</code></pre>


</div>