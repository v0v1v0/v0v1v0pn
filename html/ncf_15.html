<div class="container">

<table style="width: 100%;"><tr>
<td>partial.mantel.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial Mantel test</h2>

<h3>Description</h3>

<p>A simple function to calculate permutation-based partial mantel tests for three matrices, the partial mantel test is calculated to test for relationships between M1 and M2 (M3) controlling for M3 (M2). syntax and logic follows Legendre and Legendre (1998) pp 557-558.
</p>


<h3>Usage</h3>

<pre><code class="language-R">partial.mantel.test(
  M1,
  M2,
  M3,
  resamp = 999,
  method = "pearson",
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M1</code></td>
<td>
<p>similarity/distance matrix 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M2</code></td>
<td>
<p>similarity/distance matrix 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M3</code></td>
<td>
<p>similarity/distance matrix 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resamp</code></td>
<td>
<p>the number of resamples for the null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used for calculating the correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>If TRUE, the counter is suppressed during execution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing values are treated through pairwise deletion. 
</p>
<p>The method must be one of "pearson" (default), "spearman" or "kendall".
</p>


<h3>Value</h3>

<p>An object of class "partial.Mantel" is returned, consisting of a list with two components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MantelR</code></td>
<td>
<p>the vector of observed Mantel and partial Mantel correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the vector of two-sided p-value under randomization (of M1).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ottar N. Bjornstad <a href="mailto:onb1@psu.edu">onb1@psu.edu</a>
</p>


<h3>References</h3>

<p>Legendre, P., and L. Legendre. 1998. Numerical Ecology, 2nd edition. Elsevier, Amsterdam
</p>


<h3>See Also</h3>

<p><code>mantel.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># first generate some sample data and dissimilarity matrices
x &lt;- rnorm(10)
y &lt;- rnorm(10)
z &lt;- rnorm(10)
M1 &lt;- sqrt(outer(x, x, "-")^2)
M2 &lt;- sqrt(outer(y, y, "-")^2)
M3 &lt;- sqrt(outer(z, z, "-")^2)

partial.mantel.test(M1 = M1, M2 = M2, M3 = M3, resamp = 999)
</code></pre>


</div>