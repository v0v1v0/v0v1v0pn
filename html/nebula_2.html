<div class="container">

<table style="width: 100%;"><tr>
<td>group_cell</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Group cells according to subject IDs</h2>

<h3>Description</h3>

<p>Group cells according to subject IDs
</p>


<h3>Usage</h3>

<pre><code class="language-R">group_cell(count, id, pred = NULL, offset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>A raw count matrix of the single-cell data. The rows are the genes, and the columns are the cells. The matrix can be a matrix object or a sparse dgCMatrix object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A vector of subject IDs. The length should be the same as the number of columns of the count matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A design matrix of the predictors. The rows are the cells and the columns are the predictors. If not specified, an intercept column will be generated by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>A vector of the scaling factor. The values must be strictly positive. If not specified, a vector of all ones will be generated by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>count: A reordered count matrix. If the cells are already grouped, the function returns NULL.
</p>
<p>id: A reordered subject ID vector.
</p>
<p>pred: A reordered design matrix of the predictors.
</p>
<p>offset: A reordered vector of the scaling factor.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nebula)
data(sample_data)
pred = model.matrix(~X1+X2+cc,data=sample_data$pred)
df_order = group_cell(count=sample_data$count,id=sample_data$sid,pred=pred)

</code></pre>


</div>