<div class="container">

<table style="width: 100%;"><tr>
<td>nbresidual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Pearson residuals from the results of NEBULA</h2>

<h3>Description</h3>

<p>Extract Pearson residuals from the results of NEBULA
</p>


<h3>Usage</h3>

<pre><code class="language-R">nbresidual(nebula, count, id, pred = NULL, offset = NULL, conditional = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nebula</code></td>
<td>
<p>An object of the result obtained from running the function nebula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>A raw count matrix of the single-cell data. The rows are the genes, and the columns are the cells. The matrix can be a matrix object or a sparse dgCMatrix object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A vector of subject IDs. The length should be the same as the number of columns of the count matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A design matrix of the predictors. The rows are the cells and the columns are the predictors. If not specified, an intercept column will be generated by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>A vector of the scaling factor. The values must be strictly positive. If not specified, a vector of all ones will be generated by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conditional</code></td>
<td>
<p>A logical value. By default (FALSE), the function returns marginal Pearson residuals. If TRUE, the function will return conditional Pearson residuals.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>residuals: A matrix of Pearson residuals. The number of columns is the number of cells in the count matrix. The rows correspond to gene IDs reported in the result from nebula.
</p>
<p>gene: Gene names corresponding to the row names of the count matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nebula)
data(sample_data)
pred = model.matrix(~X1+X2+cc,data=sample_data$pred)
re = nebula(count=sample_data$count,id=sample_data$sid,pred=pred)
resid = nbresidual(re,count=sample_data$count,id=sample_data$sid,pred=pred)

</code></pre>


</div>