<div class="container">

<table style="width: 100%;"><tr>
<td>moran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes Moran's I correlation index</h2>

<h3>Description</h3>

<p>Natively built for computing Moran's I on <code>dgCMatrix</code> objects, this
routine allows computing the I on large sparse matrices (graphs). Part of
its implementation was based on <code>ape::Moran.I</code>,
which computes the I for dense matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moran(x, w, normalize.w = TRUE, alternative = "two.sided")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector of size <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Numeric matrix of size <code class="reqn">n\times n</code>. Weights. It can be
either a object of class <code>matrix</code> or <code>dgCMatrix</code>
from the <code>Matrix</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize.w</code></td>
<td>
<p>Logical scalar. When TRUE normalizes rowsums to one (or zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character String. Specifies the alternative hypothesis that
is tested against the null of no autocorrelation; must be of one <code>"two.sided"</code>,
<code>"less"</code>, or <code>"greater"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the case that the vector <code>x</code> is close to constant (degenerate random
variable), the statistic becomes irrelevant, and furthermore, the standard error
tends to be undefined (<code>NaN</code>).
</p>


<h3>Value</h3>

<p>A list of class <code>diffnet_moran</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>Numeric scalar. Observed correlation index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>Numeric scalar. Expected correlation index equal to <code class="reqn">-1/(N-1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Numeric scalar. Standard error under the null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>Numeric scalar. p-value of the specified <code>alternative</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>George G. Vega Yon
</p>


<h3>References</h3>

<p>Moran's I. (2015, September 3). In Wikipedia, The Free Encyclopedia.
Retrieved 06:23, December 22, 2015, from <a href="https://en.wikipedia.org/w/index.php?title=Moran%27s_I&amp;oldid=679297766">https://en.wikipedia.org/w/index.php?title=Moran%27s_I&amp;oldid=679297766</a>
</p>


<h3>See Also</h3>

<p>Other statistics: 
<code>bass</code>,
<code>classify_adopters()</code>,
<code>cumulative_adopt_count()</code>,
<code>dgr()</code>,
<code>ego_variance()</code>,
<code>exposure()</code>,
<code>hazard_rate()</code>,
<code>infection()</code>,
<code>struct_equiv()</code>,
<code>threshold()</code>,
<code>vertex_covariate_dist()</code>
</p>
<p>Other Functions for inference: 
<code>bootnet()</code>,
<code>struct_test()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (require("ape")) {

  # Generating a small random graph
  set.seed(123)
  graph &lt;- rgraph_ba(t = 4)
  w &lt;- approx_geodesic(graph)
  x &lt;- rnorm(5)

  # Computing Moran's I
  moran(x, w)

  # Comparing with the ape's package version
  ape::Moran.I(x, as.matrix(w))

}

</code></pre>


</div>