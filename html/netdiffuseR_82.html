<div class="container">

<table style="width: 100%;"><tr>
<td>egonet_attrs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve alter's attributes (network effects)</h2>

<h3>Description</h3>

<p>For a given set of vertices V, retrieves each vertex's alter's
attributes. This function enables users to calculate exposure on variables
other than the attribute that is diffusing.  Further, it enables the
specification of alternative functions to use to characterize ego's
personal network including calculating the mean, maximum, minimum, median, or
sum of the alters' attributes. These measures may be static or dynamic over
the interval of diffusion and they may be binary or valued.
</p>


<h3>Usage</h3>

<pre><code class="language-R">egonet_attrs(
  graph,
  attrs,
  V = NULL,
  direction = "outgoing",
  fun = function(x) x,
  as.df = FALSE,
  self = getOption("diffnet.self"),
  valued = getOption("diffnet.valued"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>Any class of accepted graph format (see <code>netdiffuseR-graphs</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrs</code></td>
<td>
<p>If <code>graph</code> is static, Numeric matrix with <code class="reqn">n</code> rows, otherwise a list of numeric matrices with <code class="reqn">n</code> rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Integer vector. Set of vertices from which the attributes will be retrieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>Character scalar. Either <code>"outgoing"</code>, <code>"incoming"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>Function. Applied to each</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.df</code></td>
<td>
<p>Logical scalar. When TRUE returns a data.frame instead of a list (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self</code></td>
<td>
<p>Logical scalar. When <code>TRUE</code> autolinks (loops, self edges) are allowed (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valued</code></td>
<td>
<p>Logical scalar. When <code>TRUE</code> weights will be considered. Otherwise non-zero values will be replaced by ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>fun</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By indexing inner/outer edges, this function retrieves ego network attributes
for all <code class="reqn">v \in V</code>, which by default is the complete set
of vertices in the graph.
</p>
<p>When <code>as.df=TRUE</code> the function returns a data.frame of size
<code class="reqn">(|V|\times T)\times k</code> where <code class="reqn">T</code> is the number of time
periods and <code class="reqn">k</code> is the number of columns generated by the function.
</p>
<p>The function can be used to create network effects as those in the <span class="pkg">RSiena</span>
package. The difference here is that the definition of the statistic directly
relies on the user. For example, in the <span class="pkg">RSiena</span> package, the dyadic covariate
effect <em>37. covariate (centered) main effect (X)</em>
</p>
<p style="text-align: center;"><code class="reqn">%
s_{i37}(x) = \sum_j x_{ij}(w_{ij}-\bar w)
</code>
</p>

<p>Which, having a diffnet object with attributes named <code>x</code> and <code>w</code>,
can be calculated as
</p>
<pre>
    egonet_attrs(diffnet, as.df=TRUE, fun=function(dat) {
     sum(dat[, "x"]*(dat[, "w"] - mean(dat[, "w"])))
    })
    </pre>
<p>Furthermore, we could use the <em>median</em> centered instead, for example
</p>
<pre>
    egonet_attrs(diffnet, as.df=TRUE, fun=function(dat) {
     sum(dat[, "x"]*(dat[, "w"] - median(dat[, "w"])))
    })
    </pre>
<p>Where for each <code class="reqn">i</code>, <code>dat</code> will be a matrix with as many rows
as individuals in his egonetwork. Such matrix holds the column names of the
attributes in the network.
</p>
<p>When <code>self = TRUE</code>, it will include ego's attributes, regardless
the network has loops or not.
</p>


<h3>Value</h3>

<p>A list with ego alters's attributes. By default, if the graph is static, the
output is a list of length <code>length(V)</code> with matrices having the following
columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>Either the corresponding value of the tie.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Alter's id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further attributes contained in <code>attrs</code></p>
</td>
</tr>
</table>
<p>On the other hand, if <code>graph</code> is dynamic, the output is list of length
<code class="reqn">T</code> of lists of length <code>length(V)</code> with data frames having the following
columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>The corresponding value of the adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Alter's id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per</code></td>
<td>
<p>Time id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further attributes contained in <code>attrs</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>George G. Vega Yon
</p>


<h3>See Also</h3>

<p>Other data management functions: 
<code>diffnet-class</code>,
<code>edgelist_to_adjmat()</code>,
<code>isolated()</code>,
<code>survey_to_diffnet()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simple example with diffnet -----------------------------------------------
set.seed(1001)
diffnet &lt;- rdiffnet(150, 5, seed.graph="small-world")

# Adding attributes
indeg &lt;- dgr(diffnet, cmode="indegree")
head(indeg)
diffnet[["indegree"]] &lt;- indeg

# Retrieving egonet's attributes (vertices 1 and 20)
egonet_attrs(diffnet, V=c(1,20))

# Example with a static network ---------------------------------------------

set.seed(1231)
n &lt;- 20
net &lt;- rgraph_ws(n = n, k = 4, p = .5)
someattr &lt;- matrix(rnorm(n * 2), ncol= 2, dimnames = list(NULL, c("a", "b")))

# Maximum of -a- in ego network
ans &lt;- egonet_attrs(net, someattr, fun = function(x) max(x[,"a"]))
ans

# checking it worked, taking a look at node 1, 2, and 3
max(someattr[which(net[1,] == 1),"a"]) == ans[1] # TRUE
max(someattr[which(net[2,] == 1),"a"]) == ans[2] # TRUE
max(someattr[which(net[3,] == 1),"a"]) == ans[3] # TRUE


</code></pre>


</div>