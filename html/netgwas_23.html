<div class="container">

<table style="width: 100%;"><tr>
<td>R.gibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> The expectation of covariance matrix using Gibbs sampling</h2>

<h3>Description</h3>

<p>This function implements the Gibbs sampling method within Gaussian copula graphical model to estimate the conditional expectation for the data that not follow Gaussianity assumption (e.g. ordinal, discrete, continuous non-Gaussian, or mixed dataset).
</p>


<h3>Usage</h3>

<pre><code class="language-R">R.gibbs(y, theta, gibbs.iter = 1000, mc.iter = 500, 
                   ncores = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>An (<code class="reqn">n \times p</code>) matrix or a <code>data.frame</code> corresponding to the data matrix (<code class="reqn">n</code> is the sample size and <code class="reqn">p</code> is the number of variables). 
It also could be an object of class <code>"simgeno"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p> A <code class="reqn">p \times p</code> precision matrix. Default is a diagonal matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gibbs.iter</code></td>
<td>
<p> The number of burn-in for the Gibbs sampling. The default value is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.iter</code></td>
<td>
<p> The number of Monte Carlo samples to calculate the conditional expectation. The default value is 500. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>If <code>ncores = NULL</code>, the algorithm internally detects number of available cores and run the calculations in parallel on (available cores - 1). Typical usage is to fix <code>ncores = 1</code> when <code class="reqn">p</code> is small <code class="reqn">( p &lt; 500 )</code>, and <code>ncores = NULL</code> when <code class="reqn">p</code> is very large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> If <code>verbose = FALSE</code>, printing information is disabled. The default value is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates <code class="reqn">\bar{R}</code> using Gibbs sampling method within the E-step of EM algorithm, where 
</p>
<p style="text-align: center;"><code class="reqn"> \bar{R} = n ^ {-1} \sum_{i=1}^{n} E( Z^{(i)} Z^{(i)t} | y^{(i)}, \hat{\Theta}^{(m)})</code>
</p>

<p>which <code class="reqn">n</code> is the number of sample size and <code class="reqn">Z</code> is the latent variable which is obtained from Gaussian copula graphical model.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>ES</code></td>
<td>
<p>Expectation of covariance matrix ( diagonal scaled to 1) of the Gaussian copula graphical model</p>
</td>
</tr></table>
<h3>Author(s)</h3>

 
<p>Pariya Behrouzi, Danny Arends and Ernst C. Wit <br>
Maintainers: Pariya Behrouzi <a href="mailto:pariya.behrouzi@gmail.com">pariya.behrouzi@gmail.com</a><br></p>


<h3>References</h3>

<p>1. Behrouzi, P., Arends, D., and Wit, E. C. (2023). netgwas: An R Package for Network-Based Genome-Wide Association Studies. The R journal, 14(4), 18-37.<br>
2. Behrouzi, P., and Wit, E. C. (2019). Detecting epistatic selection with partially observed genotype data by using copula graphical models. Journal of the Royal Statistical Society: Series C (Applied Statistics), 68(1), 141-160. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">D &lt;- simgeno(p = 100, n = 50, k = 3)
R.gibbs(D$data, ncores=1)
</code></pre>


</div>