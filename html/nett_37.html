<div class="container">

<table style="width: 100%;"><tr>
<td>snac_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SNAC test</h2>

<h3>Description</h3>

<p>The SNAC test to measure the goodness-of-fit of the DCSBM to network data.
</p>
<p>The function computes the SNAC+ or SNAC statistics in the paper below.
The row label vector of the adjacency matrix could be given through <code>z</code> otherwise will
be estimated by <code>cluster_fct</code>. One can specify the ratio of nodes used to estimate column
label vector. If <code>plus = TRUE</code>, the column labels will be estimated by spec_clust with
(<code>K</code>+1) clusters, i.e. performing SNAC+ test, otherwise with <code>K</code> clusters SNAC test.
One can also get multiple test statistics with repeated random subsampling on nodes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snac_test(
  A,
  K,
  z = NULL,
  ratio = 0.5,
  fromEachCommunity = TRUE,
  plus = TRUE,
  cluster_fct = spec_clust,
  nrep = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>desired number of communities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>label vector for rows of adjacency matrix. If not provided, will be estimated by
<code>cluster_fct</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>ratio of subsampled nodes from the network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fromEachCommunity</code></td>
<td>
<p>whether subsample from each estimated community or the full network,
default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plus</code></td>
<td>
<p>whether or not use column label vector with (<code>K</code>+1) communities to compute the statistics, default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_fct</code></td>
<td>
<p>community detection function to estimate label vectors, by default using spec_clust.
The first two arguments have to be <code>A</code> and <code>K</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of times the statistics are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for <code>cluster_fct</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of result
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>SNAC or SNAC+ test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>row label vector.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><a href="https://arxiv.org/abs/2012.15047">Adjusted chi-square test for degree-corrected block models</a>,
Linfan Zhang, Arash A. Amini, arXiv preprint arXiv:2012.15047, 2020.
</p>


<h3>See Also</h3>

<p>nac_test
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- sample_dcpp(500, 10, 4, 0.1)$adj
snac_test(A, K = 4, niter = 3)$stat
</code></pre>


</div>