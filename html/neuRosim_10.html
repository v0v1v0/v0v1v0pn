<div class="container">

<table style="width: 100%;"><tr>
<td>Sim.3D.GRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a GRF (adopted from <span class="pkg">AnalyzeFMRI</span>)</h2>

<h3>Description</h3>

<p>Simulates a Gaussian Random Field with specified dimensions and covariance structure.</p>


<h3>Usage</h3>

<pre><code class="language-R">Sim.3D.GRF(d, voxdim, sigma, ksize, mask=NULL, type=c("field","max"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>A vector specifying the dimensions of a 3D or 4D array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>voxdim</code></td>
<td>
<p>The dimensions of each voxel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The 3D covariance matrix of the field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ksize</code></td>
<td>
<p>The size (in voxels) of the kernel with which to filter the independent field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>A 3D mask for the field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If <code>type=="field"</code> then the simulated field together with the maximum of the field is returned.If <code>type=="max"</code> then the maximum of the field is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function works by simulating a Gaussian r.v at each voxel location and the smoothing the field with a discrete filter to obtain a field with the desired covariance structure.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>Contains the simulated field if <code>type=="field"</code>, else <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>The maximum value of the simulated field</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J. L. Marchini</p>


<h3>See Also</h3>

<p><code>GaussSmoothKernel</code></p>


<h3>Examples</h3>

<pre><code class="language-R">     d &lt;- c(64, 64, 21)
     FWHM &lt;- 9
     sigma &lt;- diag(FWHM^2, 3) / (8 * log(2))
     voxdim &lt;- c(2, 2, 4)
     msk &lt;- array(1, dim = d)   
     field &lt;- Sim.3D.GRF(d = d, voxdim = voxdim, sigma = sigma, 
		ksize = 9, mask = msk, type = "max")

</code></pre>


</div>