<div class="container">

<table style="width: 100%;"><tr>
<td>simVOLfmri</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate 3D or 4D fMRI data</h2>

<h3>Description</h3>

<p>Simulates a 3D or 4D fMRI dataset for the specified design and with activation in the specified regions.</p>


<h3>Usage</h3>

<pre><code class="language-R">simVOLfmri(design = list(), image = list(), base=0, dim, nscan = NULL,
	TR = NULL, SNR=NULL, noise = c("none", "white", "temporal", 
	"spatial", "low-frequency", "physiological", "task-related", 
	"mixture"), type = c("gaussian", "rician"), 
	spat = c("corr", "gaussRF", "gammaRF"), weights, verbose = TRUE, 
	rho.temp = 0.2, rho.spat = 0.75, freq.low = 128, 
	freq.heart = 1.17, freq.resp = 0.2, FWHM = 4, gamma.shape = 6, 
	gamma.rate = 1, vee=1, template)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>List generated by <code>simprepTemporal</code> specifying the design. If not specified, noise images are generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>image</code></td>
<td>
<p>List generated by <code>simprepSpatial</code> specifying the activated regions. If not specified, noise images are generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>Baseline of the data. Should be a single number or an array with the same dimensions as in <code>dim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>Dimensions of the image space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nscan</code></td>
<td>
<p>Number of scans for noise images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TR</code></td>
<td>
<p>Repetition time for noise images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNR</code></td>
<td>
<p>Signal-to-noise ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>Type of noise, default is white.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If <code>noise==white</code> or <code>noise==mixture</code>, the type of system noise (default is gaussian).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spat</code></td>
<td>
<p>If <code>noise==spatial</code> or <code>noise==mixture</code>, the spatial correlation structure (default is <code>corr</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>If <code>noise==mixture</code>, weights vector of six elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating if warning should be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.temp</code></td>
<td>
<p>If <code>noise==temporal</code> or <code>noise==mixture</code>, value of autocorrelation coefficients. The length of the vector indicates the order of the autoregressive model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.spat</code></td>
<td>
<p>If <code>noise==spatial</code> or <code>noise==mixture</code>, and <code>spat==corr</code>, value of the correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.low</code></td>
<td>
<p>If <code>noise==low-frequency</code> or <code>noise==mixture</code>, frequency of the low-frequency drift in seconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.heart</code></td>
<td>
<p>If <code>noise==physiological</code> or <code>noise==mixture</code>, frequency of heart rate in Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.resp</code></td>
<td>
<p>If <code>noise==physiological</code> or <code>noise==mixture</code>, frequency of respiratory rate in Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FWHM</code></td>
<td>
<p>If <code>noise==spatial</code> or <code>noise==mixture</code>, and <code>spat==gaussRF</code> or <code>spat==gammaRF</code>, value of the FWHM of the Gaussian kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.shape</code></td>
<td>
<p>If <code>noise==spatial</code> or <code>noise==mixture</code>, and <code>spat==gammaRF</code>, value of the shape parameter of the gamma distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.rate</code></td>
<td>
<p>If <code>noise==spatial</code> or <code>noise==mixture</code>, and <code>spat==gammaRF</code>, value of the rate parameter of the gamma distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vee</code></td>
<td>
<p>If <code>type==rician</code>, non-centrality parameter of the rician distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>An array representing the anatomical structure or mask with dimensions equal to dim.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A 3D or 4D array specifying the values for each voxel in the data.</p>


<h3>Author(s)</h3>

<p>M. Welvaert</p>


<h3>See Also</h3>

<p><code>simTSfmri</code>, <code>simprepTemporal</code>, <code>simprepSpatial</code></p>


<h3>Examples</h3>

<pre><code class="language-R">design &lt;- simprepTemporal(totaltime=200, onsets=seq(1,200,40), 
	durations=20, TR=2, effectsize=1, hrf="double-gamma")
region &lt;- simprepSpatial(regions=2, coord=list(c(32,15),c(57,45)), 
	radius=c(10,7), form="sphere", fading=TRUE)
out &lt;- simVOLfmri(design=design, image=region, dim=c(64,64), 
	SNR=1, noise="none")
plot(out[32,15,], type="l")
image(1:64, 1:64, out[,,10], col = grey(0:255/255))

</code></pre>


</div>