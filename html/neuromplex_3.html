<div class="container">

<table style="width: 100%;"><tr>
<td>dapp.simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate from Dynamic Admixture of Poisson Process</h2>

<h3>Description</h3>

<p>Simulate spike trains from DAPP model to binned spiking data</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
dapp.simulate(horizon = 1000, bin.width = 25, lengthScale,
     lsPrior = rep(1/length(lengthScale),length(lengthScale)),
     hyper = list(prec = c(1,1), sig0 = 1.87, w=c(1,1)), nsamp = 1e3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>horizon</code></td>
<td>
<p>time horizon of the response period (in ms)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.width</code></td>
<td>
<p>width of the time bins (in ms) to be used to aggregate spike counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengthScale</code></td>
<td>
<p>an array giving the length scale parameter values to be used for Gaussian process prior. Defaults to <code>sort(0.16 * resp.horiz / c(4, 3, 2, 1, 0.5, 0.1))</code> where <code>resp.horiz</code> is the time horizon of the response period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lsPrior</code></td>
<td>
<p>an array of the same length as <code>lengthScale</code> giving the prior probabilities of the length scale values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>a list of hyper parameters with the following iterms. 'prec': a 2-vector giving the shape and rate parameters of the gamma distribution on the Dirichlet precision parameter. 'sig0': a scalaer giving the scale of the (centered) logistic distribution used in transforming the Gaussian random curves into curves restricted between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>number of priors draws to be made</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Primarily intended to be used internally by the <code>summary.dapp</code> and <code>plot.dapp</code> functions. Could also be use to draw directly from the model.</p>


<h3>Value</h3>

<p>Returns a list of class "dapp" containting the following items.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lsProb</code></td>
<td>
<p>draws of length scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.pred</code></td>
<td>
<p>prior predictive draws of alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>
<p>draws of precision</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">prior &lt;- dapp.simulate(1000, 25)
</code></pre>


</div>