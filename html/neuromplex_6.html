<div class="container">

<table style="width: 100%;"><tr>
<td>poisson.tests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson Tests for Whole Trial Spike Counts</h2>

<h3>Description</h3>

<p>Carries out various Poisson related tests for double-stimuli spike count distribution.</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
poisson.tests(xA, xB, xAB, labels = c("A", "B", "AB"), remove.zeros = FALSE,
              gamma.pars = c(0.5, 2e-10), beta.pars = c(0.5, 0.5),
              nMC = 1000, plot = FALSE, add.poisson.fits = FALSE, 
              method.screen = c('variance', 'bincount'), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xA</code></td>
<td>
<p>an array of whole-trial spike counts under stimulus 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xB</code></td>
<td>
<p>an array of whole-trial spike counts under stimulus 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xAB</code></td>
<td>
<p>an array of whole-trial spike counts when both stimuli are present together</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>labels for stimlus conditions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.zeros</code></td>
<td>
<p>whether to remove trials with zero spike counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma.pars</code></td>
<td>
<p>shape and rate parameters of the gamma prior on Poisson mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.pars</code></td>
<td>
<p>shape parameters of the beta prior for the mixture/intermediate parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMC</code></td>
<td>
<p>number of Monte Carlo samples to be used in numerical approximations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical indicating if a visualization plot should be made</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.poisson.fits</code></td>
<td>
<p>logical indicating if a fitted Poisson pmfs will be overlaid in the visualization. Ignored when plot=FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.screen</code></td>
<td>
<p>a character string, default is 'variance' which uses the Poisson variance test to assess whether a Poisson distribution fits a sample of counts. Alternative choice is 'bincount' which uses an binned histogram based nonparametric chi-square goodness of fit test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional commands to be passed on to grid.arrange() for plotting. For example, adding 'top="PLOT TITLE"' will add a title at the top of the combined plot. See <code>grid.arrange</code> for more details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>separation.logBF</code></td>
<td>
<p>the (log) Bayes factor for testing that that two single stimulus distributions are different</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.prob</code></td>
<td>
<p>posterior probabilities of the four hypotheses (Mixture, Intermediate, Outside, Single) under equal prior probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pois.pvalue</code></td>
<td>
<p>minimum of the two p-values checking for Poisson-ness of each single stimulus distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.sizes</code></td>
<td>
<p>three trial counts for A, B and AB conditions</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">nA &lt;- 20; nB &lt;- 15; nAB &lt;- 25
muA &lt;- 25; muB &lt;- 40
Acounts &lt;- rpois(nA, muA)
Bcounts &lt;- rpois(nB, muB)
ABcounts &lt;- rpois(nAB, sample(c(muA, muB), nAB, replace = TRUE))
poisson.tests(Acounts, Bcounts, ABcounts, nMC=200, plot=FALSE)
</code></pre>


</div>