<div class="container">

<table style="width: 100%;"><tr>
<td>WC.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Survival function estimator for recurrence time data using the estimator developed by Wang and Chang</h2>

<h3>Description</h3>

<p>Estimation of survival function for correlated by the product limit estimator PLE method developed by Wang and Chang.</p>


<h3>Usage</h3>

<pre><code class="language-R">WC.fit(x, tvals)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a survival recurrent event object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvals</code></td>
<td>
<p>vector of times where the survival function can be estimated.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Wang-Chang (1999) proposed an estimator of the common marginal survivor function in the case where within-unit inter-occurrence times are correlated. The correlation structure considered by Wang and Chang (1999) is quite general and contains, in particular, both the i.i.d. and multiplicative (hence gamma) frailty model as special cases. This estimator removes the bias noted for the product-limit estimator developed by Pena, Strawderman and Hollander (PSH, 2001) when inter-occurrence times are correlated within units. However, when applied to i.i.d. inter-occurrence times, this estimator is not expected to perform as well as the PSH estimator, especially with regard to efficiency.</p>


<h3>Value</h3>

<p>Value returned
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of unit or subjects observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector of number of recurrences in each subject (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failed</code></td>
<td>
<p>vector of number of recurrences in each subject (length n*m). Vector ordered (e.g. times of first unit, times of second unit, ..., times of n-unit)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censored</code></td>
<td>
<p>vector of times of censorship for each subject (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numdistinct</code></td>
<td>
<p>number of distinct failures times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distinct</code></td>
<td>
<p>vector of distinct failures times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AtRisk</code></td>
<td>
<p>matrix of number of persons-at-risk at each distinct time and for each subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survfunc</code></td>
<td>
<p>vector of survival estimated in distinct times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tvals</code></td>
<td>
<p>copy of argument.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function was originally performed by the survrec package, which solved the adjustment problem of the WC estimator using Fortran routines. With the permission of its author, the algorithm was taken, modified, the algorithm, WC estimator was reprogrammed and adapted to the needs of the newTestSurvRec package and thus avoid dependence.</p>


<h3>Author(s)</h3>

<p>Dr. <b>Carlos M. Martinez M.</b>, &lt;cmmm7031@gmail.com&gt;</p>


<h3>References</h3>

<p><b>Wang, M. C. and Chang, S.H.</b> (<b>1999</b>). Nonparametric Estimation of a Recurrent Survival Function. <em>J. Amer. Statist. Assoc.</em> 94, 146-153.// <b>Pena E., Strawderman R., Hollander M.</b> (<b>2001</b>). Nonparametric Estimation with Recurrent
Event Data. <em>J.A.S.A.</em> 96, 1299-1315.</p>


<h3>See Also</h3>

<p>PSH.fit, Plot.Event.Rec, Plot.Surv.Rec, Print.Summary</p>


<h3>Examples</h3>

<pre><code class="language-R">XL&lt;-data(MMC.TestSurvRec)
#-------------------------------------------------------------------------------------
fitPSHa&lt;-PSH.fit(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                        MMC.TestSurvRec$event))
fitPSHa$surv
fitPSHa$time
plot(fitPSHa$time,fitPSHa$survfunc,type="s" ,ylim=c(0,1),
        xlim=c(0,max(fitPSHa$time)))
title(main = list("Survival Curve with Recurrent Event Data", 
        cex = 0.8, font = 2.3, col = "dark blue"))
mtext("Research Group: AVANCE USE R!", cex = 0.7, font = 2, 
        col = "dark blue", line = 1)
mtext("Software made by: Dr. Carlos Martinez", cex = 0.6, font = 2, 
        col = "dark red", line = 0)


fitWCa&lt;-WC.fit(Survrecu(MMC.TestSurvRec$id,MMC.TestSurvRec$time,
                        MMC.TestSurvRec$event))
fitWCa$surv
fitWCa$time
plot(fitWCa$time,fitWCa$survfunc,type="s" ,ylim=c(0,1),
        xlim=c(0,max(fitWCa$time)))

</code></pre>


</div>