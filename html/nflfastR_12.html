<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_win_probability</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute win probability</h2>

<h3>Description</h3>

<p>for provided plays. Returns the data with
probabilities of winning the game. The following columns
must be present: receive_h2_ko (1 if game is in 1st half and possession
team will receive 2nd half kickoff, 0 otherwise),
home_team, posteam, half_seconds_remaining, game_seconds_remaining,
spread_line (how many points home team was favored by), down, ydstogo,
yardline_100, posteam_timeouts_remaining, defteam_timeouts_remaining
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_win_probability(pbp_data)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>pbp_data</code></td>
<td>
<p>Play-by-play dataset to estimate win probability for.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Computes win probability for provided plays. Returns the data with
spread and non-spread-adjusted win probabilities. The following columns
must be present:
</p>

<ul>
<li>
<p>receive_2h_ko (1 if game is in 1st half and possession team will receive 2nd half kickoff, 0 otherwise)
</p>
</li>
<li>
<p>score_differential
</p>
</li>
<li>
<p>home_team
</p>
</li>
<li>
<p>posteam
</p>
</li>
<li>
<p>half_seconds_remaining
</p>
</li>
<li>
<p>game_seconds_remaining
</p>
</li>
<li>
<p>spread_line (how many points home team was favored by)
</p>
</li>
<li>
<p>down
</p>
</li>
<li>
<p>ydstogo
</p>
</li>
<li>
<p>yardline_100
</p>
</li>
<li>
<p>posteam_timeouts_remaining
</p>
</li>
<li>
<p>defteam_timeouts_remaining
</p>
</li>
</ul>
<h3>Value</h3>

<p>The original pbp_data with the following columns appended to it:
</p>

<dl>
<dt>wp</dt>
<dd>
<p>win probability.</p>
</dd>
<dt>vegas_wp</dt>
<dd>
<p>win probability taking into account pre-game spread.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
try({# to avoid CRAN test problems
library(dplyr)
data &lt;- tibble::tibble(
"receive_2h_ko" = 0,
"home_team" = "SEA",
"posteam" = "SEA",
"score_differential" = 0,
"half_seconds_remaining" = 1800,
"game_seconds_remaining" = 3600,
"spread_line" = c(1, 3, 4, 7, 14),
"down" = 1,
"ydstogo" = 10,
"yardline_100" = 75,
"posteam_timeouts_remaining" = 3,
"defteam_timeouts_remaining" = 3
)

nflfastR::calculate_win_probability(data) %&gt;%
  dplyr::select(spread_line, wp, vegas_wp)
})

</code></pre>


</div>