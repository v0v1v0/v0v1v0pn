<div class="container">

<table style="width: 100%;"><tr>
<td>qmatrix.nhm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute transition intensities from a fitted nhm model
</h2>

<h3>Description</h3>

<p>Outputs the transition intensities from a non-homogeneous Markov or misclassification type hidden Markov multi-state model fitted using <code>nhm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qmatrix.nhm(object, time0=0, times=NULL, covvalue=NULL, ci=TRUE, sim=FALSE,
coverage=0.95, B=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Fitted model object produced using <code>nhm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time0</code></td>
<td>

<p>Starting time from which to compute the transition intensities. Defaults to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>Optional vector of times at which to compute the transition intensities. If omitted, the intensities will be computed at a sequence of times from <code>time0</code> to the maximum observed time in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covvalue</code></td>
<td>

<p>Optional vector of covariate vectors (should be given in the order specified in the <code>covariate</code> option in <code>nhm</code>). If omitted the function will use the mean values of the covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>If <code>TRUE</code> pointwise confidence intervals will be shown in addition to the point estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>

<p>If <code>TRUE</code> a simulation Delta method (Mandel, 2013) will be used to calculate the confidence intervals. Otherwise the standard Delta method will be applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>Coverage level (should be a value between 0 and 1) for the confidence intervals. Defaults to 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Number of simulations to be performed to compute the simulation Delta method.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>intens</code> function used to fit the model is called to obtain the values of the transition intensities at the supplied times for the supplied covariate value.
</p>
<p>If the simulation delta method approach is specified then the function will generate <code>B</code> parameter vectors from the asymptotic distribution of the MLE and compute the intensities for each of them, before finding pointwise percentile bootstrap confidence intervals from them.</p>


<h3>Value</h3>

<p>Returns a list containing the vector of times at which the intensities are computed, a matrix of probabilities for each state at each of the times. If confidence intervals are requested then the lower and upper limits are also provided.
</p>
<p>If transition probability (as opposed to intensity) estimates are required then <code>predict.nhm</code> should be used.
</p>


<h3>Author(s)</h3>

<p>Andrew Titman <a href="mailto:a.titman@lancaster.ac.uk">a.titman@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Mandel M. Simulation-based confidence intervals for functions with complicated derivatives. 2013. <em>The American Statistician</em>, 67. 76-81.</p>


<h3>See Also</h3>

<p><code>nhm</code>, <code>plot.nhm</code>, <code>predict.nhm</code>
</p>


</div>