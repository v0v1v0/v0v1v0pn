<div class="container">

<table style="width: 100%;"><tr>
<td>plot.nhm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot transition probabilities or intensities from a fitted nhm model.
</h2>

<h3>Description</h3>

<p>Produces plots of the transition probabilites or intensities from a non-homogeneous Markov or misclassification type hidden Markov multi-state model fitted using <code>nhm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'nhm'
plot(x, what="probabilities",time0=0, state0=1, times=NULL,
covvalue=NULL, ci=TRUE, sim=FALSE, coverage=0.95, B=1000, rtol=1e-6,
atol=1e-6, main_arg=NULL, xlab="Time", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Fitted model object produced using <code>nhm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>

<p>Character string to indicate what should be plotted. Options are <code>probabilities</code> (the default which produces transition probabilities) or <code>intensities</code> (to produce a plot of the intensities)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time0</code></td>
<td>

<p>Starting time from which to compute the transition probabilities or intensities. Defaults to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state0</code></td>
<td>

<p>Starting state from which to compute the transition probabilities. Defaults to 1. Not required for transition intensities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>Optional vector of times at which to compute the transition probabilities or intensities. If omitted, the probabilities/intensities will be computed at a sequence of times of length 100 from <code>time0</code> to the maximum observed time in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covvalue</code></td>
<td>

<p>Optional vector of covariate vectors (should be given in the order specified in the <code>covariate</code> option in <code>nhm</code>). 
If omitted the function will use the mean values of the covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>If <code>TRUE</code> pointwise confidence intervals will be shown in addition to the point estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>

<p>If <code>TRUE</code> a simulation Delta method (Mandel, 2013) will be used to calculate the confidence intervals. Otherwise the standard Delta method will be applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>Coverage level (should be a value between 0 and 1) for the confidence intervals. Defaults to 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Number of simulations to be performed to compute the simulation Delta method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtol</code></td>
<td>

<p>Relative tolerance parameter to be used by <code>lsoda</code> when solving the differential equations for the transition probabilites.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atol</code></td>
<td>

<p>Absolute tolerance parameter to be used by <code>lsoda</code> when solving the differential equations for the transition probabilites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_arg</code></td>
<td>

<p>Character string specifying beginning of title to be given to each of the plot panes generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Character string specifying x-axis label to be given to each plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other items to be passed to the function. Currently not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computation is performed by calling <code>predict.nhm</code>, for the transition probabilities, or <code>qmatrix.nhm</code> for the intensities (see for more details).
</p>


<h3>Value</h3>

<p>Generates a multi-pane plot for each state. If values are required they can be obtained using <code>predict.nhm</code>.
</p>


<h3>Author(s)</h3>

<p>Andrew Titman <a href="mailto:a.titman@lancaster.ac.uk">a.titman@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Mandel M. Simulation-based confidence intervals for functions with complicated derivatives. 2013. <em>The American Statistician</em>, 67. 76-81.
</p>


<h3>See Also</h3>

<p><code>nhm</code>, <code>predict.nhm</code>, <code>qmatrix.nhm</code>
</p>


</div>