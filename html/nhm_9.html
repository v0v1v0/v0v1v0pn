<div class="container">

<table style="width: 100%;"><tr>
<td>predict.nhm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute state occupation or transition probabilities from a fitted nhm model
</h2>

<h3>Description</h3>

<p>Outputs the transition probabilites from a non-homogeneous Markov or misclassification type hidden Markov multi-state model fitted using <code>nhm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'nhm'
predict(object, time0=0, state0=1, times=NULL, covvalue=NULL,
ci=TRUE, sim=FALSE, coverage=0.95, B=1000, rtol=1e-6,
atol=1e-6, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>Fitted model object produced using <code>nhm</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time0</code></td>
<td>

<p>Starting time from which to compute the transition probabilities. Defaults to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state0</code></td>
<td>

<p>Starting state from which to compute the transition probabilities. Defaults to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>Optional vector of times at which to compute the transition probabilities. If omitted, the probabilities will be computed at a sequence of times from <code>time0</code> to the maximum observed time in the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covvalue</code></td>
<td>

<p>Optional vector of covariate vectors (should be given in the order specified in the <code>covariate</code> option in <code>nhm</code>). If omitted the function will use the mean values of the covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>If <code>TRUE</code> pointwise confidence intervals will be shown in addition to the point estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>

<p>If <code>TRUE</code> a simulation Delta method (Mandel, 2013) will be used to calculate the confidence intervals. Otherwise the standard Delta method will be applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>

<p>Coverage level (should be a value between 0 and 1) for the confidence intervals. Defaults to 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Number of simulations to be performed to compute the simulation Delta method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtol</code></td>
<td>

<p>Relative tolerance parameter to be used by <code>lsoda</code> when solving the differential equations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atol</code></td>
<td>

<p>Absolute tolerance parameter to be used by <code>lsoda</code> when solving the differential equations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other items to be passed to the function. Currently not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The same approach as in the main <code>nhm</code> function of numerically solving the system of differential equations is used to compute transition probabilities based on the maximum likelihood estimates found in <code>nhm</code> and assuming a specific vector of covariates.
</p>
<p>If the simulation delta method approach is specified then the function will generate <code>B</code> parameter vectors from the asymptotic distribution of the MLE and solve the system of equations for each of them, before finding pointwise percentile bootstrap confidence intervals from them.</p>


<h3>Value</h3>

<p>Returns a list containing the vector of times at which the probabilities are computed, a matrix of probabilities for each state at each of the times. If confidence intervals are requested then the lower and upper limits are also provided.
</p>
<p>If transition intensity (as opposed to probability) estimates are required then <code>qmatrix.nhm</code> should be used.
</p>


<h3>Author(s)</h3>

<p>Andrew Titman <a href="mailto:a.titman@lancaster.ac.uk">a.titman@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Mandel M. Simulation-based confidence intervals for functions with complicated derivatives. 2013. <em>The American Statistician</em>, 67. 76-81.</p>


<h3>See Also</h3>

<p><code>nhm</code>, <code>plot.nhm</code>, <code>qmatrix.nhm</code>
</p>


</div>