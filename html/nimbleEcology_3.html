<div class="container">

<table style="width: 100%;"><tr>
<td>dBetaBinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A beta binomial distribution and beta function for use in <code>nimble</code> models</h2>

<h3>Description</h3>

<p><code>dBetaBinom_v</code> and <code>dBetaBinom_s</code> provide a beta binomial
distribution that can be used directly from R or in <code>nimble</code>
models. These are also used by beta binomial variations of dNmixture distributions.
<code>nimBetaFun</code> is the beta function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nimBetaFun(a, b, log)

dBetaBinom_v(x, N, shape1, shape2, len, log = 0)

dBetaBinom_s(x, N, shape1, shape2, len, log = 0)

rBetaBinom_v(n, N, shape1, shape2, len)

rBetaBinom_s(n, N, shape1, shape2, len)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>shape1 argument of the beta function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>shape2 argument of the beta function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return
probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of integer counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of trials, sometimes called "size".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>
<p>shape1 parameter of the beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>
<p>shape2 parameter of the beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>
<p>length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random draws, each returning a vector of length
<code>len</code>. Currently only <code>n = 1</code> is supported, but the argument
exists for standardization of "<code>r</code>" functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These nimbleFunctions provide distributions that can be used
directly in R or in <code>nimble</code> hierarchical models (via
<code>nimbleCode</code> and <code>nimbleModel</code>).
They are used by the beta-binomial variants of the N-mixture distributions
(<code>dNmixture</code>).
</p>
<p>The beta binomial is the marginal distribution of a  binomial distribution whose
probability follows a  beta distribution.
</p>
<p>The probability mass function of the beta binomial is
<code>choose(N, x) * B(x + shape1, N - x + shape2) /
B(shape1, shape2)</code>, where <code>B(shape1, shape2)</code> is the beta function.
</p>
<p><code>nimBetaFun(shape1, shape2)</code> calculates <code>B(shape1, shape2)</code>.
</p>
<p>The beta binomial distribution is provided in two forms. <code>dBetaBinom_v</code> and
is when <code>shape1</code> and <code>shape2</code> are vectors.
<code>dBetaBinom_s</code> is used when <code>shape1</code> and <code>shape2</code> are scalars.
In both cases, <code>x</code> is a vector.
</p>


<h3>Author(s)</h3>

<p>Ben Goldstein and Perry de Valpine
</p>


<h3>See Also</h3>

<p>For beta binomial N-mixture models, see <code>dNmixture</code>.
For documentation on the beta function, use <code>?stats::dbeta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calculate a beta binomial probability with different shape1 and shape2 for each x[i]
dBetaBinom_v(x = c(4, 0, 0, 3), N = 10,
  shape1 = c(0.5, 0.5, 0.3, 0.5), shape2 = c(0.2, 0.4, 1, 1.2))
# or with constant shape1 and shape2
dBetaBinom_s(x = c(4, 0, 0, 3), N = 10, shape1 = 0.5, shape2 = 0.5, log = TRUE)
</code></pre>


</div>