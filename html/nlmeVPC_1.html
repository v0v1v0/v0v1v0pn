<div class="container">

<table style="width: 100%;"><tr>
<td>aqrVPC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The visual predictive checks using the additive quantile regression (aqrVPC)</h2>

<h3>Description</h3>

<p>This function draws the visual predictive check (VPC) plot 
using additive quantile regression. The quantile 
regression methods are used to calculate quantiles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aqrVPC(orig_data, 
       sim_data, 
       probs = c(0.1,0.5,0.9),
       conf.level = 0.95, 
       X_name = "TIME", 
       Y_name = "DV",
       MissingDV = NULL, 
       plot_caption = TRUE,
       DV_point = TRUE,
       plot_flag = TRUE,
       linesize = 0.7, 
       pointsize = 0.7, 
       captionsize = 10,
       qss_lambda = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually "TIME" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually "DV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually "MDV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>captionsize</code></td>
<td>
<p>Size of caption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qss_lambda</code></td>
<td>
<p>Smoothing parameter in quantreg::qss function. 
Larger lambda produces a smoother fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>aqrVPC plot or the values to draw aqrVPC plot.
</p>


<h3>References</h3>

<p>Koenker, Roger, and Kevin F. Hallock. "Quantile regression." 
Journal of economic perspectives 15.4 (2001): 143-156.
</p>
<p>Jamsen, K. M., Patel, K., Nieforth, K., &amp; Kirkpatrick, C. M. 
(2018). A regression approach to visual predictive checks for
population pharmacometric models. CPT: pharmacometrics &amp; 
systems pharmacology, 7(10), 678-686.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
data(origdata)
data(simdata)
aqrVPC(origdata,simdata)

</code></pre>


</div>