<div class="container">

<table style="width: 100%;"><tr>
<td>VPCgraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The original visual predictive check plot (VPC)</h2>

<h3>Description</h3>

<p>This function draws the original visual predictive check plot 
proposed by Holford &amp; Karlsson (2008). The visual predictive check plot is 
a graphical comparison of the distribution of observations and simulated data
from the fitted model. 
In the "scatter" type of the VPC plot, dots indicate the observed data. 
Two dashed blue lines and one solid line represent profiles of percentiles 
of the simulated data. If the fitted model represents the observed data well,
most observed data are between two dashed blue lines. In the "percentile" 
type of the VPC plot,  profiles of percentiles from the observed data are 
compared to profiles of percentiles from the simulated data. Red lines
represent profiles from the observed data, and blue lines represent 
profiles from the simulated data. If the fitted model represents the 
observed data well, two profiles in each percentile - one from the original
data and the other from the simulated data - are similar. In the "CI" 
type of the VPC plot, sky blue and pink areas represent the confidence 
areas of the profile in each percentile. These confidence areas were 
calculated from the simulated data. In this plot, it is necessary to
verify that the profiles of the original data are in confidence areas 
of each profile from the simulated data in each percentile. If each 
percentile line of the observed data is in the corresponding confidence
area, this can be evidence that the fitted model represents the observed 
data quite well. Otherwise, the fitted model needs to be improved.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VPCgraph(orig_data,
         sim_data,
         type = "CI",                   
         N_xbin = NULL,
         probs = c(0.1,0.5,0.9),
         conf.level = 0.95,
         X_name = "TIME",
         Y_name = "DV",
         MissingDV = NULL,
         DV_point = TRUE,
         CIvpc_type = "line",
         bin_grid = TRUE,
         plot_caption = TRUE,
         plot_flag = TRUE,
         linesize = 0.7,
         pointsize = 0.7,
         captionsize = 10,
         Kmethod = "cluster",                   
         maxK = NULL,
         beta = 0.2,
         lambda = 0.3,
         R = 4,
         C1 = 2.5,
         C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of VPC graph; "CI", "percentile", or "scatter".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually "TIME" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually "DV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually "MDV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIvpc_type</code></td>
<td>
<p>Type of CI area in VPC graph; "line" or "segment".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_grid</code></td>
<td>
<p>Draw grid lines for binning in X variable if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>captionsize</code></td>
<td>
<p>Size of caption .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning."cluster" or "kernel".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Visual predictive check plot or the values to draw VPC plot.
</p>


<h3>References</h3>

<p>Holford N, &amp; Karlsson M. (2008). "A tutorial on visual predictive checks,
abstr 1434." Annual Meeting of the Populations Approach Group in Europe. www.page-meeting.org. 2008.
</p>
<p>Harling, Uekcert, K. 2018. VPC and NPC User Guide. ICON plc.
</p>
<p>https://github.com/UUPharmacometrics/PsN/releases/download/4.9.0/vpc_npc_userguide.pdf.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(origdata)
data(simdata)
VPCgraph(origdata,simdata,type="CI",X_name="TIME",Y_name="DV",N_xbin=8)

</code></pre>


</div>