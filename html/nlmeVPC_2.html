<div class="container">

<table style="width: 100%;"><tr>
<td>asVPC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The average shifted visual predictive checks (asVPC)</h2>

<h3>Description</h3>

<p>This function draws the average shifted visual predictive check
(asVPC) plot. It calculates original and simulated data percentiles using 
the average shifted histogram method. After calculating percentiles with 
bin-related or distance-related weights, draw the VPC type plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">asVPC(orig_data,
      sim_data,
      type = "CI",                
      weight_method = "bin",                  
      N_xbin = NULL,
      N_hist = NULL,
      probs = c(0.1,0.5,0.9),
      conf.level = 0.95,
      X_name = "TIME",
      Y_name = "DV",
      MissingDV = NULL,
      DV_point = TRUE,                
      CIvpc_type = "line",
      bin_grid = TRUE,                   
      plot_caption = TRUE,
      plot_flag = TRUE,
      linesize = 0.7,
      pointsize = 0.7,
      captionsize = 10,
      Kmethod = "cluster",                
      maxK = NULL,
      beta = 0.2,
      lambda = 0.3,
      R = 4,
      C1 = 2.5,
      C2 = 7.8,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of VPC graph; "CI", "percentile", or "scatter".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_method</code></td>
<td>
<p>The way to put weight when the average shifted values are calculated. "bin" or "distance".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_hist</code></td>
<td>
<p>The number of shifted histograms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually "TIME" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually "DV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually "MDV" in pharmacokinetic data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIvpc_type</code></td>
<td>
<p>Type of CI area in VPC graph; "line" or "segment".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_grid</code></td>
<td>
<p>Draw grid lines for binning in X variable if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>captionsize</code></td>
<td>
<p>Size of caption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning."cluster" or "kernel".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>asVPC plot or the values to draw asVPC plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(origdata)
data(simdata)
asVPC(origdata,simdata,type="CI",N_hist=3,weight_method="distance",N_xbin=8)
asVPC(origdata,simdata,type="CI",N_hist=3,weight_method="bin",N_xbin=8)


</code></pre>


</div>