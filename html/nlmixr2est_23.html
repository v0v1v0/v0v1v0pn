<div class="container">

<table style="width: 100%;"><tr>
<td>.nlmSetupEnv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Setup a nonlinear system for optimization</h2>

<h3>Description</h3>

<p>Setup a nonlinear system for optimization
</p>


<h3>Usage</h3>

<pre><code class="language-R">.nlmSetupEnv(par, ui, data, modelInfo, control, lower = NULL, upper = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>A named vector of initial estimates to setup the
nonlinear model solving environment. The names of the parameter
should match the names of the model to run (not 'THETA[#]' as
required in the 'modelInfo' argument)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ui</code></td>
<td>
<p>rxode2 ui model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>rxode2 compatible data for solving/setting up</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelInfo</code></td>
<td>
<p>A list containing the following elements:
</p>
<p>- 'predOnly' – A model with only predictions calculated.  These
predictions should be in terms of 'THETA[#]' and 'DV'.  The
</p>
<p>- 'eventTheta' is an indicator if the 'THETA[#]' is related to an
event (like 'dur(x)' 'f(x)').  These variables will use Shi2021
finite differences and need to be indicated when setting up the
solving environment.  When finite differences are required, this is
'1L' when they are not it should be '0L'.  This should match the
length of 'par'
</p>
<p>- 'thetaGrad' – needed when solveType != 1; a model that gives the
value and gradient of each 'THETA[#]'
</p>
<p>An example can be found with 'ui$nlmSensModel' or 'ui$nlmRxModel'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>is a control structure with a few required elements:
</p>
<p>- 'rxControl' represents the rxode2 solving options
- 'solveType' integer indicating the solveType (optional)
- 'stickyRecalcN'
- 'maxOdeRecalc'
- 'odeRecalcFactor'
- 'eventType' (optional)
- 'shi21maxFD' (optional)
- 'shiErr' (optional)
- 'optimHessType' (optional)
- 'shi21maxHess' (optional)
- 'hessErr' (optional)
- 'useColor'
- 'printNcol'
- 'print'
- 'normType'
- 'scaleType'
- 'scaleCmin'
- 'scaleCmax'
- 'scaleTo'
- 'scaleC'
- 'gradTo' (optional); if missing assumed gradTo=0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>lower bounds, will be scaled if present</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper bounds, will be scaled if present</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In between using this, rxode2 solving should not be called.
</p>
<p>This will also print the header for solving (if print != 0)
</p>


<h3>Value</h3>

<p>nlm solve environment; of interest
</p>
<p>'$par.ini' – scaled parameter initial value
</p>
<p>'$lower' – scaled parameter lower value
</p>
<p>'$upper' – scaled parameter upper value
</p>
<p>'$.ctl'  – control structure
</p>


<h3>Author(s)</h3>

<p>Matthew Fidler
</p>


</div>