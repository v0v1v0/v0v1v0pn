<div class="container">

<table style="width: 100%;"><tr>
<td>vpcPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>VPC based on ui model</h2>

<h3>Description</h3>

<p>VPC based on ui model
</p>


<h3>Usage</h3>

<pre><code class="language-R">vpcPlot(
  fit,
  data = NULL,
  n = 300,
  bins = "jenks",
  n_bins = "auto",
  bin_mid = "mean",
  show = NULL,
  stratify = NULL,
  pred_corr = FALSE,
  pred_corr_lower_bnd = 0,
  pi = c(0.05, 0.95),
  ci = c(0.05, 0.95),
  uloq = fit$dataUloq,
  lloq = fit$dataLloq,
  log_y = FALSE,
  log_y_min = 0.001,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  smooth = TRUE,
  vpc_theme = NULL,
  facet = "wrap",
  scales = "fixed",
  labeller = NULL,
  vpcdb = FALSE,
  verbose = FALSE,
  ...,
  seed = 1009,
  idv = "time",
  cens = FALSE
)

vpcPlotTad(..., idv = "tad")

vpcCensTad(..., cens = TRUE, idv = "tad")

vpcCens(..., cens = TRUE, idv = "time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>nlmixr2 fit object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>this is the data to use to augment the VPC fit.  By
default is the fitted data, (can be retrieved by
<code>getData</code>), but it can be changed by specifying
this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of VPC simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>either "density", "time", or "data", "none", or one of the approaches available in classInterval() such as "jenks" (default) or "pretty", or a numeric vector specifying the bin separators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_bins</code></td>
<td>
<p>when using the "auto" binning method, what number of bins to aim for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_mid</code></td>
<td>
<p>either "mean" for the mean of all timepoints (default) or "middle" to use the average of the bin boundaries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>what to show in VPC (obs_dv, obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratify</code></td>
<td>
<p>character vector of stratification variables. Only 1 or 2 stratification variables can be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_corr</code></td>
<td>
<p>perform prediction-correction?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_corr_lower_bnd</code></td>
<td>
<p>lower bound for the prediction-correction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>simulated prediction interval to plot. Default is c(0.05, 0.95),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uloq</code></td>
<td>
<p>Number or NULL indicating upper limit of quantification. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lloq</code></td>
<td>
<p>Number or NULL indicating lower limit of quantification. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_y</code></td>
<td>
<p>Boolean indicting whether y-axis should be shown as logarithmic. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_y_min</code></td>
<td>
<p>minimal value when using log_y argument. Default is 1e-3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>"smooth" the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet</code></td>
<td>
<p>either "wrap", "columns", or "rows"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>either "fixed" (default), "free_y", "free_x" or "free"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpcdb</code></td>
<td>
<p>Boolean whether to return the underlying vpcdb rather than the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>show debugging information (TRUE or FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Args sent to <code>rxSolve</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an object specifying if and how the random number
generator should be initialized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idv</code></td>
<td>
<p>Name of independent variable. For <code>vpcPlot()</code> and
<code>vpcCens()</code> the default is <code>"time"</code> for <code>vpcPlotTad()</code> and
<code>vpcCensTad()</code> this is <code>"tad"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>is a boolean to show if this is a censoring plot or
not.  When <code>cens=TRUE</code> this is actually a censoring vpc plot
(with <code>vpcCens()</code> and <code>vpcCensTad()</code>).  When <code>cens=FALSE</code> this is
traditional VPC plot (<code>vpcPlot()</code> and <code>vpcPlotTad()</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Simulated dataset (invisibly)
</p>


<h3>Author(s)</h3>

<p>Matthew L. Fidler
</p>


<h3>Examples</h3>

<pre><code class="language-R">
one.cmt &lt;- function() {
 ini({
   tka &lt;- 0.45; label("Ka")
   tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
   tv &lt;- 3.45; label("V")
   eta.ka ~ 0.6
   eta.cl ~ 0.3
   eta.v ~ 0.1
   add.sd &lt;- 0.7; label("Additive residual error")
 })
 model({
   ka &lt;- exp(tka + eta.ka)
   cl &lt;- exp(tcl + eta.cl)
   v &lt;- exp(tv + eta.v)
   linCmt() ~ add(add.sd)
 })
}

fit &lt;-
  nlmixr2est::nlmixr(
    one.cmt,
    data = nlmixr2data::theo_sd,
    est = "saem",
    control = list(print = 0)
  )

vpcPlot(fit)

</code></pre>


</div>