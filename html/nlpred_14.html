<div class="container">

<table style="width: 100%;"><tr>
<td>.make_long_data_nested_cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Worker function to make long form data set needed for
CVTMLE targeting step when nested cv is used</h2>

<h3>Description</h3>

<p>Worker function to make long form data set needed for
CVTMLE targeting step when nested cv is used
</p>


<h3>Usage</h3>

<pre><code class="language-R">.make_long_data_nested_cv(
  x,
  prediction_list,
  folds,
  gn,
  update = FALSE,
  epsilon_0 = 0,
  epsilon_1 = 0,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The outer validation fold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction_list</code></td>
<td>
<p>The full prediction list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>Vector of CV folds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gn</code></td>
<td>
<p>An estimate of the marginal dist. of Y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>Boolean of whether this is called for initial
construction of the long data set or as part of the targeting loop. 
If the former, cross-validated empirical "density" estimates are used. 
If the latter these are derived from the targeted cdf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon_0</code></td>
<td>
<p>If <code>update = TRUE</code>, a vector of TMLE fluctuation
parameter estimates used to add the CDF and PDF of Psi(X) to the data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon_1</code></td>
<td>
<p>Ditto above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A truncation level when taking logit transformations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A long form data list of a particular set up. Columns are named id 
(multiple per obs. in validation sample), u (if Yi = 0, these are the unique 
values of psi(x) in the inner validation samples for psi fit on inner training
samples for obs with Y = 1, if Yi = 1, these are values of psi(x) in
the inner validation samples for psi fit on inner training samples for obs. 
with Y = 0), Yi (this id's value of Y), Fn (cross-validation estimated value 
of the cdf of psi(X) given Y = Yi in the training sample), 
dFn (cross-validated estimate of the density of psi(X) given Y = (1-Yi) in the 
training sample), psi (the value of this observations Psihat(P_n,B_n^0)),
gn (estimate of marginal of Y e.g., computed in whole sample), outcome (indicator
that psix &lt;= u), logit_Fn (the cdf estimate on the logit scale, needed for 
offset in targeting model).
</p>


</div>