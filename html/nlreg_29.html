<div class="container">

<table style="width: 100%;"><tr>
<td>plot.nlreg.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic Plots for Nonlinear Heteroscedastic Models
</h2>

<h3>Description</h3>

<p>The <code>nlreg.diag.plots</code> routine generates diagnostic plots for a 
nonlinear heteroscedastic model using different types of residuals, 
influence measures and leverages.  This is equivalent to using the 
<code>plot.nlreg.diag</code> method for function 
<code>plot</code> for objects inheriting from class 
<code>nlreg.diag</code>.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">nlreg.diag.plots(fitted, which = "all", subset = NULL, iden = FALSE, 
                 labels = NULL, hoa = TRUE, infl = TRUE, 
                 trace = FALSE, ret = FALSE, ...)
## S3 method for class 'nlreg.diag'
plot(x, which = "all", subset = NULL, iden = FALSE, labels = NULL, 
     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>

<p>either a <code>nlreg</code> object, that is, the result of a call to 
<code>nlreg</code>, or a <code>nlreg.diag</code> object obtained 
from a call to <code>nlreg.diag</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a <code>nlreg.diag</code> object obtained from a call to 
<code>nlreg.diag</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>which plot to draw.  Admissible values are <code>2</code> to <code>9</code> 
which correspond to the choices below.  The default is 
<code>"all"</code>, which pops up a menu that lists all available plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>the subset of the data used in the original <code>nlreg</code> fit.  Must
be the same than the <code>subset</code> option used in the call to 
<code>nlreg</code> that generated the <code>nlreg</code> object for which the
diagnostic plots are to be drawn.  Needed only if the <code>subset</code>
option is used in the call to <code>nlreg</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iden</code></td>
<td>

<p>logical argument.  If <code>TRUE</code>, the user will be prompted after 
the plots are drawn.  A positive integer will select a plot and 
invoke <code>identify()</code> on that plot.  After 
exiting <code>identify</code>, the user is again prompted, this loop 
continuing until the user responds to the prompt with <code>0</code>.  If
<code>iden</code> is <code>FALSE</code> (default) the user cannot interact with
the plots.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>

<p>a vector of labels for use with <code>identify</code> if <code>iden</code> is
<code>TRUE</code>.  If it is not supplied, the labels are derived 
from the <code>nlreg.diag</code> object argument <code>fitted</code> or 
<code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hoa</code></td>
<td>

<p>logical value indicating whether higher order asymptotics should be
used for calculating the regression diagnostics.  Needed only if
<code>fitted</code> is a <code>nlreg</code> object.  Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infl</code></td>
<td>

<p>logical value indicating whether influence measures should be
calculated on the basis of a leave-one-out analysis.  Needed only 
if <code>fitted</code> is a <code>nlreg</code> object.  Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>logical value.  If <code>TRUE</code> details of the iterations are 
printed.  Needed only if <code>fitted</code> is a <code>nlreg</code> object.  
Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret</code></td>
<td>

<p>logical argument indicating whether the <code>nlreg.diag</code> object 
should be returned; the default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional graphics parameters.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The diagnostics required for the plots are calculated by 
<code>nlreg.diag</code>, either by passing a 
<code>nlreg.diag</code> object or by applying <code>nlreg.diag</code> 
internally to the <code>nlreg</code> object specified through <code>fitted</code>.   
These are then used to produce the plots on the current graphics 
device.  A menu lists all possible choices.  They may be one or all 
of the following.
</p>
<pre>
 Make a plot selection (or 0 to exit)

1:plot: Summary
2:plot: Studentized residuals against fitted values
3:plot: r* residuals against fitted values
4:plot: Normal QQ-plot of studentized residuals
5:plot: Normal QQ-plot of r* residuals
6:plot: Cook statistic against h/(1-h)
7:plot: Global influence against h/(1-h)
8:plot: Cook statistic against observation number
9:plot: Influence measures against observation number

Selection:
</pre>
<p>In the normal scores plots, the dotted line represents the expected 
line if the residuals are normally distributed, that is, it is the line 
with intercept 0 and slope 1.
</p>
<p>In general, when plotting Cook's distance or the global influence
measure against the standardized leverages, there will be two dotted
lines on the plot.  The horizontal line is at 
<code class="reqn">8/(n-2p)</code>, where <code class="reqn">n</code> is the number of 
observations and <code class="reqn">p</code> is the number of regression coefficients 
estimated.  Points above this line may be points with high influence 
on the model.  The vertical line is at <code class="reqn">2p/(n-2p)</code> and
points to the right of this line have high leverage compared to the
variance of the raw residual at that point.  If all points are below
the  horizontal line or to the left of the vertical line then the 
line is not shown.
</p>
<p>Use of <code>iden = TRUE</code> is encouraged for proper exploration of 
these plots as a guide to how well the model fits the data and 
whether certain observations have an unduly large effect on parameter
estimates. 
</p>


<h3>Value</h3>

<p>If <code>ret = TRUE</code>, the <code>nlreg.diag</code> object is returned.  
Otherwise, there is no returned value.
</p>


<h3>Side Effects</h3>

<p>The current device is cleared.  If <code>iden = TRUE</code>, interactive 
identification of points is enabled.  All screens are closed, but not
cleared, on termination of the function.  
</p>


<h3>Acknowledgments</h3>

<p>This function is based on A. J. Canty's function 
<code>glm.diag.plots</code> contained in library <code>boot</code>.
</p>


<h3>Note</h3>

<p>Choices <code>3</code> and <code>5</code> are not available if <code>hoa = FALSE</code>
in the call to <code>nlreg.diag</code> that generated the 
<code>x</code> argument.  
Choices <code>7</code> and <code>9</code> are not available if 
<code>infl = FALSE</code> in the same call.  Plot number <code>9</code> is 
furthermore not available if the variance function is constant.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.  Section 6.3.1 and 
Appendix A.2.2.
</p>
<p>Davison, A. C. and Snell, E. J. (1991) Residuals and diagnostics.  In
<em>Statistical Theory and Modelling: In Honour of Sir David Cox</em>
(eds. D. V. Hinkley, N. Reid, and E. J. Snell), 83–106.  London:
Chapman &amp; Hall.
</p>
<p>Davison, A. C. and Tsai, C.-L. (1992) Regression model diagnostics.  
<em>Int. Stat. Rev.</em>, <b>60</b>, 337–353.
</p>


<h3>See Also</h3>

<p><code>nlreg.diag</code>, <code>nlreg.object</code>, 
<code>identify</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(boot)
data(calcium)
calcium.nl &lt;- nlreg( cal ~ b0*(1-exp(-b1*time)), weights = ~ ( 1+time^g )^2, 
                     start = c(b0 = 4, b1 = 0.1, g = 1), data = calcium, 
                     hoa = TRUE )
##
calcium.diag &lt;- nlreg.diag( calcium.nl, trace = TRUE )
##
## menu-driven
## Not run: 
plot( calcium.diag )
##
##  Make a plot selection (or 0 to exit)
##
## 1:plot: Summary
## 2:plot: Studentized residuals against fitted values
## 3:plot: r* residuals against fitted values
## 4:plot: Normal QQ-plot of studentized residuals
## 5:plot: Normal QQ-plot of r* residuals
## 6:plot: Cook statistic against h/(1-h)
## 7:plot: Global influence against h/(1-h)
## 8:plot: Cook statistic against observation number
## 9:plot: Influence measures against observation number
##
## Selection:
## End(Not run)
##
## plot 5: Normal QQ-plot of r* residuals
plot( calcium.diag, which = 5, las = 1 )
##
nlreg.diag.plots( calcium.nl, which = 5, las = 1 )
</code></pre>


</div>