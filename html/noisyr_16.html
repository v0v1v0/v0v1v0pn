<div class="container">

<table style="width: 100%;"><tr>
<td>plot_expression_similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the similarity against expression levels</h2>

<h3>Description</h3>

<p>Creates the expression-similarity line and box plots for each sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_expression_similarity(
  expression.summary,
  sample.names = NULL,
  similarity.name = "Pearson correlation",
  log.transform = TRUE,
  min.y = NULL,
  max.y = NULL,
  smooth.span = 0.1,
  only.boxplot = FALSE,
  binsize = 1,
  last.together = 0,
  show.counts = TRUE,
  add.threshold = NULL,
  file.name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expression.summary</code></td>
<td>
<p>list containing expression_levels and expression_levels_similarity
matrices, as calculated by <code>calculate_expression_similarity_counts</code> or
<code>calculate_expression_similarity_transcript</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.names</code></td>
<td>
<p>names for the plots, defaults to the column names of the expression matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>similarity.name</code></td>
<td>
<p>similarity metric used (for the y-axis title)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.transform</code></td>
<td>
<p>should the count matrix be log-transformed? If not, boxplot is skipped</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.y, max.y</code></td>
<td>
<p>limits for the y axis. If unset default to symmetric including all values
in expression.levels.similarity; min is set to 0 if there are no negative values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.span</code></td>
<td>
<p>span to be used for smoothing in the line plot; defaults to 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.boxplot</code></td>
<td>
<p>option to skip the line plot (usually a good idea if there are too many points
and lines are too erratic); sets log.transform to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsize</code></td>
<td>
<p>size of each bin in the boxplot; defaults to 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>last.together</code></td>
<td>
<p>groups observations so the highest abundance bin has at least this many</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.counts</code></td>
<td>
<p>whether to show how many observations are in each bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.threshold</code></td>
<td>
<p>adds a horizontal line at this value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>
<p>name of pdf to output the plots; if not provided (default), no printing is done</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of all the plots (returned silently)
</p>


<h3>Examples</h3>

<pre><code class="language-R">plots &lt;- plot_expression_similarity(
  expression.summary=list(
    "expression.levels" = matrix(2^(10*seq(0,1,length.out=100))),
    "expression.levels.similarity" = matrix(seq(0,1,length.out=100)+(runif(100)/5))))
plots[[1]]
plots[[2]]
</code></pre>


</div>