<div class="container">

<table style="width: 100%;"><tr>
<td>spaceTimePlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Space Time plot</h2>

<h3>Description</h3>

<p>The space time separation is a broadly-used method of detecting 
non-stationarity and temporal correlations in the time series being analyzed.
The space time separation plot is also used to select a proper Theiler 
window by selecting a temporal separation enough to saturate the contour 
lines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spaceTimePlot(
  takens = NULL,
  time.series = NULL,
  embedding.dim = 2,
  time.lag = 1,
  max.radius = NULL,
  time.step = 1,
  number.time.steps = NULL,
  numberPercentages = 10,
  do.plot = TRUE,
  ...
)

## S3 method for class 'spaceTimePlot'
contourLines(x)

## S3 method for class 'spaceTimePlot'
getContourLines(x)

## S3 method for class 'spaceTimePlot'
plot(
  x,
  main = "Space time separation plot",
  xlab = NULL,
  ylab = NULL,
  type = "l",
  ylim = NULL,
  col = NULL,
  pch = NULL,
  add.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>takens</code></td>
<td>
<p>Instead of specifying the <em>time.series</em>, the 
<em>embedding.dim</em> and the <em>time.lag</em>, the user may specify directly
the Takens' vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>The original time series being analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embedding.dim</code></td>
<td>
<p>Integer denoting the dimension in which we shall embed 
the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.lag</code></td>
<td>
<p>Integer denoting the number of time steps that will be use 
to construct the 
Takens' vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.radius</code></td>
<td>
<p>Maximum neighbourhood radius in which the algorithm will 
look for finding neighbours. This
parameter may be used to avoid heavy computations. If the user does not 
specify a radius, the algorithm estimates it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.step</code></td>
<td>
<p>Integer denoting the number of discrete steps between two 
calculations of the space time plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number.time.steps</code></td>
<td>
<p>Integer denoting the number of temporal jumps in 
steps of <em>time.step</em> in which we want to compute the space time plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberPercentages</code></td>
<td>
<p>Number of contour lines to be computed. Each 
contour line represent a concrete percentage of points (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.plot</code></td>
<td>
<p>Logical. If TRUE, the time space plot is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional plotting parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <em>spaceTimePlot</em> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot (see <code>?plot</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Numeric vector of length 2, giving the y coordinates range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Vector of colors for each of the percentages of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Vector of symbols for each of the percentages of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>add a legend to the plot?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each contour line of the space time plot indicate the distance you have to 
go (y-axis) to find a given fraction of neighbour pairs, depending on their 
temporal separation (x-axis).
</p>
<p>WARNING: The parameter <em>number.time.steps</em> should be used with caution 
since this 
method performs heavy computations.
</p>


<h3>Value</h3>

<p>A <em>timeSpacePlot</em> object that consist, essentially, of a 
matrix storing the values for each contour line.
Each row stores the value for a given percentage of points. Each column 
stores the value of the radius you have to go to find a given fraction of 
neighbour pairs (the rows), depending on their temporal separation 
(the colums). This matrix can be accessed by using the <em>contourlines</em>
method.
</p>
<p>The <em>contourLines</em> function returns the contour lines of the 
space time plot.
</p>


<h3>Author(s)</h3>

<p>Constantino A. Garcia
</p>


<h3>References</h3>

<p>H. Kantz  and T. Schreiber: Nonlinear Time series Analysis 
(Cambridge university press)
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
 tak = buildTakens(sin(2*pi*0.005*(0:5000)),2,1)
 stp.test = spaceTimePlot(takens=tak,number.time.steps=400,do.plot=TRUE)
 
## End(Not run)
</code></pre>


</div>