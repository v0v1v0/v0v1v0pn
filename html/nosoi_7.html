<div class="container">

<table style="width: 100%;"><tr>
<td>dualDiscrete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dual-host pathogen in structured (discrete) hosts populations</h2>

<h3>Description</h3>

<p>This function, that can be wrapped within <code>nosoiSim</code>, runs a dual-host transmission chain simulation, with discrete hosts populations structures (e.g. spatial, socio-economic, etc.). The simulation stops either at
the end of given time (specified by <code>length.sim</code>) or when the number of hosts infected threshold (<code>max.infected</code>) is crossed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dualDiscrete(
  length.sim,
  max.infected.A,
  max.infected.B,
  init.individuals.A,
  init.individuals.B,
  init.structure.A,
  init.structure.B,
  structure.matrix.A,
  structure.matrix.B,
  pExit.A,
  param.pExit.A,
  timeDep.pExit.A = FALSE,
  diff.pExit.A = FALSE,
  hostCount.pExit.A = FALSE,
  pMove.A,
  param.pMove.A,
  timeDep.pMove.A = FALSE,
  diff.pMove.A = FALSE,
  hostCount.pMove.A = FALSE,
  nContact.A,
  param.nContact.A,
  timeDep.nContact.A = FALSE,
  diff.nContact.A = FALSE,
  hostCount.nContact.A = FALSE,
  pTrans.A,
  param.pTrans.A,
  timeDep.pTrans.A = FALSE,
  diff.pTrans.A = FALSE,
  hostCount.pTrans.A = FALSE,
  prefix.host.A = "H",
  pExit.B,
  param.pExit.B,
  timeDep.pExit.B = FALSE,
  diff.pExit.B = FALSE,
  hostCount.pExit.B = FALSE,
  pMove.B,
  param.pMove.B,
  timeDep.pMove.B = FALSE,
  diff.pMove.B = FALSE,
  hostCount.pMove.B = FALSE,
  nContact.B,
  param.nContact.B,
  timeDep.nContact.B = FALSE,
  diff.nContact.B = FALSE,
  hostCount.nContact.B = FALSE,
  pTrans.B,
  param.pTrans.B,
  timeDep.pTrans.B = FALSE,
  diff.pTrans.B = FALSE,
  hostCount.pTrans.B = FALSE,
  prefix.host.B = "V",
  print.progress = TRUE,
  print.step = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>length.sim</code></td>
<td>
<p>specifies the length (in unit of time) over which the simulation should be run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.infected.A</code></td>
<td>
<p>specifies the maximum number of individual hosts A that can be infected in the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.infected.B</code></td>
<td>
<p>specifies the maximum number of individual hosts B that can be infected in the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.individuals.A</code></td>
<td>
<p>number of initially infected individuals (hosts A).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.individuals.B</code></td>
<td>
<p>number of initially infected individuals (hosts B).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.structure.A</code></td>
<td>
<p>in which state (e.g. location) the initially infected individuals of host-type A are located (<code>NA</code> if init.individual.A is 0)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.structure.B</code></td>
<td>
<p>in which state (e.g. location) the initially infected individuals of host-type B are located (<code>NA</code> if init.individual.B is 0)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure.matrix.A</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column) for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>structure.matrix.B</code></td>
<td>
<p>transition matrix (probabilities) to go from location A (row) to B (column) for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pExit.A</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host A (either moving out, dying, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pExit.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pExit.A</code></td>
<td>
<p>is pExit of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pExit.A</code></td>
<td>
<p>is pExit of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pExit.A</code></td>
<td>
<p>does pExit of host-type A vary with the host count (of either host-type A or B) in the state? (TRUE/FALSE); diff.pExit.A should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pMove.A</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pMove.A</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pMove.A</code></td>
<td>
<p>is pMove of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pMove.A</code></td>
<td>
<p>is pMove of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pMove.A</code></td>
<td>
<p>does pMove of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pMove.A should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nContact.A</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.nContact.A</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.nContact.A</code></td>
<td>
<p>is nContact of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.nContact.A</code></td>
<td>
<p>is nContact of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.nContact.A</code></td>
<td>
<p>does nContact of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.nContact.A should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTrans.A</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pTrans.A</code></td>
<td>
<p>parameter names (list of functions) for the pExit  for host A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pTrans.A</code></td>
<td>
<p>is pTrans of host-type A different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pTrans.A</code></td>
<td>
<p>does pTrans of host-type A vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pTrans.A should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix.host.A</code></td>
<td>
<p>character(s) to be used as a prefix for the host A identification number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pExit.B</code></td>
<td>
<p>function that gives the probability to exit the simulation for an infected host B (either moving out, dying, etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pExit.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pExit.B</code></td>
<td>
<p>is pExit of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pExit.B</code></td>
<td>
<p>is pExit of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pExit.B</code></td>
<td>
<p>does pExit of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pExit.B should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pMove.B</code></td>
<td>
<p>function that gives the probability of a host moving as a function of time for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pMove.B</code></td>
<td>
<p>parameter names (list of functions) for the pMove for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pMove.B</code></td>
<td>
<p>is sdMove of host-type B dependent on the absolute time of the simulation (TRUE/FALSE) for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pMove.B</code></td>
<td>
<p>is pMove of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pMove.B</code></td>
<td>
<p>does pMove of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pMove.B should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nContact.B</code></td>
<td>
<p>function that gives the number of potential transmission events per unit of time for host B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.nContact.B</code></td>
<td>
<p>parameter names (list of functions) for param.nContact for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.nContact.B</code></td>
<td>
<p>is nContact of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.nContact.B</code></td>
<td>
<p>is nContact of host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.nContact.B</code></td>
<td>
<p>does nContact of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.nContact.B should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTrans.B</code></td>
<td>
<p>function that gives the probability of transmit a pathogen as a function of time since infection for host B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.pTrans.B</code></td>
<td>
<p>parameter names (list of functions) for the pExit for host-type B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeDep.pTrans.B</code></td>
<td>
<p>is pTrans of host-type B dependent on the absolute time of the simulation (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff.pTrans.B</code></td>
<td>
<p>is pTrans host-type B different between states of the structured population (TRUE/FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hostCount.pTrans.B</code></td>
<td>
<p>does pTrans of host-type B vary with the host count (of either host A or B) in the state? (TRUE/FALSE); diff.pTrans.B should be TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix.host.B</code></td>
<td>
<p>character(s) to be used as a prefix for the host B identification number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.progress</code></td>
<td>
<p>if TRUE, displays a progress bar (current time/length.sim).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.step</code></td>
<td>
<p>print.progress is TRUE, step with which the progress message will be printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>pExit</code> and <code>pTrans</code> functions should return a single probability (a number between 0 and 1), and <code>nContact</code> a positive natural number (positive integer) or 0.
</p>
<p>The <code>param</code> arguments should be a list of functions or NA. Each item name in the parameter list should have the same name as the argument in the corresponding function.
</p>
<p>The use of <code>timeDep</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>prestime</code> (for "present time").
</p>


<h3>Value</h3>

<p>An object of class <code>nosoiSim</code>, containing all results of the simulation.
</p>


<h3>Structure Matrix</h3>

<p>The structure/transition matrix provided provided should of class <code>matrix</code>, with the same number of rows and columns, rows representing departure state and column the arrival state. All rows should add to 1. Probability values can be different for hosts A and B (so two different matrices), but the name of the column and the rows should be shared.
</p>


<h3>Order of Arguments</h3>

<p>The user specified function's arguments should follow this order: <code>t</code> (mandatory), <code>prestime</code> (optional, only if timeDep is TRUE),
<code>current.in</code> (optional, only if diff is TRUE), <code>host.count.A</code> or <code>host.count.B</code> (optional, only if hostCount is TRUE) and <code>parameters</code> specified in the list.
</p>


<h3>Structure Parameters</h3>

<p>The <code>pMove</code> function should return a single probability (a number between 0 and 1).
</p>
<p>The use of <code>diff</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>current.in</code> (for "currently in"). Your function should in that case give a result for every possible discrete state.
</p>
<p>The use of <code>hostCount</code> (switch to <code>TRUE</code>) makes the corresponding function use the argument <code>host.count</code>.
</p>


<h3>Suffixes</h3>

<p>The suffix <code>.A</code> or <code>.B</code> specifies if the considered function or parameter concerns host type A or B.
</p>


<h3>See Also</h3>

<p>For simulations with a structure in continuous space, see <code>dualContinuous</code>. For simulations without any structures, see <code>dualNone</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Host A
t_infectA_fct &lt;- function(x){rnorm(x,mean = 12,sd=3)}
pTrans_hostA &lt;- function(t,t_infectA){
 if(t/t_infectA &lt;= 1){p=sin(pi*t/t_infectA)}
 if(t/t_infectA &gt; 1){p=0}
 return(p)
}

p_Move_fctA  &lt;- function(t){return(0.1)}

p_Exit_fctA  &lt;- function(t,t_infectA){
 if(t/t_infectA &lt;= 1){p=0}
 if(t/t_infectA &gt; 1){p=1}
 return(p)
}

time_contact_A = function(t){sample(c(0,1,2),1,prob=c(0.2,0.4,0.4))}

t_incub_fct_B &lt;- function(x){rnorm(x,mean = 5,sd=1)}
p_max_fct_B &lt;- function(x){rbeta(x,shape1 = 5,shape2=2)}

p_Exit_fct_B  &lt;- function(t,current.in){
 if(current.in=="A"){return(0.1)}
 if(current.in=="B"){return(0.2)}
 if(current.in=="C"){return(1)}}

pTrans_hostB &lt;- function(t,p_max,t_incub){
 if(t &lt;= t_incub){p=0}
 if(t &gt;= t_incub){p=p_max}
 return(p)
}

time_contact_B = function(t){round(rnorm(1, 3, 1), 0)}

transition.matrix = matrix(c(0,0.2,0.4,0.5,0,0.6,0.5,0.8,0),
                          nrow = 3, ncol = 3,
                          dimnames=list(c("A","B","C"),c("A","B","C")))

set.seed(6262)
test.nosoi &lt;- nosoiSim(type="dual", popStructure="discrete",
                      length.sim=40,
                      max.infected.A=100,
                      max.infected.B=200,
                      init.individuals.A=1,
                      init.individuals.B=0,
                      init.structure.A="A",
                      init.structure.B=NA,
                      structure.matrix.A=transition.matrix,
                      structure.matrix.B=transition.matrix,
                      pExit.A = p_Exit_fctA,
                      param.pExit.A = list(t_infectA = t_infectA_fct),
                      pMove.A=p_Move_fctA,
                      param.pMove.A=NA,
                      timeDep.pMove.A=FALSE,
                      diff.pMove.A=FALSE,
                      timeDep.pExit.A=FALSE,
                      nContact.A = time_contact_A,
                      param.nContact.A = NA,
                      timeDep.nContact.A=FALSE,
                      pTrans.A = pTrans_hostA,
                      param.pTrans.A = list(t_infectA=t_infectA_fct),
                      timeDep.pTrans.A=FALSE,
                      prefix.host.A="H",
                      pExit.B = p_Exit_fct_B,
                      param.pExit.B = NA,
                      timeDep.pExit.B=FALSE,
                      diff.pExit.B=TRUE,
                      pMove.B=NA,
                      param.pMove.B=NA,
                      timeDep.pMove.B=FALSE,
                      diff.pMove.B=FALSE,
                      nContact.B = time_contact_B,
                      param.nContact.B = NA,
                      timeDep.nContact.B=FALSE,
                      pTrans.B = pTrans_hostB,
                      param.pTrans.B = list(p_max=p_max_fct_B,
                                            t_incub=t_incub_fct_B),
                      timeDep.pTrans.B=FALSE,
                      prefix.host.B="V")

test.nosoi

</code></pre>


</div>