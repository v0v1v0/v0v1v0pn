<div class="container">

<table style="width: 100%;"><tr>
<td>features</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract locations of features from a 'not' object</h2>

<h3>Description</h3>

<p>The function applies user-specified stopping criteria to extract change-points from <code>object</code>
generated by <code>not</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">features(object, ...)

## Default S3 method:
features(object, method = c("ic", "threshold"),
  penalty = c("sic", "aic", "user"), q.max = 25, penalty.fun, th, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of 'not' class returned by <code>not</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments that can be passed to the penalty function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A method of choosing the best solution in <code>object$solution.path</code>. 
If <code>method="ic"</code>, model minimising a chosen information criterion is selected. 
If <code>method="threshold"</code>, model is selected based on thresholding (see references for more details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Name of the penalty function to be used if <code>method="ic"</code>. If <code>penalty="user"</code>,
a user-defined penalty function has to be passed via <code>penalty.fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.max</code></td>
<td>
<p>Maximum number of change-points allowed to be detected. Used only for <code>method="ic"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty.fun</code></td>
<td>
<p>Used only if <code>penalty="user"</code>. A function includes at least  the following arguments: sample size <code>n</code>, number of parameters used in a model <code>n.param</code>, and <code>...</code>.
For examples of such functions, see <code>aic.penalty</code> and <code>sic.penalty</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>Used only if <code>method="threshold"</code>. A positive real number.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Denote by <code class="reqn">T_{1}, \ldots, T_{N}</code> the elements on the solution path <code>object$solution.path</code>, 
each representing a set of change-points.
When (<code>method="ic"</code>), the returned set of change-points is the one that minimises
</p>
<p style="text-align: center;"><code class="reqn">-2\mbox{log-likelihood}(\code{object}, \code{cpt}=T_k)+\mbox{penalty}(\code{object\$n}, \code{n.param}, ...),</code>
</p>

<p>over all <code class="reqn">k</code> such that the number of change-points in <code class="reqn">T_k</code> is smaller than or equal <code>q.max</code>. The log-likelihood is computed using the <code>logLik</code> routine,
while the penalty function is computed with <code>sic.penalty</code> (<code>penalty="sic"</code>), <code>aic.penalty</code> (<code>penalty="aic"</code>) or a user-defined penalty function (<code>penalty="user"</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>Value of the threshold used (if <code>method="threshold"</code>) or selected on the solution path (if <code>method="ic"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpt</code></td>
<td>
<p>Estimated locations of the change-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>Values of the information criterion minimised in order to find an optimal solution on the path (only if <code>method="ic"</code> was used).</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>R. Baranowski, Y. Chen, and P. Fryzlewicz (2019). Narrowest-Over-Threshold Change-Point Detection.  (<a href="http://stats.lse.ac.uk/fryzlewicz/not/not.pdf">http://stats.lse.ac.uk/fryzlewicz/not/not.pdf</a>)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># **** Piecewisce-constant mean with Gaussian noise.
x &lt;- c(rep(0, 100), rep(1,100)) + rnorm(100)
# *** identify potential locations of the change-points
w &lt;- not(x, contrast = "pcwsConstMean")
# *** choose change-points using default settings
fo &lt;- features(w)
# *** get the change-points
fo$cpt
# *** plot the SIC curve
plot(fo$ic)
</code></pre>


</div>