<div class="container">

<table style="width: 100%;"><tr>
<td>INPROCreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Induced nonparametric ROC regression modelling
</h2>

<h3>Description</h3>

<p>Estimates the covariate-specific ROC curve (and related measures) in the presence of a one-dimensional continuous covariate based on the induced nonparametric ROC regression approach as presented in Rodriguez-Alvarez et al. (2011).  
</p>


<h3>Usage</h3>

<pre><code class="language-R">INPROCreg(marker, covariate, group, tag.healthy, data, ci.fit = FALSE, 
test = FALSE, accuracy = NULL, accuracy.cal = c("ROC", "AROC"), 
newdata = NULL, control = controlINPROCreg(), weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>A character string with the name of the diagnostic test variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>A character string with the name of the continuous covariate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A character string with the name of the variable that distinguishes healthy from diseased individuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag.healthy</code></td>
<td>
<p>The value codifying the healthy individuals in the variable <code>group</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame representing the data and containing all needed variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.fit</code></td>
<td>
<p>A logical value. If TRUE, confidence intervals are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A logical value. If TRUE, the bootstrap-based test for detecting covariate effect is performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>A character vector indicating if the Youden index (“YI”), the value for which the TPF and the TNF coincides (“EQ”), and/or optimal threshold (“TH”) based on these two criteria should be computed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy.cal</code></td>
<td>
<p>A character string indicating if the accuracy measures should be calculated based on the covariate-specific ROC curve or on the covariate-adjusted ROC curve (AROC).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A data frame containing the values of the covariate at which predictions are required.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Output of the <code>controlINROCreg()</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of ‘prior weights’ to be used in the fitting process.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>As a result, the function <code>INPROCreg()</code> provides a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The data frame used in the predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpf</code></td>
<td>
<p>Set of false positive fractions at which the covariate-specific ROC curve has been estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Estimated regression and variance functions in healthy population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Estimated regression and variance functions in diseased population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROC</code></td>
<td>
<p>Estimated covariate-specific ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>Estimated covariate-specific AUC, and corresponding confidence intervals if required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AROC</code></td>
<td>
<p>Estimated covariate-adjusted ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>YI/EQ</code></td>
<td>
<p>If required, estimated covariate-specific YI (or values at which the TPF and the TNF coincide), and corresponding bootstrap confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TH</code></td>
<td>
<p>If required, estimated optimal threshold values based on either the YI or the criterion of equality of TPF and TNF, and corresponding bootstrap confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>If required, p-value obtained with the test for checking the effect of the continuous covariate on the ROC curve.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Maria Xose Rodriguez - Alvarez and Javier Roca-Pardinas
</p>


<h3>References</h3>

<p>Gonzalez - Manteiga, W., Pardo-Fernandez, J.C. and van Keilegom, I. (2011). ROC curves in nonparametric location-scale regression models. Scandinavian Journal of Statistics, 38, 169–184.
</p>
<p>Rodriguez - Alvarez, M.X., Roca-Pardinas, J. and Cadarso-Suarez, C. (2011). ROC curve and covariates: extending induced methodology to the non-parametric framework. Statistics and Computing, 21(4), 483–499.
</p>
<p>Yao, F., Craiu, R.V. and Reiser, B. (2010). Nonparametric covariate adjustment for receiver operating characteristic curves. The Canadian Journal of Statistics, 38, 27–46.
</p>


<h3>See Also</h3>

<p>See Also as <code>DNPROCreg</code>, <code>summary.INPROCreg</code>, <code>plot.INPROCreg</code>, <code>controlINPROCreg</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(endosim)
# Evaluate the effect of age on the accuracy of the body mass index for males
m0.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))	

summary(m0.men)
plot(m0.men)
# Evaluate the effect of age on the accuracy of the body mass index for females
m0.women &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Women"), 
						ci.fit = FALSE, test = FALSE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="ROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
						
summary(m0.women)						
plot(m0.women)
## Not run: 
# For computing confidence intervals and testing covariate effect
set.seed(123)
m1.men &lt;- INPROCreg(marker = "bmi", covariate = "age", group = "idf_status", 
						tag.healthy = 0, 
						data = subset(endosim, gender == "Men"), 
						ci.fit = TRUE, test = TRUE, 
						accuracy = c("EQ","TH"),
						accuracy.cal="AROC", 
						control=controlINPROCreg(p=1,kbin=30,step.p=0.01), 
						newdata = data.frame(age = seq(18,85,l=50)))
summary(m1.men)
plot(m1.men)					

## End(Not run)
</code></pre>


</div>