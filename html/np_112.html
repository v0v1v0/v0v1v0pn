<div class="container">

<table style="width: 100%;"><tr>
<td>nptgauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Truncated Second-order Gaussian Kernels</h2>

<h3>Description</h3>

<p><code>nptgauss</code> provides an interface for setting the truncation
radius of the truncated second-order Gaussian kernel used
by <span class="pkg">np</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nptgauss(b)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Truncation radius of the kernel.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p><code>nptgauss</code> allows one to set the truncation radius of the truncated Gaussian kernel used by <span class="pkg">np</span>, which defaults to 3. It automatically computes the constants describing the truncated gaussian kernel for the user.
</p>
<p>We define the truncated gaussion kernel on the interval <code class="reqn">[-b,b]</code> as:
</p>
<p style="text-align: center;"><code class="reqn">K = \frac{\alpha}{\sqrt{2\pi}}\left(e^{-z^2/2} - e^{-b^2/2}\right)</code>
</p>

<p>The constant <code class="reqn">\alpha</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">\alpha = \left[\int_{-b}^{b} \frac{1}{\sqrt{2\pi}}\left(e^{-z^2/2} - e^{-b^2/2}\right)\right]^{-1}</code>
</p>

<p>Given these definitions, the derivative kernel is simply:
</p>
<p style="text-align: center;"><code class="reqn">K' = (-z)\frac{\alpha}{\sqrt{2\pi}}e^{-z^2/2}</code>
</p>

<p>The CDF kernel is:
</p>
<p style="text-align: center;"><code class="reqn">G = \frac{\alpha}{2}\mathrm{erf}(z/\sqrt{2}) + \frac{1}{2} - c_0z</code>
</p>

<p>The convolution kernel on <code class="reqn">[-2b,0]</code> has the general form:
</p>
<p style="text-align: center;"><code class="reqn">H_- = a_0\,\mathrm{erf}(z/2 + b) e^{-z^2/4} + a_1z + a_2\,\mathrm{erf}((z+b)/\sqrt{2}) - c_0</code>
</p>

<p>and on <code class="reqn">[0,2b]</code> it is:
</p>
<p style="text-align: center;"><code class="reqn">H_+ = -a_0\,\mathrm{erf}(z/2 - b) e^{-z^2/4} - a_1z - a_2\,\mathrm{erf}((z-b)/\sqrt{2}) - c_0</code>
</p>

<p>where <code class="reqn">a_0</code> is determined by the normalisation condition on H,
<code class="reqn">a_2</code> is determined by considering the value of the kernel at
<code class="reqn">z = 0</code> and <code class="reqn">a_1</code> is determined by the requirement that <code class="reqn">H = 0</code> at <code class="reqn">[-2b,2b]</code>.
</p>


<h3>Author(s)</h3>

<p>Tristen Hayfield <a href="mailto:tristen.hayfield@gmail.com">tristen.hayfield@gmail.com</a>, Jeffrey S. Racine
<a href="mailto:racinej@mcmaster.ca">racinej@mcmaster.ca</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## The default kernel, a gaussian truncated at +- 3
nptgauss(b = 3.0)

</code></pre>


</div>