<div class="container">

<table style="width: 100%;"><tr>
<td>mctp.rm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nonparametric multiple contrast tests and simultaneous confidence intervals (repeated measures)
</h2>

<h3>Description</h3>

<p>The function mctp.rm computes the estimator of nonparametric relative effects based on global rankings, simultaneous confidence intervals for the effects, and adjusted p-values based on contrasts in the setting of a repeated measures design with n independent individuals and d repeated measures. Contrasts include "Tukey", "Dunnett", "Sequen", "Williams", "Changepoint", "AVE", "McDermott", "Marcus", "UmbrellaWilliams", "GrandMean", and "UserDefined". The statistics are computed using multivariate normal distribution, multivariate Satterthwaite t-Approximation, and multivariate transformations (adjusted log odds or Fisher function). The function 'mctp.rm' computes both the one-sided and two-sided simultaneous confidence intervals and adjusted p-values. The confidence intervals can be plotted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mctp.rm(formula, data, type = c("Tukey", "Dunnett", "Sequen", 
     "Williams", "Changepoint", "AVE", "McDermott", "Marcus", 
     "UmbrellaWilliams", "GrandMean", "UserDefined"), 
     conf.level = 0.95, alternative = c("two.sided", "less", 
     "greater"), asy.method = c("log.odds", "fisher", "mult.t", 
     "normal"), plot.simci = FALSE, control = NULL, info = TRUE, 
     rounds = 3, contrast.matrix = NULL, correlation = FALSE, 
     const=1/1.702)        
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A two-sided 'formula' specifying a numeric response variable
and a repeated measures factor with more than two levels. 
If the factor contains less than 3 levels, an error message will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe containing the variables specified in formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string defining the type of contrast. It should be one of 
"Tukey", "Dunnett", "Sequen", "Williams", "Changepoint", "AVE", "McDermott", "Marcus", "UmbrellaWilliams", "GrandMean", 
"UserDefined".  	
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The confidence level for <code>conf.level</code>-confidence intervals (default is 0.95).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string defining the alternative hypothesis, one
of "two.sided", "less", or "greater".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asy.method</code></td>
<td>
<p>Character string defining the asymptotic approximation method, one of
"log.odds" (for using the adjusted log odds effect sizes), 
"mult.t" (for using a multivariate t-distribution with a Satterthwaite Approximation), 
"fisher" (for using the Fisher transformation function), or 
"normal" (for using the multivariate normal distribution).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.simci</code></td>
<td>
<p>A logical indicating whether you want a plot of the confidence intervals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Character string defining the control group in Dunnett comparisons. By default, it is the first group by
definition of the factor variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>A logical whether you want a brief overview with informations about the output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounds</code></td>
<td>
<p>Number of rounds for the numeric values of the output (default is 3).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast.matrix</code></td>
<td>
<p>User-defined contrast matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>A logical whether the estimated correlation matrix and covariance matrix should be printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>const</code></td>
<td>
<p>Number used for the adjustment of log odds when the "log.odds" option is chosen.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data.Info</code></td>
<td>
<p>List of samples and sample sizes and estimated effect per repeated measures level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Contrast</code></td>
<td>
<p>Contrast matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Analysis</code></td>
<td>
<p>       Estimator: Estimated relative effect,
Lower: Lower limit of the simultaneous confidence intervals,
Upper: Upper limit of the simultaneous confidence intervals,
Statistic: Test statistic
p.Value: Adjusted p-values for the hypothesis by the choosen approximation method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Analysis.Inf</code></td>
<td>
<p>The same as <code>Analysis</code> except that it assumes <code>rounds = Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Overall</code></td>
<td>
<p>The critical value and adjusted p-value for the overall hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>List of input arguments by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.Output</code></td>
<td>
<p>Character string specifying the alternative hypotheses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connames</code></td>
<td>
<p>Character string specifying the contrast names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AsyMethod</code></td>
<td>
<p>Character string specifying the approximation method.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Estimated relative effects with 0 or 1 are replaced with 0.001 and 0.999.
</p>
<p>A summary and a graph can be created separately by using the functions
<code>summary.mctp.rm</code> and <code>plot.mctp.rm</code>.
</p>
<p>For the analysis, the R packages 'multcomp' and 'mvtnorm' are required.
</p>


<h3>Author(s)</h3>

<p>Marius Placzek, Kimihiro Noguchi
</p>


<h3>References</h3>

<p>F. Konietschke, A.C. Bathke, L.A. Hothorn, E. Brunner: Testing and estimation of 
purely nonparametric effects in repeated measures designs. Computational Statistics
and Data Analysis 54 (2010) 1895-1905.
</p>


<h3>See Also</h3>

<p>To analyse simple one-way layouts with independent samples use <code>mctp</code>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(panic)
a&lt;-mctp.rm(CGI~week, data=panic, type = "Dunnett",
           alternative = "two.sided",
           asy.method = "log.odds", plot.simci = FALSE,
           info = FALSE, contrast.matrix = NULL)
summary(a)
plot(a)

b&lt;-mctp.rm(CGI~week, data=panic, type = "Dunnett",
           alternative = "two.sided",
           asy.method = "mult.t", plot.simci = FALSE,
           info = FALSE, contrast.matrix = NULL)
summary(b)
plot(b)

c&lt;-mctp.rm(CGI~week, data=panic, type = "Dunnett",
           alternative = "two.sided",
           asy.method = "fisher", plot.simci = FALSE,
           info = FALSE, contrast.matrix = NULL)
summary(c)
plot(c)

d&lt;-mctp.rm(CGI~week, data=panic, type = "Tukey",
        alternative = "two.sided",
        asy.method = "mult.t", plot.simci = TRUE)
summary(d)

## End(Not run)</code></pre>


</div>