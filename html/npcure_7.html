<div class="container">

<table style="width: 100%;"><tr>
<td>latencyhboot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Bootstrap Bandwidth for the Nonparametric Estimator
of the Latency
</h2>

<h3>Description</h3>

<p>This function computes the bootstrap bandwidth for the
nonparametric estimator of the conditional latency function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">latencyhboot(x, t, d, dataset, x0, bootpars = controlpars())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>If <code>dataset</code> is missing, a numeric object giving the
covariate values. If <code>dataset</code> is a data frame, it is
interpreted as the name of the variable corresponding to the
covariate in the data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>If <code>dataset</code> is missing, a numeric object giving the
observed times. If <code>dataset</code> is a data frame, it is interpreted
as the name of the variable corresponding to the observed times in
the data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>If <code>dataset</code> is missing, an integer object giving the
values of the uncensoring indicator. Censored observations must be
coded as 0, uncensored ones as 1. If <code>dataset</code> is a data frame,
it is interpreted as the name of the variable corresponding to the
uncensoring indicator in the data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>An optional data frame in which the variables named in
<code>x</code>, <code>t</code> and <code>indicator</code> are interpreted. If it is
missing, <code>x</code>, <code>t</code> and <code>indicator</code> must be objects
of the workspace.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>A numeric vector of covariate values where the local
bootstrap bandwidth will be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootpars</code></td>
<td>
<p>A list of parameters controlling the process of
bandwidth selection. The default is the value returned by the
<code>controlpars</code> function called without arguments.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes the bootstrap bandwidth selector for the
nonparametric estimator of the conditional latency function at the
covariate values given by <code>x0</code>. The bootstrap bandwidth is the
minimizer of a bootstrap version of the Mean Integrated Squared Error
(MISE) of the latency estimator, which is approximated by Monte Carlo
by simulating a large number of bootstrap resamples, <code>B</code>. For
each value of <code>x0</code>, the bootstrap MISE is the bootstrap
expectation of the integrated difference between the value of the
latency estimator computed with the bootstrap sample in a grid of
bandwidths and its value computed with the original sample and a pilot
bandwidth. The bootstrap resamples are generated by using the simple
weighted bootstrap resampling method, fixing the covariate. This
method is equivalent to the simple weighted bootstrap of Li and Datta
(2001). All the parameters typically involved in the bootstrap
bandwidth selection process (number of bootstrap resamples, grid of
bandwidths, pilot bandwidth, and right boundary of the integration
interval for computing the MISE) are typically set through the
<code>controlpars</code> function, whose output is passed to the
<code>bootpars</code> argument. Also, the bootstrap bandwidths can be
smoothed, and, if so, the smoothed bandwidths are returned as a
separate component of the output. See the help of <code>controlpars</code>
for details.
</p>


<h3>Value</h3>

<p>An object of S3 class 'npcure'. Formally, a list of components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The constant character string c("Bootstrap bandwidth",
"latency").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Grid of covariate values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Selected local bootstrap bandwidths.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hsmooth</code></td>
<td>
<p>Smoothed selected local bootstrap bandwidths (optional)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hgrid</code></td>
<td>
<p>Grid of bandwidths used (optional).
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ignacio López-de-Ullibarri [aut, cre],
Ana López-Cheda [aut],
Maria Amalia Jácome [aut]
</p>


<h3>References</h3>

<p>Li, G., Datta, S. (2001). A bootstrap approach to
nonparametric regression for right censored data. Annals of the
Institute of Statistical Mathematics, 53:
708–729. <a href="https://doi.org/10.1023/A:1014644700806">https://doi.org/10.1023/A:1014644700806</a>.
</p>
<p>López-Cheda, A., Jácome, M. A., Cao, R. (2017). Nonparametric latency
estimation for mixture cure models. TEST, 26:
353–376. <a href="https://doi.org/10.1007/s11749-016-0515-1">https://doi.org/10.1007/s11749-016-0515-1</a>.
</p>


<h3>See Also</h3>

<p><code>controlpars</code>, <code>latency</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Some artificial data
set.seed(123)
n &lt;- 50
x &lt;- runif(n, -2, 2) ## Covariate values
y &lt;- rweibull(n, shape = .5*(x + 4)) ## True lifetimes
c &lt;- rexp(n) ## Censoring values
p &lt;- exp(2*x)/(1 + exp(2*x)) ## Probability of being susceptible
u &lt;- runif(n)
t &lt;- ifelse(u &lt; p, pmin(y, c), c) ## Observed times
d &lt;- ifelse(u &lt; p, ifelse(y &lt; c, 1, 0), 0) ## Uncensoring indicator
data &lt;- data.frame(x = x, t = t, d = d)

## A vector of covariate values
vecx0 &lt;- seq(-1.5, 1.5, by = .1)

## Computation of bootstrap local bandwidths at the values of 'vecx0'...
#### ... with the default control parameters
hb1 &lt;- latencyhboot(x, t, d, data, x0 = vecx0)

#### ... changing the default 'bootpars' with 'controlpars()':
#### (a) 'B = 1999' (1999 bootstrap resamples are generated),
#### (b) 'hbound = c(.2, 4)' and 'hl = 50' (a grid of 50 bandwidths
#### between 0.2 and 4 times the standardized interquartile range of
#### the covariate values is built), and
#### (c) 'hsave = TRUE' (the grid bandwidths are saved), and

hb2 &lt;- latencyhboot(x, t, d, data, x0 = vecx0, bootpars =
controlpars(B = 1999, hbound = c(.2, 4), hl = 50, hsave = TRUE))

## Estimates of the conditional latency at the covariate value x0 = 0
## with the selected bootstrap bandwidths
S1 &lt;- latency(x, t, d, data, x0 = 0, h = hb1$h[hb1$x0 == 0])
S2 &lt;- latency(x, t, d, data, x0 = 0, h = hb2$h[hb2$x0 == 0])

## A plot comparing the estimates with bootstrap bandwidths obtained
## with default and non-default 'bootpars'
plot(S1$testim, S1$S$x0, type = "s", xlab = "Time", ylab = "Latency",
ylim = c(0, 1))
lines(S2$testim, S2$S$x0, type = "s", lty = 2)
lines(S1$testim, pweibull(S1$testim, shape = .5*(0 + 4), lower.tail =
FALSE), col = 2)
legend("topright", c("Estimate with 'hb1'", "Estimate with 'hb2'",
"True"), lty = c(1, 2, 1), col = c(1, 1, 2))

## Example with the dataset 'bmt' of the 'KMsurv' package
## to study the survival of the uncured patients aged 25 and 40
data("bmt", package = "KMsurv")
x0 &lt;- c(25, 40)
hb &lt;- latencyhboot(z1, t2, d3, bmt, x0 = x0, bootpars = controlpars(B =
1999, hbound = c(.2, 4), hl = 150, hsave = TRUE))
S0 &lt;- latency(z1, t2, d3, bmt, x0 = x0, hb$h, conflevel = .95)
## Plot of predicted latency curves and confidence bands
plot(S0$testim, S0$S$x25, type = "s", xlab = "Time (days)",
ylab = "Survival", ylim = c(0,1))
lines(S0$testim, S0$conf$x25$lower, type = "s", lty = 2)
lines(S0$testim, S0$conf$x25$upper, type = "s", lty = 2)
lines(S0$testim, S0$S$x40, type = "s", lty = 1, col = 2)
lines(S0$testim, S0$conf$x40$lower, type = "s", lty = 2, col = 2)
lines(S0$testim, S0$conf$x40$upper, type = "s", lty = 2, col = 2)
legend("topright", c("Age 25: Estimate", "Age 25: 95% CI limits",
"Age 40: Estimate", "Age 40: 95% CI limits"), lty = 1:2,
col = c(1, 1, 2, 2)) 

</code></pre>


</div>