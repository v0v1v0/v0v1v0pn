<div class="container">

<table style="width: 100%;"><tr>
<td>npde.plot.scatterplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scatterplots and VPC</h2>

<h3>Description</h3>

<p>Produces a scatterplot. Different types of scatterplots can be produced, with associated prediction bands (see details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">npde.plot.scatterplot(npdeObject, which.x="x", which.y="npd", ref.prof=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>npdeObject</code></td>
<td>
<p>an object returned by a call to <code>npde</code> or <code>autonpde</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.x</code></td>
<td>
<p>a string specifying the variable on the X-axis (one of "x", "pred", "cov")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.y</code></td>
<td>
<p>a string specifying the variable on the Y-axis (one of "yobs", "npde", "pd", "npd"), defaults to "npd"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.prof</code></td>
<td>
<p>either a character string (one of "covariate" or "all"), or a named list specifying the characteristics of the reference profile (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed on to the function, to control which metric (npde, pd, npd) is used or to override graphical parameters (see the PDF document for details, as well as <code>set.plotoptions</code> and <code>npdeControl</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>VPC: obtained using which.x="x", which.y="yobs"
</p>
<p>Scatterplots of npde/pd/npd can be obtained versus "x" (independent variable) or "pred" (population predictions from the model)
</p>
<p>Scatterplots of npde/pd/npd/observations can be obtained versus covariates by setting the which.x argument to "cov" and selecting the appropriate which.y. The function will use the covariates in the which.cov element of the prefs slot. This can be overriden to cycle over all the covariates in the dataset by supplying the argument which.cov="all" in the call to the function.
</p>
<p>Reference profile: a reference profile can be added to scatterplots of npd and npde versus the independent variable (see Comets et al. 2013)
</p>
<p>If ref.prof="all" (and covsplit is FALSE), the reference plot will be computed over all subjects using the mean and SD of all simulated data in each bin (see documentation).
</p>
<p>If ref.prof="covariate" and an additional argument covsplit is given (covsplit=TRUE), the reference plot will be adjusted for each covariate category over all the covariates in the which.cov element of the prefs slot (see  <code>npdeControl</code> for details on the prefs slot of the npdeObject).
</p>
<p>If ref.prof is given as a named list (eg list(ID=c(1,5)) or list(sex=0, dose=c(50,100)), where names should refer to columns in the data file (eg ID should be a column in the data)), the reference profile will be obtained by combining (in the first example above, the reference profile will be obtained using the simulated data for subjects 1 and 5, while in the second example it will be computed using the subjects with sex=0 given doses 50 or 100).
</p>


<h3>Value</h3>

<p>a ggplot object or a list of ggplot objects (grobs)
</p>


<h3>Author(s)</h3>

<p>Emmanuelle Comets &lt;emmanuelle.comets@bichat.inserm.fr&gt;
</p>


<h3>References</h3>

<p>K. Brendel, E. Comets, C. Laffont, C. Laveille, and F.  Mentre.
Metrics for external model evaluation with an application to the population pharmacokinetics of gliclazide.
<em>Pharmaceutical Research</em>, 23:2036–49, 2006.
</p>
<p>E. Comets, T.H.T. Nguyen, and F. Mentré F. Additional features and graphs in the new npde library for R.
<em>22th meeting of the Population Approach Group in Europe</em>, Glasgow, United Kingdom, 2013.
</p>


<h3>See Also</h3>

<p><code>npde</code>, <code>autonpde</code>, <code>set.plotoptions</code>, <code>npdeControl</code>
</p>


</div>