<div class="container">

<table style="width: 100%;"><tr>
<td>plot.glmmNPML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Plot Diagnostics for objects of class glmmNPML or glmmGQ</h2>

<h3>Description</h3>

<p>The functions <code>alldist</code>  and <code>allvc</code>   produce  
objects of type <code>glmmGQ</code>, if Gaussian quadrature (Hinde, 1982, 
<code>random.distribution="gq"</code>) was applied for computation, and  objects
of class <code>glmmNPML</code>, if parameter estimation was carried out by nonparametric
maximum likelihood (Aitkin, 1996a, <code>random.distribution="np"</code>). 
The functions presented here give some useful diagnostic plotting functionalities 
to analyze these objects. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'glmmNPML'
plot(x, plot.opt = 15, noformat=FALSE, ...)
## S3 method for class 'glmmGQ'
plot(x, plot.opt = 3, noformat=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted object of class <code>glmmNPML</code> or <code>glmmGQ</code>.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>an integer with values <code class="reqn">0 \le</code> <code>plot.opt</code> <code class="reqn">\le 15</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noformat</code></td>
<td>
<p>if <code>TRUE</code>, then any formatting of the plots is omitted (useful if the user wants to include the plots into a panel of several other plots, possibly generated by other functions).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments which will mostly not have any effect 
(and are included only to ensure compatibility with the 
generic <code>plot()</code>- function.)  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the help pages to alldist and the vignette (Einbeck &amp; Hinde, 2007). 
It is sufficient to write <code>plot</code> instead of <code>plot.glmmNPML</code> or <code>plot.glmmGQ</code>,
since the generic <code>plot</code> function provided in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> automatically selects the right model class. 
</p>


<h3>Value</h3>

<p>For class <code>glmmNPML</code>: Depending on the choice of <code>plot.opt</code>, a subset
of the following four plots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>1</code></td>
<td>
<p>Disparity trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>2</code></td>
<td>
<p>EM Trajectories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>3</code></td>
<td>
<p>Empirical Bayes Predictions against observed response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>4</code></td>
<td>
<p>Individual posterior probabilities.</p>
</td>
</tr>
</table>
<p>The number given in <code>plot.opt</code> is transformed into a binary
number indicating which plots are to be selected. The first digit
(from the right!) refers to plot 1, the second one to plot 2, and so on.
For example, <code>plot.opt=4</code> gives the binary number 0100 and hence selects
just plot 3.
</p>
<p>For class <code>glmmGQ</code>: Depending on the choice of plot.opt,
a subset of  plots  1 and 3. Again, the number is transformed into binary coding, yielding only the
disparity trend for <code>plot.opt=1</code>, only the EBP's for <code>plot.opt=2</code>,
and both plots for <code>plot.opt=3</code>.
</p>


<h3>Author(s)</h3>

<p> Jochen Einbeck and John Hinde (2007) </p>


<h3>References</h3>

<p>Aitkin, M. (1996a). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing 6, 251-262. 
</p>
<p>Einbeck, J., and Hinde, J.: Nonparametric maximum likelihood estimation for random effect models in R. Vignette to R package  <span class="pkg">npmlreg</span>. 
Type <code>vignette("npmlreg-v")</code> to open it.
</p>
<p>Hinde, J. (1982). Compound Poisson regression models. Lecture Notes in Statistics 14, 109-121. 
</p>


<h3>See Also</h3>

 
<p><code>alldist</code>, <code>allvc</code>  
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(galaxies, package="MASS")
gal&lt;-as.data.frame(galaxies)
galaxy.np4u &lt;- alldist(galaxies/1000~1,random=~1,k=4,tol=0.5,data=gal,lambda=1)
predict(galaxy.np4u, type="response") # EBP on scale of responses

plot(galaxy.np4u,  plot.opt=4) # plots only EBP vs.  response
plot(galaxy.np4u,  plot.opt=3) # gives same output as given by default when executing alldist
plot(galaxy.np4u)              # gives all four plots.
</code></pre>


</div>