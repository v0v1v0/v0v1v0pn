<div class="container">

<table style="width: 100%;"><tr>
<td>PGDnpmr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Proximal gradient descent for nuclear penalized multinomial regression
</h2>

<h3>Description</h3>

<p>Iterates steps of proximal gradient descent until convergence, by repeatedly
taking steps in the direction of the negative of the gradient and
soft-thresholding the singular values of the result. Intended for internal use
only.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PGDnpmr(B, b, X, Y, lambda, s, group = NULL, accelerated = TRUE, eps = 1e-07,
    maxit = 1e+05, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Initial regression coefficient matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Initial intercept vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>Covariate matrix. May be in sparse form from <code>Matrix</code> package
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Response matrix. Each row has exactly one 1 indicating response category
for that observation. All other entries are zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Vector of regularization parameter values for penalizing nuclear norm
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>Step size for proximal gradient descent
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Vector of length equal to number of variables (ncol(X) and nrow(B)).
Variables in the same group indexed by a POSITIVE integer will be penalized
together (the nuclear norm of the sub-matrix of the regression coefficients
will be penalized). Variables without positive integers will NOT be
penalized. Default is NULL, which means there are no sub-groups; nuclear
norm of entire coefficient matrix is penalized.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accelerated</code></td>
<td>

<p>Logical. Should accelerated proximal gradient descent be used? Default is
TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Convergence threshold. When relative change in the objective function after
an interation drops below this threshold, algorithm halts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Maximum number of iterations for proximal gradient descent.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>Logical. Should output be silenced? If not, print the value of the
objective function after each step of proximal gradient descent. Perhaps
useful for debugging. Default is TRUE.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Optimal value of the regression coeffient matrix at convergence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>Optimal value of the regression intercept vector at convergence
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objectivePath</code></td>
<td>

<p>Vector showing the value of the objective function at each step in proximal
gradient descent
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>Time taken until convergence
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Scott Powers, Trevor Hastie, Rob Tibshirani
</p>


<h3>References</h3>

<p>Scott Powers, Trevor Hastie and Rob Tibshirani (2016). “Nuclear penalized
multinomial regression with an application to predicting at bat outcomes in
baseball.” In prep.
</p>


<h3>See Also</h3>

<p><code>npmr</code>, <code>prox</code>, <code>objective</code>,
<code>objectiveFast</code>
</p>


</div>