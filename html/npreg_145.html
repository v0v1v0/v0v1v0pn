<div class="container">

<table style="width: 100%;"><tr>
<td>theta.mle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MLE of Theta for Negative Binomial
</h2>

<h3>Description</h3>

<p>Computes the maximum likelihood estimate of the size (theta) parameter for the Negative Binomial distribution via a Newton-Raphson algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">theta.mle(y, mu, theta, wt = 1, 
          maxit = 100, maxth = .Machine$double.xmax,
          tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>response vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>mean vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>initial theta (optional)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>

<p>weight vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>max number of iterations  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxth</code></td>
<td>

<p>max possible value of <code>theta</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>convergence tolerance  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on the <code>glm.nb</code> function in the <b>MASS</b> package. If <code>theta</code> is missing, the initial estimate of theta is given by 
</p>
<p><code>theta &lt;- 1 / mean(wt * (y / mu - 1)^2)</code> 
</p>
<p>which is motivated by the method of moments estimator for the dispersion parameter in a quasi-Poisson model.
</p>


<h3>Value</h3>

<p>Returns estimated theta with attributes
</p>
<table>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>standard error estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (1999) Modern Applied Statistics with S-PLUS. Third Edition. Springer.
</p>
<p>https://www.rdocumentation.org/packages/MASS/versions/7.3-51.6/topics/negative.binomial
</p>
<p>https://www.rdocumentation.org/packages/MASS/versions/7.3-51.6/topics/glm.nb
</p>


<h3>See Also</h3>

<p><code>NegBin</code> for details on the Negative Binomial distribution
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data
n &lt;- 1000
x &lt;- seq(0, 1, length.out = n)
fx &lt;- 3 * x + sin(2 * pi * x) - 1.5
mu &lt;- exp(fx)

# simulate negative binomial data
set.seed(1)
y &lt;- rnbinom(n = n, size = 1/2, mu = mu)

# estimate theta
theta.mle(y, mu)
</code></pre>


</div>