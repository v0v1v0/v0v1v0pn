<div class="container">

<table style="width: 100%;"><tr>
<td>wtd.var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted Variance and Standard Deviation
</h2>

<h3>Description</h3>

<p>Generic function for calculating weighted variance or standard deviation of a vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wtd.var(x, weights, na.rm = FALSE)

wtd.sd(x, weights, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numerical or logical vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Vector of non-negative weights.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>

<p>Logical indicating whether <code>NA</code> values should be removed before calculation.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The weighted variance is defined as
</p>
<p><code>(n / (n - 1)) * sum(weights * (x - xbar)^2) / sum(weights)</code>
</p>
<p>where <code>n</code> is the number of observations with non-zero weights, and <code>xbar</code> is the weighted mean computed via the <code>wtd.mean</code> function.
</p>
<p>The weighted standard deviation is the square root of the weighted variance.
</p>


<h3>Value</h3>

<p>Returns the weighted variance or standard deviation.
</p>


<h3>Note</h3>

<p>If <code>weights</code> are missing, the weights are defined to be a vector of ones (which is the same as the unweighted variance or standard deviation).
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>See Also</h3>

<p><code>wtd.mean</code> for weighted mean calculations
</p>
<p><code>wtd.quantile</code> for weighted quantile calculations
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data and weights
set.seed(1)
x &lt;- rnorm(10)
w &lt;- rpois(10, lambda = 10)

# weighted mean
xbar &lt;- wtd.mean(x, w)

# weighted variance
wtd.var(x, w)
(10 / 9) * sum(w * (x - xbar)^2) / sum(w)

# weighted standard deviation
wtd.sd(x, w)
sqrt((10 / 9) * sum(w * (x - xbar)^2) / sum(w))

</code></pre>


</div>