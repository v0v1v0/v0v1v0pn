<div class="container">

<table style="width: 100%;"><tr>
<td>NegBin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Family Function for Negative Binomial
</h2>

<h3>Description</h3>

<p>Creates the functions needed to fit a Negative Binomial generalized smooth model via <code>gsm</code> with or without a known <code>theta</code> parameter. Adapted from the <code>negative.binomial</code> function in the <strong>MASS</strong> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NegBin(theta = NULL, link = "log")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>the <code>size</code> parameter for the Negative Binomial distribution. Default of <code>NULL</code> indicates that <code>theta</code> should be estimated from the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>the link function. Must be <code>log</code>, <code>sqrt</code>, <code>identity</code>, or an object of class <code>link-glm</code> (as generated by <code>make.link</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Negative Binomial distribution has mean <code class="reqn">\mu</code> and variance <code class="reqn">\mu + \mu^2/\theta</code>, where the <code>size</code> parameter <code class="reqn">\theta</code> is the inverse of the dispersion parameter. See <code>NegBinomial</code> for details.
</p>


<h3>Value</h3>

<p>An object of class "<code>family</code>" with the functions and expressions needed to fit the <code>gsm</code>. In addition to the standard values (see <code>family</code>), this also produces the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>function to evaluate the log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>canpar</code></td>
<td>
<p>function to compute the canonical parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulant</code></td>
<td>
<p>function to compute the cumulant function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the specified <code>theta</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.theta</code></td>
<td>
<p>logical specifying if <code>theta</code> was provided</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (1999) Modern Applied Statistics with S-PLUS. Third Edition. Springer.
</p>
<p>https://www.rdocumentation.org/packages/MASS/versions/7.3-51.6/topics/negative.binomial
</p>
<p>https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/NegBinomial
</p>


<h3>See Also</h3>

<p><code>gsm</code> for fitting generalized smooth models with Negative Binomial responses
</p>
<p><code>theta.mle</code> for maximum likelihood estimation of theta
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate data
n &lt;- 1000
x &lt;- seq(0, 1, length.out = n)
fx &lt;- 3 * x + sin(2 * pi * x) - 1.5

# negative binomial (size = 1/2, log link)
set.seed(1)
y &lt;- rnbinom(n = n, size = 1/2, mu = exp(fx))

# fit model (known theta)
mod &lt;- gsm(y ~ x, family = NegBin(theta = 1/2), knots = 10)
mean((mod$linear.predictors - fx)^2)
mod$family$theta   # fixed theta

# fit model (unknown theta)
mod &lt;- gsm(y ~ x, family = NegBin, knots = 10)
mean((mod$linear.predictors - fx)^2)
mod$family$theta   # estimated theta

</code></pre>


</div>