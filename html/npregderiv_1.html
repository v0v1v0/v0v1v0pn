<div class="container">

<table style="width: 100%;"><tr>
<td>npregderiv package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The package "Nonparametric Estimation of the Derivatives of a Regression Function" implements the method of Wang and Lin (2015) of estimating the first and
second derivatives of a regression function from the original data in the case of an increasing evenly spaced design. The derivative estimates are computed at the design points.
The computations are based on the difference quotients. The package also includes the experimental data set on the deflection measurements of a round substrate before and after the thin
film deposition. See more details regarding the experiment and data analysis in the article of Savchuk and Volinsky (2020).</h2>

<h3>Description</h3>

<p>Estimating the first and second derivatives by the method of Wang and Lin (2015) requires choosing the soothing parameter <code class="reqn">k</code> that shows how many observations from each side of
an estimation point are used. Notice that the method of Wang and Lin (2015) requires an estimation point to be one of the design points. If a single value of <code class="reqn">k</code> is used for all
estimation points, it is impossible to compute a derivative estimate for the first and the last <code class="reqn">k</code> data points that constitute the left and right boundary regions, respectively.
Generally, an adaptive value of <code class="reqn">k</code> may be used (see Wang and Lin (2015)). Even though the article of Wang and Lin (2015) contains the expressions for the asymptotically optimal <code class="reqn">k</code>,
those results are of no practical importance since they involve the higher order derivatives of the regression function. Wang and Lin (2015) implement their method for
the values for <code class="reqn">k</code> ranging from <code class="reqn">0.02n</code> to <code class="reqn">0.2n</code>, where <code class="reqn">n</code> is the sample size. The larger the value of <code class="reqn">k</code>, the smoother the resulting estimate. However, too large <code class="reqn">k</code> may lead to
smoothing away certain important features of the function's derivatives. We found that the value of <code class="reqn">k=0.1n</code> worked reasonably well for estimating the first and second derivatives
of the regression functions in many practical cases.
</p>


<h3>Details</h3>

<p>The function <code>reg_1derivWL</code> is developed to estimate the first derivative of the underlying regression function from the original data. The function <code>reg_2derivWL</code> is
intended to estimate the function's second derivative. The latter function was used for estimating the second derivatives of the deflection functions in the experiment
described and analyzed in the article of Savchuk and Volinsky (2020). The deflection's second derivative is used to estimate the substrate's curvature and, ultimately, the
residual stress of the thin film deposited on the substrate.
</p>
<p>The data set <code>wafer40</code> analyzed in the article of Savchuk and Volinsky (2020) is included into the package. It contains the deflection measurements for one of the
wafers (wafer 40) used in the experiment. The measurements are taken before and after the thin film deposition in two radial directions on the round substrate and are marked as
"0 degrees" and "90 degrees" depending on the scan orientation. The design points are separated by 0.000005 m. The resulting sample size in each case is <code class="reqn">n</code>=7755. All
deflection and position measurements are recorded in meters.
</p>


<h3>References</h3>

<p>Wang, W.W., Lin, L. (2015) <a href="http://www.jmlr.org/papers/v16/wang15b.html">http://www.jmlr.org/papers/v16/wang15b.html</a> “Derivative Estimation Based on Difference Sequence via Locally Weighted Least Squares Regression”, <em>Journal of Machine Learning Research</em>, 16, 2617-2641.
</p>
<p>Savchuk, O., Volinsky, A.A. (2020). “Nonparametric estimation of SiC film residual stress from the wafer profile”.
</p>


</div>