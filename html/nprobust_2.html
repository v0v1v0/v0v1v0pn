<div class="container">

<table style="width: 100%;"><tr>
<td>kdbwselect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bandwidth Selection Procedures for Kernel Density Estimation and Inference</h2>

<h3>Description</h3>

<p><code>kdbwselect</code> implements bandwidth selectors for kernel density point estimators and inference procedures developed in Calonico, Cattaneo and Farrell (2018). See also Calonico, Cattaneo and Farrell (2020) for related optimality results.
It also implements other bandwidth selectors available in the literature. See Wand and Jones (1995) for background references.
</p>
<p>Companion commands are: <code>kdrobust</code> for kernel density point estimation and inference procedures.
</p>
<p>A detailed introduction to this command is given in Calonico, Cattaneo and Farrell (2019). For more details, and related Stata and R packages useful for empirical analysis, visit <a href="https://nppackages.github.io/">https://nppackages.github.io/</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kdbwselect(x, eval = NULL, neval = NULL, kernel = "epa", 
bwselect = "mse-dpi", bwcheck=21, imsegrid=30, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>independent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval</code></td>
<td>
<p>vector of evaluation point(s). By default it uses 30 equally spaced points over to support of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neval</code></td>
<td>
<p>number of quantile-spaced evaluation points on support of <code>x</code>. Default is <code>neval=30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>kernel function used to construct the kernel estimators. Options are <code>epa</code> for the epanechnikov kernel, and <code>uni</code> for the uniform kernel. Default is <code>kernel = epa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwselect</code></td>
<td>
<p>bandwidth selection procedure to be used. Options are:
</p>
<p><code>mse-dpi</code> second-generation DPI implementation of MSE-optimal bandwidth. Default option.
</p>
<p><code>imse-dpi</code> second-generation DPI implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>imse-rot</code> ROT implementation of IMSE-optimal bandwidth (computed using grid of evaluation points selected).
</p>
<p><code>ce-dpi</code> second generation DPI implementation of CE-optimal bandwidth.
</p>
<p><code>ce-rot</code> ROT implementation of CE-optimal bandwidth.
</p>
<p><code>all</code> reports all available bandwidth selection procedures.
</p>
<p>Note: MSE = Mean Square Error; IMSE = Integrated Mean Squared Error; CE = Coverage Error; DPI = Direct Plug-in; ROT = Rule-of-Thumb. For details on implementation see Calonico, Cattaneo and Farrell (2019).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwcheck</code></td>
<td>
<p>if a positive integer is provided, then the selected bandwidth is enlarged so that at least <code>bwcheck</code> effective observations are available at each evaluation point. Default is <code>bwcheck = 15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imsegrid</code></td>
<td>
<p>number of evaluations points used to compute the IMSE bandwidth selector. Default is <code>imsegrid = 30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>optional rule specifying a subset of observations to be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Estimate</code></td>
<td>
<p>A matrix containing <code>eval</code> (grid points), <code>h</code> and <code>b</code> (bandwidths).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>A list containing options passed to the function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Sebastian Calonico, Columbia University, New York, NY.  <a href="mailto:sebastian.calonico@columbia.edu">sebastian.calonico@columbia.edu</a>.
</p>
<p>Matias D. Cattaneo, Princeton University, Princeton, NJ.  <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>.
</p>
<p>Max H. Farrell, University of Chicago, Chicago, IL. <a href="mailto:max.farrell@chicagobooth.edu">max.farrell@chicagobooth.edu</a>.
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2018. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2018_JASA.pdf">On the Effect of Bias Estimation on Coverage Accuracy in Nonparametric Inference</a>. Journal of the American Statistical Association, 113(522): 767-779. doi: <a href="https://doi.org/10.1080/01621459.2017.1285776">10.1080/01621459.2017.1285776</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2019. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2019_JSS.pdf">nprobust: Nonparametric Kernel-Based Estimation and Robust Bias-Corrected Inference</a>. Journal of Statistical Software, 91(8). doi: <a href="https://doi.org/10.18637/jss.v091.i08">10.18637/jss.v091.i08</a>.
</p>
<p>Calonico, S., M. D. Cattaneo, and M. H. Farrell. 2020. <a href="https://nppackages.github.io/references/Calonico-Cattaneo-Farrell_2020_CEopt.pdf">Coverage Error Optimal Confidence Intervals for Local Polynomial Regression</a>. Working Paper. 
</p>
<p>Fan, J., and Gijbels, I. 1996. Local polynomial modelling and its applications, London: Chapman and Hall.
</p>
<p>Wand, M., and Jones, M. 1995. Kernel Smoothing, Florida: Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code>kdrobust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x   &lt;- rnorm(500)
est &lt;- kdbwselect(x)
summary(est)
</code></pre>


</div>