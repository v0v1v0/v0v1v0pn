<div class="container">

<table style="width: 100%;"><tr>
<td>P3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Three parameters Pearson type III distribution and L-moments</h2>

<h3>Description</h3>

<p><code>P3</code> provides the link between L-moments of a sample and the three parameter
Pearson type III distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">f.gamma (x, xi, beta, alfa)
F.gamma (x, xi, beta, alfa)
invF.gamma (F, xi, beta, alfa)
Lmom.gamma (xi, beta, alfa)
par.gamma (lambda1, lambda2, tau3)
rand.gamma (numerosita, xi, beta, alfa)
mom2par.gamma (mu, sigma, gamm)
par2mom.gamma (alfa, beta, xi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of gamma mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of gamma standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamm</code></td>
<td>
<p>vector of gamma third moment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>vector of sample means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>vector of L-variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau3</code></td>
<td>
<p>vector of L-CA (or L-skewness)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numerosita</code></td>
<td>
<p>numeric value indicating the length of the vector to be generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alfa</code></td>
<td>
<p>vector of gamma shape parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of gamma scale parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>vector of gamma location parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <a href="https://en.wikipedia.org/wiki/Pearson_distribution">https://en.wikipedia.org/wiki/Pearson_distribution</a> for an introduction to the Pearson distribution, and <a href="https://en.wikipedia.org/wiki/Gamma_distribution">https://en.wikipedia.org/wiki/Gamma_distribution</a> for an introduction to the Gamma distribution (the Pearson type III distribution is, essentially, a Gamma distribution with 3 parameters).
</p>
<p><b>Definition</b>
</p>
<p>Parameters (3): <code class="reqn">\xi</code> (location), <code class="reqn">\beta</code> (scale), <code class="reqn">\alpha</code> (shape).
Moments (3): <code class="reqn">\mu</code> (mean), <code class="reqn">\sigma</code> (standard deviation), <code class="reqn">\gamma</code> (skewness).
</p>
<p>If <code class="reqn">\gamma \ne 0</code>, let <code class="reqn">\alpha=4/\gamma^2</code>, <code class="reqn">\beta=\frac{1}{2}\sigma |\gamma|</code>, and <code class="reqn">\xi= \mu - 2 \sigma/\gamma</code>.
If <code class="reqn">\gamma &gt; 0</code>, then the range of <code class="reqn">x</code> is <code class="reqn">\xi \le x &lt; \infty</code> and
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{(x - \xi)^{\alpha - 1} e^{-(x-\xi)/\beta}}{\beta^{\alpha} \Gamma(\alpha)}</code>
</p>

<p style="text-align: center;"><code class="reqn">F(x) = G \left(\alpha, \frac{x-\xi}{\beta}\right)/ \Gamma(\alpha)</code>
</p>

<p>If <code class="reqn">\gamma=0</code>, then the distribution is Normal, the range of <code class="reqn">x</code> is <code class="reqn">-\infty &lt; x &lt; \infty</code> and
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \phi \left(\frac{x-\mu}{\sigma}\right)</code>
</p>

<p style="text-align: center;"><code class="reqn">F(x) = \Phi \left(\frac{x-\mu}{\sigma}\right)</code>
</p>

<p>where
<code class="reqn">\phi(x)=(2\pi)^{-1/2}\exp(-x^2/2)</code> and
<code class="reqn">\Phi(x)=\int_{-\infty}^x \phi(t)dt</code>.
</p>
<p>If <code class="reqn">\gamma &lt; 0</code>, then the range of <code class="reqn">x</code> is <code class="reqn">-\infty &lt; x \le \xi</code> and
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{(\xi - x)^{\alpha - 1} e^{-(\xi-x)/\beta}}{\beta^{\alpha} \Gamma(\alpha)}</code>
</p>

<p style="text-align: center;"><code class="reqn">F(x) = G \left(\alpha, \frac{\xi-x}{\beta}\right)/ \Gamma(\alpha)</code>
</p>

<p>In each case, <code class="reqn">x(F)</code> has no explicit analytical form.
Here <code class="reqn">\Gamma</code> is the gamma function, defined as </p>
<p style="text-align: center;"><code class="reqn">\Gamma (x) = \int_0^{\infty} t^{x-1} e^{-t} dt</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">G(\alpha, x) = \int_0^x t^{\alpha-1} e^{-t} dt</code>
</p>

<p>is the incomplete gamma function.
</p>
<p><code class="reqn">\gamma=2</code> is the exponential distribution; <code class="reqn">\gamma=0</code> is the Normal distribution; <code class="reqn">\gamma=-2</code> is the reverse exponential distribution.
</p>
<p>The parameters <code class="reqn">\mu</code>, <code class="reqn">\sigma</code> and <code class="reqn">\gamma</code> are the conventional moments of the distribution.
</p>
<p><b>L-moments</b>
</p>
<p>Assuming <code class="reqn">\gamma&gt;0</code>, L-moments are defined for <code class="reqn">0&lt;\alpha&lt;\infty</code>.
</p>
<p style="text-align: center;"><code class="reqn">\lambda_1 = \xi + \alpha \beta</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_2 = \pi^{-1/2} \beta \Gamma(\alpha + 1/2)/\Gamma(\alpha)</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_3 = 6 I_{1/3} (\alpha, 2 \alpha)-3</code>
</p>

<p>where <code class="reqn">I_x(p,q)</code> is the incomplete beta function ratio
</p>
<p style="text-align: center;"><code class="reqn">I_x(p,q) = \frac{\Gamma(p+q)}{\Gamma(p)\Gamma(q)} \int_0^x t^{p-1} (1-t)^{q-1} dt</code>
</p>

<p>There is no simple expression for <code class="reqn">\tau_4</code>.
Here we use the rational-funcion approximation given by Hosking and Wallis (1997, pp. 201-202).
</p>
<p>The corresponding results for <code class="reqn">\gamma &lt;0</code> are obtained by changing the signs of <code class="reqn">\lambda_1</code>, <code class="reqn">\tau_3</code> and <code class="reqn">\xi</code> wherever they occur above.
</p>
<p><b>Parameters</b>
</p>
<p><code class="reqn">alpha</code> is obtained with an approximation.
If <code class="reqn">0&lt;|\tau_3|&lt;1/3</code>, let <code class="reqn">z=3 \pi \tau_3^2</code> and use
</p>
<p style="text-align: center;"><code class="reqn">\alpha \approx \frac{1+0.2906 z}{z + 0.1882 z^2 + 0.0442 z^3}</code>
</p>

<p>if <code class="reqn">1/3&lt;|\tau_3|&lt;1</code>, let <code class="reqn">z=1-|\tau_3|</code> and use
</p>
<p style="text-align: center;"><code class="reqn">\alpha \approx \frac{0.36067 z - 0.59567 z^2 + 0.25361 z^3}{1-2.78861 z + 2.56096 z^2 -0.77045 z^3}</code>
</p>

<p>Given <code class="reqn">\alpha</code>, then
<code class="reqn">\gamma=2 \alpha^{-1/2} sign(\tau_3)</code>,
<code class="reqn">\sigma=\lambda_2 \pi^{1/2} \alpha^{1/2} \Gamma(\alpha)/\Gamma(\alpha+1/2)</code>,
<code class="reqn">\mu=\lambda_1</code>.
</p>
<p><code>Lmom.gamma</code> and <code>par.gamma</code> accept input as vectors of equal length. 
In <code>f.gamma</code>, <code>F.gamma</code>, <code>invF.gamma</code> and <code>rand.gamma</code> parameters (<code>mu</code>, <code>sigma</code>, <code>gamm</code>) must be atomic.
</p>


<h3>Value</h3>

<p><code>f.gamma</code> gives the density <code class="reqn">f</code>, <code>F.gamma</code> gives the distribution function <code class="reqn">F</code>, <code>invFgamma</code> gives
the quantile function <code class="reqn">x</code>, <code>Lmom.gamma</code> gives the L-moments (<code class="reqn">\lambda_1</code>, <code class="reqn">\lambda_2</code>, <code class="reqn">\tau_3</code>, <code class="reqn">\tau_4</code>), <code>par.gamma</code> gives the parameters (<code>mu</code>, <code>sigma</code>, <code>gamm</code>), and <code>rand.gamma</code> generates random deviates.
</p>
<p><code>mom2par.gamma</code> returns the parameters <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\xi</code>, given the parameters (moments) <code class="reqn">\mu</code>, <code class="reqn">\sigma</code>, <code class="reqn">\gamma</code>.
</p>


<h3>Note</h3>

<p>For information on the package and the Author, and for all the references, see <code>nsRFA</code>.</p>


<h3>See Also</h3>

<p><code>rnorm</code>, <code>runif</code>, <code>EXP</code>, <code>GENLOGIS</code>, <code>GENPAR</code>, <code>GEV</code>, <code>GUMBEL</code>, <code>KAPPA</code>, <code>LOGNORM</code>; <code>DISTPLOTS</code>, <code>GOFmontecarlo</code>, <code>Lmoments</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hydroSIMN)
annualflows
summary(annualflows)
x &lt;- annualflows["dato"][,]
fac &lt;- factor(annualflows["cod"][,])
split(x,fac)

camp &lt;- split(x,fac)$"45"
ll &lt;- Lmoments(camp)
parameters &lt;- par.gamma(ll[1],ll[2],ll[4])
f.gamma(1800,parameters$xi,parameters$beta,parameters$alfa)
F.gamma(1800,parameters$xi,parameters$beta,parameters$alfa)
invF.gamma(0.7511627,parameters$xi,parameters$beta,parameters$alfa)
Lmom.gamma(parameters$xi,parameters$beta,parameters$alfa)
rand.gamma(100,parameters$xi,parameters$beta,parameters$alfa)

Rll &lt;- regionalLmoments(x,fac); Rll
parameters &lt;- par.gamma(Rll[1],Rll[2],Rll[4])
Lmom.gamma(parameters$xi,parameters$beta,parameters$alfa)

moments &lt;- par2mom.gamma(parameters$alfa,parameters$beta,parameters$xi); moments
mom2par.gamma(moments$mu,moments$sigma,moments$gamm)
</code></pre>


</div>