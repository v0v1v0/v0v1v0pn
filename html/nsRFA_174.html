<div class="container">

<table style="width: 100%;"><tr>
<td>KAPPA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Four parameter kappa distribution and L-moments</h2>

<h3>Description</h3>

<p><code>KAPPA</code> provides the link between L-moments of a sample and the four parameter
kappa distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">f.kappa (x, xi, alfa, k, h)
F.kappa (x, xi, alfa, k, h)
invF.kappa (F, xi, alfa, k, h)
Lmom.kappa (xi, alfa, k, h)
par.kappa (lambda1, lambda2, tau3, tau4)
rand.kappa (numerosita, xi, alfa, k, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>vector of kappa location parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alfa</code></td>
<td>
<p>vector of kappa scale parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>vector of kappa third parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>vector of kappa fourth parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>vector of sample means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>vector of L-variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau3</code></td>
<td>
<p>vector of L-CA (or L-skewness)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau4</code></td>
<td>
<p>vector of L-kurtosis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numerosita</code></td>
<td>
<p>numeric value indicating the length of the vector to be generated</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>Definition</b>
</p>
<p>Parameters (4): <code class="reqn">\xi</code> (location), <code class="reqn">\alpha</code> (scale), <code class="reqn">k</code>, <code class="reqn">h</code>.
</p>
<p>Range of <code class="reqn">x</code>: upper bound is <code class="reqn">\xi + \alpha/k</code> if <code class="reqn">k&gt;0</code>, <code class="reqn">\infty</code> if <code class="reqn">k \le 0</code>;
lower bound is <code class="reqn">\xi + \alpha(1-h^{-k})/k</code> if <code class="reqn">h&gt;0</code>, <code class="reqn">\xi + \alpha/k</code> if <code class="reqn">h \le 0</code> and <code class="reqn">k&lt;0</code> and <code class="reqn">-\infty</code> if <code class="reqn">h \le 0</code> and <code class="reqn">k \ge 0</code>
</p>
<p>Probability density function:
</p>
<p style="text-align: center;"><code class="reqn">f(x)=\alpha^{-1} [1-k(x-\xi)/\alpha]^{1/k-1} [F(x)]^{1-h}</code>
</p>

<p>Cumulative distribution function:
</p>
<p style="text-align: center;"><code class="reqn">F(x)=\{1-h[1-k(x-\xi)/\alpha]^{1/k}\}^{1/h}</code>
</p>

<p>Quantile function:
</p>
<p style="text-align: center;"><code class="reqn">x(F)= \xi + \frac{\alpha}{k} \left[ 1-\left( \frac{1-F^h}{h} \right)^k \right]</code>
</p>

<p><code class="reqn">h=-1</code> is the generalized logistic distribution; 
<code class="reqn">h=0</code> is the generalized eztreme value distribution;
<code class="reqn">h=1</code> is the generalized Pareto distribution.
</p>
<p><b>L-moments</b>
</p>
<p>L-moments are defined for <code class="reqn">h \ge 0</code> and <code class="reqn">k&gt;-1</code>, or if <code class="reqn">h&lt;0</code> and <code class="reqn">-1&lt;k&lt;-1/h</code>.
</p>
<p style="text-align: center;"><code class="reqn">\lambda_1 = \xi + \alpha(1-g_1)/k</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda_2 = \alpha(g_1 - g_2)/k</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_3 = (-g_1 + 3g_2 - 2g_3)/(g_1 - g_2)</code>
</p>

<p style="text-align: center;"><code class="reqn">\tau_4 = (-g_1 + 6g_2 - 10g_3 + 5g_4)/(g_1 - g_2)</code>
</p>

<p>where
<code class="reqn">g_r = \frac{r\Gamma(1+k)\Gamma(r/h)}{h^{1+k}\Gamma(1+k+r/h)}</code> if <code class="reqn">h&gt;0</code>;
<code class="reqn">g_r = \frac{r \Gamma(1+k)\Gamma(-k-r/h)}{(-h)^{1+k}\Gamma(1-r/h)}</code> if <code class="reqn">h&lt;0</code>;
</p>
<p>Here <code class="reqn">\Gamma</code> denote the gamma function
</p>
<p style="text-align: center;"><code class="reqn">\Gamma (x) = \int_0^{\infty} t^{x-1} e^{-t} dt</code>
</p>

<p><b>Parameters</b>
</p>
<p>There are no simple expressions for the parameters in terms of the L-moments.
However they can be obtained with a numerical algorithm considering the formulations of <code class="reqn">\tau_3</code> and <code class="reqn">\tau_4</code> in terms of <code class="reqn">k</code> and <code class="reqn">h</code>.
Here we use the function <code>optim</code> to minimize <code class="reqn">(t_3-\tau_3)^2 + (t_4-\tau_4)^2</code> where <code class="reqn">t_3</code> and <code class="reqn">t_4</code> are the sample L-moment ratios.
</p>
<p><code>Lmom.kappa</code> and <code>par.kappa</code> accept input as vectors of equal length. In <code>f.kappa</code>, <code>F.kappa</code>, 
<code>invF.kappa</code> and <code>rand.kappa</code> parameters (<code>xi</code>, <code>alfa</code>, <code>k</code>, <code>h</code>) must be atomic.
</p>


<h3>Value</h3>

<p><code>f.kappa</code> gives the density <code class="reqn">f</code>, <code>F.kappa</code> gives the distribution function <code class="reqn">F</code>, <code>invFkappa</code> gives
the quantile function <code class="reqn">x</code>, <code>Lmom.kappa</code> gives the L-moments (<code class="reqn">\lambda_1</code>, <code class="reqn">\lambda_2</code>, <code class="reqn">\tau_3</code>, <code class="reqn">\tau_4</code>), <code>par.kappa</code> gives the parameters (<code>xi</code>, <code>alfa</code>, <code>k</code>, <code>h</code>), and <code>rand.kappa</code> generates random deviates.
</p>


<h3>Note</h3>

<p>For information on the package and the Author, and for all the references, see <code>nsRFA</code>.</p>


<h3>See Also</h3>

<p><code>rnorm</code>, <code>runif</code>, <code>EXP</code>, <code>GENLOGIS</code>, <code>GENPAR</code>, <code>GEV</code>, <code>GUMBEL</code>, <code>LOGNORM</code>, <code>P3</code>; <code>optim</code>, <code>DISTPLOTS</code>, <code>GOFmontecarlo</code>, <code>Lmoments</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hydroSIMN)
annualflows
summary(annualflows)
x &lt;- annualflows["dato"][,]
fac &lt;- factor(annualflows["cod"][,])
split(x,fac)

camp &lt;- split(x,fac)$"45"
ll &lt;- Lmoments(camp)
parameters &lt;- par.kappa(ll[1],ll[2],ll[4],ll[5])
f.kappa(1800,parameters$xi,parameters$alfa,parameters$k,parameters$h)
F.kappa(1800,parameters$xi,parameters$alfa,parameters$k,parameters$h)
invF.kappa(0.771088,parameters$xi,parameters$alfa,parameters$k,parameters$h)
Lmom.kappa(parameters$xi,parameters$alfa,parameters$k,parameters$h)
rand.kappa(100,parameters$xi,parameters$alfa,parameters$k,parameters$h)

Rll &lt;- regionalLmoments(x,fac); Rll
parameters &lt;- par.kappa(Rll[1],Rll[2],Rll[4],Rll[5])
Lmom.kappa(parameters$xi,parameters$alfa,parameters$k,parameters$h)
</code></pre>


</div>