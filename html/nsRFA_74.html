<div class="container">

<table style="width: 100%;"><tr>
<td>DISTPLOTS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical distribution plots</h2>

<h3>Description</h3>

<p>Sample values are plotted against their empirical distribution in graphs where points belonging to a particular distribution should lie on a straight line.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> plotpos (x, a=0, orient="xF", ...)
 plotposRP (x, a=0, orient="xF", ...)
 loglogplot (x, a=0, orient="xF", ...)
 unifplot (x, a=0, orient="xF", line=FALSE, ...)
 normplot (x, a=0, orient="xF", line=FALSE, ...)
 lognormplot (x, a=0, orient="xF", line=FALSE, ...)
 studentplot (x, df, a=0, orient="xF", line=FALSE,...)
 logisplot (x, a=0, orient="xF", line=FALSE,...)
 gammaplot (x, shape, a=0, orient="xF", line=FALSE,...)
 expplot (x, a=0, orient="xF", line=FALSE,...)
 paretoplot (x, a=0, orient="xF", line=FALSE,...)
 gumbelplot (x, a=0, orient="xF", line=FALSE, ...)
 frechetplot (x, a=0, orient="xF", line=FALSE,...)
 weibullplot (x, a=0, orient="xF", line=FALSE,...)
 plotposRPhist (xcont, xhist=NA, infhist=NA, suphist=NA, nbans=NA, seuil=NA, 
                col12=c(1,1), a=0, orient="xF", ...)
 pointspos (x, a=0, orient="xF", ...)
 pointsposRP (x, a=0, orient="xF", ...)
 loglogpoints (x, a=0, orient="xF", ...)
 unifpoints (x, a=0, orient="xF", ...)
 normpoints (x, a=0, orient="xF", ...)
 studentpoints (x, df, a=0, orient="xF", ...)
 logispoints (x, a=0, orient="xF", ...)
 gammapoints (x, shape, a=0, orient="xF", ...)
 exppoints (x, a=0, orient="xF", ...)
 gumbelpoints (x, a=0, orient="xF", ...)
 weibullpoints (x, a=0, orient="xF", ...)
 regionalplotpos (x, cod, a=0, orient="xF", ...)
 regionalnormplot (x, cod, a=0, orient="xF", ...)
 regionallognormplot (x, cod, a=0, orient="xF", ...)
 regionalexpplot (x, cod, a=0, orient="xF", ...)
 regionalparetoplot (x, cod, a=0, orient="xF", ...)
 regionalgumbelplot (x, cod, a=0, orient="xF", ...)
 regionalfrechetplot (x, cod, a=0, orient="xF", ...)
 pointsposRPhist (xcont, xhist=NA, infhist=NA, suphist=NA, nbans=NA, seuil=NA, 
                  col12=c(1,1), a=0, orient="xF", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector representing a data-sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcont</code></td>
<td>
<p>vector of systematic data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xhist</code></td>
<td>
<p>vector of historical data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infhist</code></td>
<td>
<p>inferior limit for historical data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suphist</code></td>
<td>
<p>superior limit for historical data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbans</code></td>
<td>
<p>period (in years) over which the threshold has not been exceeded except for the historical data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seuil</code></td>
<td>
<p>threshold non exceeded in the historical period except for the historical data (see <code>BayesianMCMC</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom (&gt; 0, maybe non-integer) of the Student t distribution.  'df = Inf' is allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>shape parameter of the distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>plotting position parameter, normally between 0 and 0.5 (the default value here, corresponding to the Hazen plotting position, see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orient</code></td>
<td>
<p>if <code>orient="xF"</code> the abscissa will be x and the ordinate F</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>if TRUE (default) a straight line indicating the normal, lognormal, ..., distribution with parameters estimated from <code>x</code> is plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cod</code></td>
<td>
<p>array that defines the data subdivision among sites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col12</code></td>
<td>
<p>vector of 2 elements containing the colors for the systematic and historical data respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters as <code>xlab</code>, <code>ylab</code>, <code>main</code>, ...</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A brief introduction on Probability Plots (or Quantile-Quantile plots) is available on <a href="https://en.wikipedia.org/wiki/Q-Q_plot">https://en.wikipedia.org/wiki/Q-Q_plot</a>.
For plotting positions see <a href="https://en.wikipedia.org/wiki/Plotting_position">https://en.wikipedia.org/wiki/Plotting_position</a>.
</p>
<p>For the quantiles of the comparison distribution typically the Weibull formula <code class="reqn">k/(n + 1)</code> is used (default here). 
Several different formulas have been used or proposed as symmetrical plotting positions. 
Such formulas have the form 
</p>
<p style="text-align: center;"><code class="reqn">(k - a)/(n + 1 - 2a)</code>
</p>
 
<p>for some value of <code class="reqn">a</code> in the range from 0 to 1/2. 
The above expression <code class="reqn">k/(n+1)</code> is one example of these, for <code class="reqn">a=0</code>. 
The Filliben plotting position has <code class="reqn">a = 0.3175</code> and the Cunanne plotting position has <code class="reqn">a = 0.4</code> should be nearly quantile-unbiased for a range of distributions.
The Hazen plotting position, widely used by engineers, has <code class="reqn">a = 0.5</code>.
The Blom's plotting position, <code class="reqn">a = 3/8</code>, gives nearly unbiased quantiles for the normal distribution, while the Gringeton plotting position, <code class="reqn">a = 0.44</code>, is optimized for the largest observations from a Gumbel distribution.
For the generalized Pareto, the GEV and related distributions of the Type I (Gumbel) and Weibull, <code class="reqn">a = 0.35</code> is suggested.
</p>
<p>For large sample size, <code class="reqn">n</code>, there is little difference between these various expressions.
</p>


<h3>Value</h3>

<p>Representation of the values of <code>x</code> vs their empirical probability function <code class="reqn">F</code> in a cartesian, uniform, normal, lognormal or Gumbel plot. 
<code>plotpos</code> and <code>unifplot</code> are analogous except for the axis notation, <code>unifplot</code> has the same notation as <code>normplot</code>, <code>lognormplot</code>, ...
<code>plotposRP</code> is analogous to <code>plotpos</code> but the frequencies <code class="reqn">F</code> are expressed as Return Periods <code class="reqn">T=1/(1-F)</code>.
With the default settings, <code class="reqn">F</code> is defined with the Weibull plotting position <code class="reqn">F=k/(n+1)</code>.
The straight line (if <code>line</code>=TRUE) indicate the uniform, normal, lognormal or Gumbel distribution with parameters estimated from <code>x</code>.
The regional plots draw samples of a region on the same plot. 
</p>
<p><code>pointspos</code>, <code>normpoints</code>, ... are the analogous of <code>points</code>, they can be used to add points or lines to <code>plotpos</code>, <code>normplot</code>, ...
<code>normpoints</code> can be used either on <code>normplot</code> or <code>lognormplot</code>.
<code>exppoints</code> can be used either on <code>expplot</code> or <code>paretoplot</code> (since the log-transformed Pareto random variable is exponentially distributed).
<code>gumbelpoints</code> can be used either on <code>gumbelplot</code> or <code>frechetplot</code> (since the log-transformed Frechet random variable is distributed as a Gumbel).
</p>
<p><code>loglogplot</code> plots the logarithm of sample vs the logarithm of the empirical exceedance probability. For the log-log plot, the tail probability is represented by a straight line for power-law distributions (e.g. log-pearson, log-logistic, Frechet, ..., HEAVY TAIL), but not for the other subexponential or exponential distributions (e.g. gumbel, gamma, Pearson type III, ..., MODERATE TAIL); see El Adlouni et al. (2008).
</p>
<p><code>plotposRPhist</code> is based on the method in Stedinger et al. (1993, pp. 18.41-42).
</p>


<h3>Note</h3>

<p>For information on the package and the Author, and for all the references, see <code>nsRFA</code>.</p>


<h3>See Also</h3>

<p>These functons are analogous to <code>qqnorm</code>; for the distributions, see <code>Normal</code>, <code>Lognormal</code>, <code>LOGNORM</code>, <code>GUMBEL</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(30,10,2)
plotpos(x)
normplot(x)
normplot(x,xlab=expression(D[m]),ylab=expression(hat(F)),
         main="Normal plot",cex.main=1,font.main=1)
normplot(x,line=FALSE)

x &lt;- rlnorm(30,log(100),log(10))
normplot(x)
lognormplot(x)

x &lt;- rand.gumb(30,1000,100)
normplot(x)
gumbelplot(x)

x &lt;- rnorm(30,10,2)
y &lt;- rnorm(50,10,3)
z &lt;- c(x,y)
codz &lt;- c(rep(1,30),rep(2,50))
regionalplotpos(z,codz)
regionalnormplot(z,codz,xlab="z")
regionallognormplot(z,codz)
regionalgumbelplot(z,codz)

plotpos(x)
pointspos(y,pch=2,col=2)

x &lt;- rnorm(50,10,2)
F &lt;- seq(0.01,0.99,by=0.01)
qq &lt;- qnorm(F,10,2)
plotpos(x)
pointspos(qq,type="l")

normplot(x,line=FALSE)
normpoints(x,type="l",lty=2,col=3)

lognormplot(x)
normpoints(x,type="l",lty=2,col=3)

gumbelplot(x)
gumbelpoints(x,type="l",lty=2,col=3)

# distributions comparison in probabilistic graphs
x &lt;- rnorm(50,10,2)
F &lt;- seq(0.001,0.999,by=0.001)
loglikelhood &lt;- function(param) {-sum(dgamma(x, shape=param[1], 
                scale=param[2], log=TRUE))}
parameters &lt;- optim(c(1,1),loglikelhood)$par
qq &lt;- qgamma(F,shape=parameters[1],scale=parameters[2])
plotpos(x)
pointspos(qq,type="l")

normplot(x,line=FALSE)
normpoints(qq,type="l")

lognormplot(x,line=FALSE)
normpoints(qq,type="l")

</code></pre>


</div>