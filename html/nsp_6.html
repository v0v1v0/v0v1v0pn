<div class="container">

<table style="width: 100%;"><tr>
<td>draw_rects_advanced</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot NSP intervals of significance at appropriate places along the graph of data</h2>

<h3>Description</h3>

<p>This function plots the intervals of significance returned by one of the <code>nsp*</code> functions, at appropriate places along the graph of data.
It shows them as shaded rectangular areas (hence the name of the function) "attached" to the graph of the data. Note: the data sequence <code>y</code>
needs to have been plotted beforehand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw_rects_advanced(
  y,
  nsp.obj,
  half.height = NULL,
  show.middles = TRUE,
  col.middles = "blue",
  lwd = 3,
  density = 10,
  col.rects = "red",
  x.axis.start = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsp.obj</code></td>
<td>
<p>Object returned by one of the <code>nsp*</code> functions with <code>y</code> on input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>half.height</code></td>
<td>
<p>Half-height of each rectangle; if <code>NULL</code> then set to twice the estimated standard deviation of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.middles</code></td>
<td>
<p>Whether to display lines corresponding to the midpoints of the rectanlges (rough change-point location estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.middles</code></td>
<td>
<p>Colour of the midpoint lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width for the midpoint lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>Density of the shading.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.rects</code></td>
<td>
<p>Colour of the shading.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.axis.start</code></td>
<td>
<p>Time index the x axis starts from. The NSP intervals of significance get shifted by <code>x.axis.start-1</code> prior to plotting.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The NSP algorithm is described in P. Fryzlewicz (2021) "Narrowest Significance Pursuit: inference for multiple change-points in linear
models", preprint.
</p>


<h3>Value</h3>

<p>The function does not return a value.
</p>


<h3>Author(s)</h3>

<p>Piotr Fryzlewicz, <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>draw_rects</code>, <code>nsp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
f &lt;- c(rep(0, 100), 1:100, rep(101, 100))
x.f &lt;- f + 15 * stats::rnorm(300)
x.f.n &lt;- nsp_poly(x.f, 100, "sim", deg=1)
stats::ts.plot(x.f)
draw_rects_advanced(x.f, x.f.n, density = 3)
</code></pre>


</div>